---
title: nature of code
pubDatetime: 2024-01-16T06:22:18Z
postSlug: nature of code
featured: true
draft: false
detailButton: true
tags:
  - ä»£ç çš„æœ¬è´¨
  - p5
  - canvas
  - math
  - 2024-01
  - code art
description: "ä»£ç çš„æœ¬è´¨ use p5 to know the world"
---

## ç®€ä»‹

ã€ŠThe Nature of Codeã€‹æ˜¯ç”± Daniel Shiffman ç¼–å†™çš„ä¸€æœ¬ä¹¦ï¼Œè‡´åŠ›äºå¸®åŠ©è¯»è€…ç†è§£å¦‚ä½•åœ¨è®¡ç®—æœºç¼–ç¨‹ä¸­æ¨¡æ‹Ÿè‡ªç„¶ç³»ç»Ÿçš„è¡Œä¸ºã€‚å®ƒä»¥å¤„ç†å¤æ‚çš„ç°è±¡ä¸ºæ ¸å¿ƒï¼Œä¾‹å¦‚ç‰©ç†ã€åŠ›å­¦ã€é—ä¼ ç®—æ³•ã€ç¾¤ä½“è¡Œä¸ºç­‰è‡ªç„¶ç°è±¡ï¼Œå¹¶é€šè¿‡ä»£ç å’Œç®—æ³•çš„æ–¹å¼è¿›è¡Œè§£é‡Šå’Œæ¨¡æ‹Ÿã€‚

è¿™æœ¬ä¹¦çš„ç‰¹ç‚¹æ˜¯ä»¥ç¼–ç¨‹ä¸ºæ‰‹æ®µï¼Œä»åŸºç¡€çš„æ•°å­¦å’Œç‰©ç†æ¦‚å¿µå‡ºå‘ï¼Œé€æ¸å¼•å…¥å¤æ‚çš„ä¸»é¢˜ï¼Œå±•ç¤ºå¦‚ä½•ä½¿ç”¨ä»£ç æ¨¡æ‹Ÿè‡ªç„¶ç•Œä¸­çš„éšæœºè¡Œä¸ºã€ç²’å­ç³»ç»Ÿã€åŠ¨åŠ›å­¦ã€ç¾¤ä½“è¡Œä¸ºç­‰ã€‚ä¹¦ä¸­ä½¿ç”¨çš„ç¼–ç¨‹è¯­è¨€ä¸»è¦æ˜¯JavaScriptä»¥åŠåŸºäºProcessingçš„åº“P5.jsï¼Œä½†æ¦‚å¿µæ˜¯é€šç”¨çš„ï¼Œè¯»è€…å¯ä»¥åº”ç”¨åˆ°å…¶ä»–ç¼–ç¨‹è¯­è¨€ä¸­ã€‚

ä¹¦ä¸­è®¨è®ºçš„å‡ ä¸ªæ ¸å¿ƒä¸»é¢˜åŒ…æ‹¬ï¼š

1. **å‘é‡å’Œè¿åŠ¨**ï¼šå¦‚ä½•ç”¨ä»£ç æ¨¡æ‹Ÿç‰©ä½“çš„è¿åŠ¨ï¼Œåˆ©ç”¨å‘é‡è¿›è¡Œä½ç½®ã€é€Ÿåº¦å’ŒåŠ é€Ÿåº¦çš„è®¡ç®—ã€‚
2. **åŠ›å’Œç¯å¢ƒ**ï¼šé€šè¿‡æ¨¡æ‹Ÿç‰©ç†åŠ›ï¼ˆå¦‚é‡åŠ›ã€æ‘©æ“¦åŠ›ç­‰ï¼‰æ¥åˆ›å»ºæ›´é€¼çœŸçš„åŠ¨ç”»ã€‚
3. **éšæœºæ€§ä¸æ¦‚ç‡**ï¼šä½¿ç”¨éšæœºæ•°ç”Ÿæˆå’Œæ¦‚ç‡æ¥æ¨¡æ‹Ÿä¸ç¡®å®šæ€§æˆ–è‡ªç„¶ç°è±¡ä¸­çš„éšæœºè¡Œä¸ºã€‚
4. **ç²’å­ç³»ç»Ÿ**ï¼šå¦‚ä½•ä½¿ç”¨ç²’å­ç³»ç»Ÿæ¥æ¨¡æ‹Ÿè‡ªç„¶ä¸­çš„å¤æ‚ç³»ç»Ÿï¼Œæ¯”å¦‚çƒŸé›¾ã€ç«ç„°ç­‰ã€‚
5. **ç¾¤ä½“è¡Œä¸º**ï¼šæ¨¡æ‹Ÿé¸Ÿç¾¤ã€é±¼ç¾¤ç­‰é›†ä½“è¡Œä¸ºï¼Œé€šè¿‡è§„åˆ™å’Œç®—æ³•æ¥å±•ç¤ºå¤æ‚çš„åè°ƒæ€§ã€‚
6. **é—ä¼ ç®—æ³•å’Œè¿›åŒ–**ï¼šå¦‚ä½•æ¨¡æ‹Ÿè‡ªç„¶é€‰æ‹©å’Œè¿›åŒ–è¿‡ç¨‹ï¼Œå±•ç¤ºç¾¤ä½“å¦‚ä½•é€šè¿‡é—ä¼ ç®—æ³•â€œè¿›åŒ–â€å‡ºè§£å†³é—®é¢˜çš„èƒ½åŠ›ã€‚

ã€ŠThe Nature of Codeã€‹ä¸ä»…ä»…æ˜¯ä¸€æœ¬ç¼–ç¨‹æŒ‡å—ï¼Œè¿˜æ˜¯æ¢ç´¢è‡ªç„¶ç°è±¡èƒŒåçš„æ•°å­¦å’Œç®—æ³•çš„ä¸€ç§æ–¹å¼ã€‚å®ƒé€‚åˆå¯¹ç‰©ç†æ¨¡æ‹Ÿã€åˆ›æ„ç¼–ç¨‹ä»¥åŠè‡ªç„¶ç³»ç»Ÿæ„Ÿå…´è¶£çš„å¼€å‘è€…æˆ–è‰ºæœ¯å®¶ã€‚

## ç›®å½•

## nature of code

æˆ‘ä¸p5çš„ç¼˜åˆ†çœŸçš„è›®æ·±çš„,DANIEL SHIFFMANä¹Ÿç®—æ˜¯æˆ‘çš„ç¼–ç¨‹å¯è’™è€å¸ˆäº†,
nature of code,è¿™æ˜¯ä¸€æœ¬ä»–æ’°å†™çš„ä¸€æœ¬å…³äºç¼–ç¨‹å’Œè®¡ç®—æœºç”Ÿæˆè‰ºæœ¯çš„ä¹¦ç±,è¯¦ç»†é“¾æ¥è§[â¬‡ï¸](#links)

### code template(ä¸‹è¿°ä»£ç æ¨¡ç‰ˆ)

<details>
<summary>template</summary>

import Template from "@components/react/p5/index.tsx";

<Template client:visible />

```tsx
import type p5 from "p5";
import { useEffect, useRef, memo, useState } from "react";
import {
  EnterFullScreenIcon,
  ExitFullScreenIcon,
  PlayIcon,
  StopIcon,
  ResumeIcon,
  ExclamationTriangleIcon,
} from "@radix-ui/react-icons";
import { DownloadIcon } from "lucide-react";

type Sketch = (p: p5) => void;

const defaultSketch: Sketch = (p: p5) => {
  let xoff = 0.0;
  p.setup = () => {
    p.createCanvas(100, 100);
    p.frameRate(60);
  };
  p.draw = () => {
    let noise = p.noise(xoff) * (p.width - 50);
    p.background(255);
    p.noStroke();
    p.fill(34, 39, 54);
    xoff += 0.01;
    p.ellipse(noise, p.height / 2, 25, 25);
  };
};

interface Props {
  sketch: Sketch;
  showControls?: boolean; // defaults to false
}

const Button = ({
  onClick,
  children,
}: {
  onClick: () => void;
  children: React.ReactNode;
}) => (
  <button
    type="button"
    onClick={onClick}
    className="inline-block text-skin-inverted rounded bg-skin-inverted px-6 pb-2 pt-2.5 text-xs font-medium uppercase leading-normal  shadow-[0_4px_9px_-4px_#cbcbcb] transition duration-150 ease-in-out hover:bg-neutral-100 hover:shadow-[0_8px_9px_-4px_rgba(203,203,203,0.3),0_4px_18px_0_rgba(203,203,203,0.2)] focus:bg-neutral-100 focus:shadow-[0_8px_9px_-4px_rgba(203,203,203,0.3),0_4px_18px_0_rgba(203,203,203,0.2)] focus:outline-none focus:ring-0 active:bg-neutral-200 active:shadow-[0_8px_9px_-4px_rgba(203,203,203,0.3),0_4px_18px_0_rgba(203,203,203,0.2)] dark:shadow-[0_4px_9px_-4px_rgba(251,251,251,0.3)] dark:hover:shadow-[0_8px_9px_-4px_rgba(251,251,251,0.1),0_4px_18px_0_rgba(251,251,251,0.05)] dark:focus:shadow-[0_8px_9px_-4px_rgba(251,251,251,0.1),0_4px_18px_0_rgba(251,251,251,0.05)] dark:active:shadow-[0_8px_9px_-4px_rgba(251,251,251,0.1),0_4px_18px_0_rgba(251,251,251,0.05)]"
  >
    {children}
  </button>
);
let doOnce = false;

const P5Canvas = memo(({ sketch, showControls = false }: Props) => {
  const container = useRef<HTMLDivElement>(null);
  const trueContainer = useRef<HTMLDivElement>(null);
  let [p, setP] = useState<p5>(null);
  const [isFullscreen, setIsFullscreen] = useState(false);

  const start = async () => {
    if (container.current) {
      const p5 = await import("p5");
      !p && setP(new p5.default(sketch || defaultSketch, container.current));
    }
  };
  const remove = () => {
    p && p.remove();
    p && setP(null);
  };
  const stop = () => p && p.isLooping() && p.noLoop();
  const begin = () => p && !p.isLooping() && p.loop();
  const init = async () => {
    remove();
    await start();
    setLoading(false);
  };
  const [loading, setLoading] = useState(true);

  const clear = () => {
    remove();
    container.current && (container.current.innerHTML = "");
  };

  const toggleFullscreen = async () => {
    if (trueContainer.current && !isFullscreen) {
      if (trueContainer.current.requestFullscreen) {
        await trueContainer.current.requestFullscreen();
        trueContainer.current.style.backgroundColor = "black";
      }
      setIsFullscreen(true);
    } else {
      if (document.exitFullscreen) {
        await document.exitFullscreen();
      }
      trueContainer.current.style.backgroundColor = "";
      setIsFullscreen(false);
    }
  };

  const download = () => {
    if (!p) return;
    p.saveGif("sketch", 5, { delay: 1 });
  };

  useEffect(() => {
    if (p && isFullscreen) {
      p.resizeCanvas(window.innerWidth, window.innerHeight - 90);
      p.windowResized = async () => {
        await init();
        p.resizeCanvas(window.innerWidth, window.innerHeight - 90);
        container.current.style.minHeight = p?.height + "px";
      };
    }

    const obs = new IntersectionObserver(async ([entry]) => {
      if (entry.isIntersecting) {
        !doOnce && !container.current.innerHTML && (await init());
        !doOnce && !showControls && begin(); //æ²¡æœ‰æŒ‰é’®è‡ªåŠ¨å¯åŠ¨
        if (!doOnce && !container.current.innerHTML) doOnce = true;
      } else stop();
    });
    obs.observe(trueContainer.current);
    return () => {
      obs.disconnect();
      remove();
    };
  }, [isFullscreen, p]);

  const handleFullscreenChange = () => {
    setLoading(true);
    setIsFullscreen(!!document.fullscreenElement);
  };

  useEffect(() => {
    (async () => {
      if (!container.current) return;
      container.current.innerHTML = "";
      await init();
    })();
    return () => {
      remove();
      container.current.innerHTML = "";
    };
  }, [sketch]);

  useEffect(() => {
    document.addEventListener("fullscreenchange", handleFullscreenChange);
    container.current.style.minHeight = p?.height + "px";
    trueContainer.current.style.backgroundColor = "";
    return () => {
      document.removeEventListener("fullscreenchange", handleFullscreenChange);
      remove();
    };
  }, [p]);

  return (
    <>
      <div ref={trueContainer} className="p5_container mt-4 relative">
        <div
          ref={container}
          className="flex w-full max-w-full justify-center"
        ></div>
        {loading && (
          <div className="min-h-[200px] flex justify-center items-center text-2xl">
            åŠ è½½ä¸­...
          </div>
        )}

        {/* æ§åˆ¶æŒ‰é’® */}
        {!loading && showControls && (
          <div
            className={
              "flex pt-4 select-none justify-around" +
              (isFullscreen ? " fixed mb-10 pb-10 left-0 w-full" : "")
            }
          >
            <Button onClick={stop}>
              <StopIcon />
            </Button>
            <Button onClick={begin}>
              <PlayIcon />
            </Button>
            <Button onClick={download}>
              <DownloadIcon></DownloadIcon>
            </Button>

            {/* <Button onClick={init}>
                            <ResumeIcon></ResumeIcon>
                        </Button> */}

            <Button onClick={clear}>
              <ExclamationTriangleIcon></ExclamationTriangleIcon>
            </Button>
            <Button onClick={toggleFullscreen}>
              {isFullscreen ? <ExitFullScreenIcon /> : <EnterFullScreenIcon />}
            </Button>
          </div>
        )}
      </div>
    </>
  );
});

export default P5Canvas;
```

</details>

### 0. [Randomness](https://natureofcode.com/random/)

`éšæœºæ€§` `æŸæ—å™ªå£°` `æ¦‚ç‡`

#### RandomnessA

<details>
<summary>RandomnessA</summary>
```tsx
step() {
        const choice = p.floor(p.random(4));
        switch (choice) {
          case 0:
            this.x++;
            break;
          case 1:
            this.x--;
            break;
          case 2:
            this.y++;
            break;
          case 3:
            this.y--;
            break;
          default:
            break;
        }
      }
```
import RandomnessA from "@components/react/p5/Randomness/RandomnessA.tsx";

<RandomnessA client:visible />
</details>

#### RandomnessB

<details class="mt-4">
<summary>RandomnessB</summary>

```tsx
step() {
          let xStep = p.random(-1, 1);
          let yStep = p.random(-1, 1);

          this.x += xStep;
          this.y += yStep;

      }

```

import RandomnessB from "@components/react/p5/Randomness/RandomnessB.tsx";

<RandomnessB client:visible />
</details>

#### RandomnessC

<details class="mt-4">
<summary>RandomnessC</summary>

import RandomnessC from "@components/react/p5/Randomness/RandomnessC.tsx";

<RandomnessC client:visible />
</details>

#### Probability and Nonuniform Distributions

- Create a random walker that has a greater tendency to move down and to the right. (The solution follows in the next section.)

<details>
<summary>Probability and Nonuniform Distributions
æ¦‚ç‡å’Œéå‡åŒ€åˆ†å¸ƒ</summary>
```ts
let stuff = [1,1,2,4,5,6,7,8,8,8,9,9,9,9,10];
let value = random(stuff);
console.log(value);
````

```ts
let probability = 0.1;
let r = random(1);
if (r < probability) {
  console.log("success");
}
```

</details>

#### RandomnessD

<details class="mt-4">
<summary>RandomnessD  Tends to Move to the Right è¶‹äºå‘å³çš„éšæœºåˆ†å¸ƒ</summary>

import RandomnessD from "@components/react/p5/Randomness/RandomnessD.tsx";

<RandomnessD client:visible />
</details>

#### mouseX,mouseY

<details class="mt-4">

<summary>ä¸Šè¿°ä¾‹å­ä½¿ç”¨é¼ æ ‡äº¤äº’,å³ä½¿ç”¨mouseX,mouseY</summary>

import RandomnessE from "@components/react/p5/Randomness/RandomnessE.tsx";

<RandomnessE client:visible />
</details>

#### A Normal Distributions Of Random Numbers

<details class="mt-4">
<summary>A Normal Distributions Of Random Numbers</summary>

import RandomnessF from "@components/react/p5/Randomness/RandomnessF.tsx";

<RandomnessF client:visible />

<details>
<summary>æŸ¯é‡ŒåŒ–</summary>

```tsx
export default () => {
  const common = (p: p5, sd = 0.41) => {
    const heights = [];
    p.setup = () => {
      p.createCanvas(320, 240);
      p.background(255);
      const e = 2.71828183;
      let m = 0;
      for (let i = 0; i < p.width + 1; i++) {
        let xcoord = p.map(i, 0, p.width, -3, 3);
        let sq2pi = p.sqrt(2 * p.PI); //square root of 2 * PI
        let xmsq = -1 * (xcoord - m) * (xcoord - m); //-(x - mu)^2
        let sdsq = sd * sd; //variance (standard deviation squared)
        heights[i] = (1 / (sd * sq2pi)) * p.pow(e, xmsq / sdsq); //P(x) function
      }

      p.stroke(0);
      p.strokeWeight(2);
      p.noFill();
      p.beginShape();
      for (let i = 0; i < heights.length; i++) {
        let x = i;
        let y = p.map(heights[i], 0, 1, p.height - 2, 2);
        p.vertex(x, y);
      }
      p.endShape();
    };
  };
  const sketchA = (p: p5) => common(p, 0.41);
  const sketchB = (p: p5) => common(p, 1.5);

  return (
    <>
      <div className="flex justify-around">
        <Basic sketch={sketchA}></Basic>
        <Basic sketch={sketchB}></Basic>
      </div>
    </>
  );
};
```

</details>

</details>

#### sigma

<details class="mt-4">
<summary>æ­£æ€åˆ†å¸ƒä¸æ ‡å‡†å·®</summary>
æ­£æ€åˆ†å¸ƒï¼ˆä¹Ÿç§°ä¸ºé«˜æ–¯åˆ†å¸ƒï¼‰æ˜¯ç»Ÿè®¡å­¦ä¸­ä¸€ç§é‡è¦çš„æ¦‚ç‡åˆ†å¸ƒ,å…¶ç‰¹ç‚¹æ˜¯å¯¹ç§°ã€é’Ÿå½¢æ›²çº¿.åœ¨æ­£æ€åˆ†å¸ƒä¸­,æ ‡å‡†å·®æ˜¯ä¸€ä¸ªå…³é”®çš„å‚æ•°,å®ƒè¡¡é‡æ•°æ®é›†ä¸­çš„å€¼ä¸å¹³å‡å€¼çš„ç¦»æ•£ç¨‹åº¦.

æ ‡å‡†å·®ç”¨æ¥åº¦é‡æ•°æ®çš„ç¦»æ•£ç¨‹åº¦,å®ƒè¶Šå¤§è¡¨ç¤ºæ•°æ®çš„æ³¢åŠ¨è¶Šå¤§,è¶Šå°è¡¨ç¤ºæ•°æ®çš„æ³¢åŠ¨è¶Šå°.æ ‡å‡†å·®çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š

$ \sigma = \sqrt{\frac{\sum\_{i=1}^{N}(x_i - \mu)^2}{N}} $

å…¶ä¸­ï¼š

- $\sigma$ æ˜¯æ ‡å‡†å·®,
- $N$ æ˜¯æ•°æ®é›†ä¸­çš„è§‚æµ‹å€¼æ•°é‡,
- $x_i$ æ˜¯æ¯ä¸ªè§‚æµ‹å€¼,
- $\mu$ æ˜¯æ•°æ®é›†çš„å¹³å‡å€¼.

æ­£æ€åˆ†å¸ƒçš„ç‰¹æ€§ä¹‹ä¸€æ˜¯,çº¦68%çš„æ•°æ®åœ¨å¹³å‡å€¼é™„è¿‘çš„ä¸€ä¸ªæ ‡å‡†å·®èŒƒå›´å†…,çº¦95%çš„æ•°æ®åœ¨ä¸¤ä¸ªæ ‡å‡†å·®èŒƒå›´å†…,çº¦99.7%çš„æ•°æ®åœ¨ä¸‰ä¸ªæ ‡å‡†å·®èŒƒå›´å†….

å¦‚æœä½ æœ‰ç‰¹å®šçš„æ•°æ®é›†æˆ–é—®é¢˜,å¯ä»¥æä¾›æ›´å¤šä¿¡æ¯,æˆ‘å¯ä»¥å¸®ä½ æ›´å…·ä½“åœ°ç†è§£å’Œè§£é‡Š.

</details>

#### randomGaussian

<details class="pt-4">
<summary>[randomGaussian æ­£æ€åˆ†å¸ƒp5æ–¹æ³•](https://p5js.org/reference/#/p5/randomGaussian)</summary>

import UseRandomGaussian from "@components/react/p5/Randomness/useRandomGaussian.tsx";

<UseRandomGaussian class="mt-4" client:visible />

</details>

#### SimulatePaint

<details>
<summary>å®è·µä¸€ä¸ªæ²¹æ¼†é£æº…æ¨¡æ‹Ÿ</summary>

import SimulatePaint from "@components/react/p5/Randomness/simulatePaint.tsx";

<SimulatePaint client:visible />

<details open class="!mt-4 ">
<summary>'å®Œç¾'åœ°åœ¨type=rangeçš„inputä½¿ç”¨äº†useDebouce</summary>

```tsx
import { useDebounce } from "@uidotdev/usehooks";
...
const debouncedSd = useDebounce(sd, 300);
    const sketch = useCallback(
        (p: p5) => {
            ...
        },
        [debouncedSd]
    );
    const handleSliderChange = (val: string) => {
        setSd(parseFloat(val));
    };

    return (
        <>
            <input
                type="range"
                value={sd}
                onChange={(e) => { handleSliderChange(e.target.value) }}
            />
            ...
        </>
```

</details>

</details>

#### ResolveReject

<details>
<summary>æ¥å—æ‹’ç»åˆ†å¸ƒ</summary>

import ResolveReject from "@components/react/p5/Randomness/ResolveReject.tsx";

<ResolveReject client:visible />

</details>

#### PerlinCurve

<details>
<summary>æŸæ—å™ªå£°</summary>

import PerlinCurve from "@components/react/p5/Randomness/PerlinCurve.tsx";

<PerlinCurve client:visible />

æŸæ—å™ªå£°å°±åƒæ˜¯æŠŠæ—¶é—´åœä½äº†,ç»™äºˆå®ƒç›¸åº”tampè¿”å›è¿ç»­çš„å˜åŒ–çš„å€¼

```tsx
let time = 0;
const draw = () => {
  let xoff = time;
  for (let i = 0; i < p.width; i++) {
    let noise_height = p.noise(xoff) * p.height;
    xoff += 0.01;
    p.vertex(i, noise_height);
  }
  p.endShape();
  time += 0.01;
};
```

</details>

#### noise range

<details>
<summary>noise range</summary>

import NoiseRange from "@components/react/p5/Randomness/NoiseRange.tsx";

<NoiseRange client:visible />

ä½¿ç”¨mapæ˜ å°„noiseç”Ÿæˆçš„å€¼

</details>

#### two-dimensional noise

<details>
<summary>two-dimensional noise</summary>

import TwoDimensionalNoise from "@components/react/p5/Randomness/TwoDimensionalNoise.tsx";

<TwoDimensionalNoise client:visible />

</details>

#### generate marble

<details>
<summary>generate marble</summary>

import Marble from "@components/react/p5/Randomness/Marble.tsx";

<Marble client:visible />

</details>

#### RandomnessG

<details>

<summary>RandomnessG</summary>

import RandomnessG from "@components/react/p5/Randomness/RandomnessG.tsx";

<RandomnessG client:visible />

</details>

#### landscape

<details>
<summary>landscape</summary>

import Landscape from "@components/react/p5/Randomness/landScape.tsx";

<Landscape client:visible />
</details>

#### wind simulation

<details>
<summary>wind simulation(actually just noise)</summary>

import ComponentName from "@components/react/p5/Randomness/windSimulation.tsx";

<ComponentName client:visible />

<details>
<summary>code</summary>

```tsx
import type p5 from "p5";
import Basic from "@components/react/p5/index.tsx";

export default () => {
  const sketch = (p: p5) => {
    let yoff = 0;
    let seed = 5;
    let { PI } = p;

    const branch = (h: number, xoff: number) => {
      let sw = p.map(h, 2, 100, 1, 5);
      p.strokeWeight(sw);
      p.line(0, 0, 0, -h);
      p.translate(0, -h);

      h *= 0.7;
      xoff += 0.1;

      if (h > 4) {
        let n = p.floor(p.random(1, 5));
        for (let i = 0; i < n; i++) {
          let noise = p.noise(xoff + i, yoff);
          let theta = p.map(noise, 0, 1, -PI / 2, PI / 2);
          if (n % 2 == 0) theta *= -1;
          p.stroke(0);
          p.push();
          p.rotate(theta);
          branch(h, xoff);
          p.pop();
        }
      }
    };

    const setup = () => {
      p.createCanvas(p.windowWidth / 4 + 20, 200);
    };

    const draw = () => {
      p.background(255);
      p.translate(p.width / 2, p.height);
      yoff += 0.005;
      p.randomSeed(seed);
      branch(60, 0);
    };

    p.mouseClicked = () => {
      yoff = p.random(1000);
      seed = p.millis();
    };
    const resize = () => {
      p.resizeCanvas(p.windowWidth / 2, 240);
    };
    p.setup = setup;
    p.draw = draw;
    p.windowResized = resize;
  };
  return <Basic sketch={sketch} showControls></Basic>;
};
```

</details>

</details>

todo: flow demo

<details></details>

### 1. [Vectors](https://natureofcode.com/vectors/)

`å‘é‡` `åŠ›` `Mover`

#### ball

<details>
<summary>traveling around ball</summary>

import Ball from "@components/react/p5/Vector/ball";

<Ball client:visible />

```tsx
import type p5 from "p5";
import Basic from "@components/react/p5/index.tsx";

export default () => {
  const sketch = (p: p5) => {
    let x = 100;
    let y = 200;
    let xSpeed = 1.5;
    let ySpeed = 0.8;
    const setup = () => {
      p.createCanvas(p.windowWidth / 2, 240);
    };
    const draw = () => {
      p.background(255);
      x += xSpeed;
      y += ySpeed;
      if (x + 8 > p.width || x < 8) {
        xSpeed *= -1;
      }
      if (y + 8 > p.height || y < 8) {
        ySpeed *= -1;
      }
      p.stroke(10);
      p.fill(127, 30, 30);
      p.circle(x, y, 16);
    };
    const resize = () => {
      p.resizeCanvas(p.windowWidth / 2, 240);
    };
    p.setup = setup;
    p.draw = draw;
    p.windowResized = resize;
  };
  return <Basic sketch={sketch} showControls></Basic>;
};
```

</details>

#### still ball but use p5.Vector

<details>
<summary>vector add</summary>

import BallUseVector from "@components/react/p5/Vector/ballUseVector";

<BallUseVector client:visible />

```tsx
import type p5 from "p5";
import Basic from "@components/react/p5/index.tsx";

export default () => {
  const sketch = (p: p5) => {
    let pos, velocity;
    const setup = () => {
      p.createCanvas(p.windowWidth / 2, 80);
      pos = p.createVector(p.width / 2, p.height / 2);
      velocity = p.createVector(1.2, 0.8);
    };
    const draw = () => {
      p.background(204);
      p.fill(255, 0, 0);
      p.stroke(88);

      if (pos.x + 8 > p.width || pos.x < 8) {
        velocity.x = velocity.x * -1;
      }
      if (pos.y + 8 > p.height || pos.y < 8) {
        velocity.y = velocity.y * -1;
      }
      pos.add(velocity);
      p.circle(pos.x, pos.y, 16);
    };
    const resize = () => {
      p.resizeCanvas(p.windowWidth / 2, 240);
    };
    p.setup = setup;
    p.draw = draw;
    p.windowResized = resize;
  };
  return <Basic sketch={sketch} showControls></Basic>;
};
```

</details>

#### 3d

<details>
<summary>ball in 3d</summary>

import BallUseVector3D from "@components/react/p5/Vector/ballUseVector3D";

<BallUseVector3D client:visible />

```tsx
import type p5 from "p5";
import Basic from "@components/react/p5/index.tsx";

export default () => {
  const sketch = (p: p5) => {
    let pos, velocity;
    const setup = () => {
      p.createCanvas(p.windowWidth / 2, p.windowHeight / 2, p.WEBGL); // åˆ›å»ºä¸€ä¸ª3Dç”»å¸ƒ
      pos = p.createVector(0, 0, 0); // åˆå§‹ä½ç½®
      velocity = p.createVector(1, 1, 4); // åˆå§‹é€Ÿåº¦
    };
    const draw = () => {
      p.background(204);
      p.fill(255, 0, 0);
      p.stroke(88);
      console.log(pos, p.width);

      p.orbitControl();

      // è¾¹ç•Œæ£€æµ‹
      if (pos.x + 16 > p.width / 3 || pos.x - 16 < -p.width / 3) {
        velocity.x = velocity.x * -1;
      }
      if (pos.y + 16 > p.height / 3 || pos.y - 16 < -p.height / 3) {
        velocity.y = velocity.y * -1;
      }
      if (pos.z + 16 > p.width / 3 || pos.z - 16 < -p.width / 3) {
        velocity.z = velocity.z * -1;
      }
      p.noFill();
      p.box((p.width * 2) / 3, (p.height * 2) / 3, (p.width * 2) / 3);
      pos.add(velocity);
      // åœ¨3Dç©ºé—´ç»˜åˆ¶çƒä½“
      p.push(); // ä¿å­˜å½“å‰çš„å˜æ¢çŠ¶æ€
      p.translate(pos.x, pos.y, pos.z); // å°†åæ ‡ç³»ç§»åŠ¨åˆ°å°çƒçš„ä½ç½®
      p.fill(126, 127, 128);
      p.sphere(16); // ç»˜åˆ¶çƒä½“
      p.pop(); // æ¢å¤ä¹‹å‰çš„å˜æ¢çŠ¶æ€
    };
    const resize = () => {
      p.resizeCanvas(p.windowWidth / 2, 240);
    };
    p.setup = setup;
    p.draw = draw;
    p.windowResized = resize;
  };
  return <Basic sketch={sketch} showControls />;
};
```

</details>

#### vector subtraction

<details>
<summary>vector subtraction visualization</summary>

import Subtraction from "@components/react/p5/Vector/Subtraction";

<Subtraction client:visible />

</details>

#### vector mul divide

<details>
<summary>vector mul divide visualization</summary>

import Mul from "@components/react/p5/Vector/Mul";

<Mul client:visible />

</details>

#### magnitude

<details>
<summary>vector magnitude</summary>

import Magnitude from "@components/react/p5/Vector/Magnitude";

<Magnitude client:visible />

</details>

#### normalize

<details>
<summary>vector normalize</summary>

import Normalize from "@components/react/p5/Vector/normalize";

<Normalize client:visible />

</details>

#### Mover

<details>
<summary>Mover</summary>

import Mover from "@components/react/p5/Vector/BaseMoverDemo";

<Mover client:visible />

```tsx
import type p5 from "p5";
import Basic from "@components/react/p5/index.tsx";
import { Mover } from "./Mover";

export default () => {
  const sketch = (p: p5) => {
    let mover: Mover;
    const setup = () => {
      p.createCanvas(p.windowWidth / 2, 240);
      mover = new Mover(p);
    };
    const draw = () => {
      p.background(255);
      mover.move();
      mover.checkEdges();
      mover.show();
    };
    const resize = () => {
      p.resizeCanvas(p.windowWidth / 2, 240);
    };
    p.setup = setup;
    p.draw = draw;
    p.windowResized = resize;
  };
  return <Basic sketch={sketch} showControls></Basic>;
};
```

</details>

#### InteractiveMotionBall

<details>
<summary>Mover toggle mouse</summary>

import InteractiveMotionBall from "@components/react/p5/Vector/InteractiveMotionBall";

<InteractiveMotionBall client:visible />

```tsx
import type p5 from "p5";
import Basic from "@components/react/p5/index.tsx";

class MouseMover {
  position: p5.Vector;
  velocity: p5.Vector;
  circleRadius: number = 20;
  acceleration: p5.Vector;
  p: p5;
  color: p5.Color;
  trend: number = 0.2;
  constructor(p: p5) {
    this.circleRadius = p.random(1, 20);
    //çƒè¶Šå¤§,è¶‹åŠ¿è¶Šå°
    this.trend = p.map(this.circleRadius, 1, 20, 1, 0.5);
    this.position = p.createVector(
      p.random(this.circleRadius, p.width - this.circleRadius),
      p.random(this.circleRadius + 1, p.height - this.circleRadius - 1)
    );

    this.velocity = p.createVector(p.random(-2, 2), p.random(-2, 2));
    this.p = p;
    this.color = p.color(p.random(0, 255), p.random(0, 255), p.random(0, 255));
  }

  move() {
    let mouse = this.p.createVector(this.p.mouseX, this.p.mouseY);
    let dir = mouse;
    dir.sub(this.position);
    //é è¿‘çš„è¶‹åŠ¿
    dir.setMag(this.trend);

    // this.acceleration = this.p.createVector(this.p.random(-0.01, 0.01), this.p.random(-0.01, 0.01));
    this.acceleration = dir;
    // this.acceleration.mult(this.p.random(2));
    this.velocity.limit(10);

    this.velocity.add(this.acceleration);
    this.position.add(this.velocity);
  }

  show() {
    const p = this.p;
    p.stroke(0);
    p.fill(this.color);
    p.strokeWeight(2);
    p.circle(this.position.x, this.position.y, this.circleRadius * 2);
  }

  checkEdges() {
    const p = this.p;
    if (
      this.position.x + this.circleRadius > p.width ||
      this.position.x < this.circleRadius
    ) {
      this.velocity.x *= -1;
    }
    if (
      this.position.y + this.circleRadius > p.height ||
      this.position.y < this.circleRadius
    ) {
      this.velocity.y *= -1;
    }
  }
}

export default () => {
  const sketch = (p: p5) => {
    let movers: MouseMover[];
    const setup = () => {
      p.createCanvas(p.windowWidth / 2, 240);
      movers = new Array(1000).fill(0).map(() => new MouseMover(p));
      p.frameRate(120);
    };
    const draw = () => {
      p.background(255);
      movers.forEach(m => {
        m.move();
        m.checkEdges();
        m.show();
      });
    };
    const resize = () => {
      p.resizeCanvas(p.windowWidth / 2, 240);
    };
    p.setup = setup;
    p.draw = draw;
    p.windowResized = resize;
  };
  return <Basic sketch={sketch} showControls></Basic>;
};
```

</details>

<div class="!border-[#889] !font-extrabold p-4 m-3 ">
  Itâ€™s important to note that the moving object has no knowledge about trying to
  stop at a destination;
</div>

### 2. [Forces](https://natureofcode.com/forces/)

<details open>
<summary>ç‰›é¡¿ç¬¬äºŒå®šå¾‹</summary>

ç‰›é¡¿ç¬¬äºŒå®šå¾‹æ˜¯ç»å…¸åŠ›å­¦ä¸­çš„ä¸€ä¸ªåŸºæœ¬åŸç†,æè¿°äº†åŠ›ã€è´¨é‡å’ŒåŠ é€Ÿåº¦ä¹‹é—´çš„å…³ç³».å®ƒå¯ä»¥ç”¨æ•°å­¦å…¬å¼è¡¨ç¤ºä¸ºï¼š

\[ F = ma \]

å…¶ä¸­,

- \( F \) è¡¨ç¤ºä½œç”¨åœ¨ç‰©ä½“ä¸Šçš„åŠ›ï¼ˆå•ä½æ˜¯ç‰›é¡¿ï¼‰,
- \( m \) è¡¨ç¤ºç‰©ä½“çš„è´¨é‡ï¼ˆå•ä½æ˜¯åƒå…‹ï¼‰,
- \( a \) è¡¨ç¤ºç‰©ä½“çš„åŠ é€Ÿåº¦ï¼ˆå•ä½æ˜¯ç±³/ç§’^2ï¼‰.

è¿™ä¸ªå®šå¾‹è¯´æ˜,å½“ä¸€ä¸ªåŠ›ä½œç”¨äºä¸€ä¸ªç‰©ä½“æ—¶,å®ƒä¼šäº§ç”Ÿè¯¥ç‰©ä½“çš„åŠ é€Ÿåº¦,ä¸”è¿™ä¸ªåŠ é€Ÿåº¦çš„å¤§å°ä¸ä½œç”¨åŠ›æˆæ­£æ¯”,ä¸ç‰©ä½“çš„è´¨é‡æˆåæ¯”.æ¢å¥è¯è¯´,è¾ƒå¤§çš„åŠ›ä¼šå¯¼è‡´è¾ƒå¤§çš„åŠ é€Ÿåº¦,è€Œè¾ƒå¤§çš„è´¨é‡ä¼šå¯¼è‡´è¾ƒå°çš„åŠ é€Ÿåº¦.

</details>

Using forces, simulate a helium-filled balloon floating upward and bouncing off the top of a window. Can you add a wind force that changes over time, perhaps according to Perlin noise?

<details>
<summary>exec 2.1</summary>

import Balloon from "@components/react/p5/Forces/balloon.tsx";

<Balloon client:visible />
</details>

#### forceA mouse press to model wind

<details >
<summary>forceA</summary>

æœ‰ä¸€è¯´ä¸€,æˆ‘æƒ³è¦çš„ä¸æ˜¯è¿™ä¸ª,ä½†ä¸ç®¡æ€ä¹ˆè¯´å…ˆç•™ç€

import ForceA from "@components/react/p5/Forces/ForceA";

<ForceA client:visible />

è®©æˆ‘æ¥çœ‹çœ‹è¿™ä¸ªæ–°å†™çš„ç»„ä»¶ä¼šè¯·æ±‚å‡ æ¬¡ForceA

import ForceB from "@components/react/p5/Forces/ForceB";

<ForceB client:visible />

<details >
<summary>è¿™ä¸ªç»„ä»¶ğŸ™…,å†…éƒ¨è°ƒç”¨çš„åŠ¨æ€ç»„ä»¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸èƒ½ä½¿ç”¨useState</summary>

```tsx
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@shadcn/ui/tabs";
import Code from "@components/react/editor/code";
import { useEffect, useState, useMemo } from "react";

import { ForceA, ForceB } from "@components/react/p5/Forces/index";
import ForceACode from "@components/react/p5/Forces/ForceA.tsx?raw";
import ForceBCode from "@components/react/p5/Forces/ForceB.tsx?raw";

type ComponentName = "ForceA" | "ForceB";

const components: Record<
  ComponentName,
  { component: React.ComponentType<any>; code: string }
> = {
  ForceA: { component: ForceA, code: ForceACode },
  ForceB: { component: ForceB, code: ForceBCode },
};

interface Props {
  componentName: ComponentName;
}

export default function DynamicComponent({ componentName }: Props) {
  const [code, setCode] = useState<string>("");
  const [Component, setComponent] = useState<any>(null);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    let isMounted = true;
    const loadComponent = async () => {
      try {
        if (components[componentName]) {
          setCode(components[componentName].code);
          setComponent(components[componentName].component);
          setError(null);
        } else {
          setError(`Component not found: ${componentName}`);
        }
      } catch (error) {
        console.error(`Failed to load component: ${componentName}`, error);
        setError(`Failed to load component: ${componentName}`);
      }
    };

    loadComponent();

    return () => {
      isMounted = false;
    };
  }, [componentName]);

  const memoizedComponent = useMemo(() => Component, [Component]);

  return (
    <>
      <Tabs defaultValue="demo" className="w-full">
        <TabsList>
          <TabsTrigger value="code">Code</TabsTrigger>
          <TabsTrigger value="demo">Demo</TabsTrigger>
        </TabsList>
        <TabsContent value="code">
          {error ? error : <Code>{code}</Code>}
        </TabsContent>
        <TabsContent value="demo">{memoizedComponent}</TabsContent>
      </Tabs>
    </>
  );
}
```

åŠ¨æ€ç»„ä»¶çš„æ¸²æŸ“ä½¿ç”¨äº†useMemoæ¥é¿å…åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶é‡æ–°åˆ›å»ºç»„ä»¶.ç„¶è€Œ,useMemoåªæ˜¯å¯¹äºç»„ä»¶çš„å¼•ç”¨è¿›è¡Œäº†ç¼“å­˜,ä½†å¹¶ä¸ä¼šåœ¨ç»„ä»¶å†…éƒ¨åˆ›å»ºå®é™…çš„çŠ¶æ€.å› æ­¤,å³ä½¿ä½ åœ¨åŠ¨æ€ç»„ä»¶ä¸­è°ƒç”¨äº†useState,å®ƒä¹Ÿä¸ä¼šæ­£å¸¸å·¥ä½œ,å› ä¸ºè¯¥ç»„ä»¶çš„æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šé‡æ–°åˆ›å»º,å¹¶ä¸”æ¯æ¬¡é‡æ–°åˆ›å»ºæ—¶éƒ½ä¼šé‡æ–°åˆå§‹åŒ–çŠ¶æ€.(AI)

<details >
<summary>ç»§ç»­é—®ai,è¿™ä¸ªç»„ä»¶ä¸­åŠ¨æ€ç»„ä»¶å†…éƒ¨ä¸ºä»€ä¹ˆä¸èƒ½è°ƒç”¨useState,useRefç­‰</summary>

åœ¨ä½ çš„ä»£ç ä¸­,åŠ¨æ€ç»„ä»¶è¢«å­˜å‚¨åœ¨`Component`çŠ¶æ€ä¸­,å¹¶åœ¨æ¸²æŸ“æ—¶è¢«è°ƒç”¨.ç„¶è€Œ,React çš„è§„åˆ™æ˜¯åœ¨ç»„ä»¶çš„é¡¶å±‚ä½¿ç”¨ Hook,è€Œä¸æ˜¯åœ¨æ¡ä»¶è¯­å¥ã€å¾ªç¯æˆ–åµŒå¥—å‡½æ•°ä¸­ä½¿ç”¨.åŠ¨æ€ç»„ä»¶å†…éƒ¨å¯èƒ½ä¸èƒ½ç›´æ¥è°ƒç”¨`useState`ã€`useRef`ç­‰ Hook,å› ä¸ºå®ƒä»¬è¢«è®¤ä¸ºæ˜¯åœ¨ç»„ä»¶çš„éé¡¶å±‚è°ƒç”¨.

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜,ä½ å¯ä»¥é€šè¿‡ä¼ é€’å‡½æ•°ä½œä¸ºpropsç»™åŠ¨æ€ç»„ä»¶,ç„¶ååœ¨åŠ¨æ€ç»„ä»¶å†…éƒ¨è°ƒç”¨è¯¥å‡½æ•°æ¥æ›´æ–°çˆ¶ç»„ä»¶çš„çŠ¶æ€.ä¸‹é¢æ˜¯ä¸€ä¸ªä¿®æ”¹åçš„ç¤ºä¾‹ï¼š

```tsx
import React, { useEffect, useState, useMemo } from "react";

// å…¶ä»–å¯¼å…¥è¯­å¥

type ComponentName = "ForceA" | "ForceB";

const components: Record<
  ComponentName,
  { component: React.ComponentType<any>; code: string }
> = {
  ForceA: { component: ForceA, code: ForceACode },
  ForceB: { component: ForceB, code: ForceBCode },
};

interface Props {
  componentName: ComponentName;
}

export default function DynamicComponent({ componentName }: Props) {
  const [code, setCode] = useState<string>("");
  const [Component, setComponent] = useState<any>(null);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    let isMounted = true;
    const loadComponent = async () => {
      try {
        if (components[componentName]) {
          setCode(components[componentName].code);
          setComponent(components[componentName].component);
          setError(null);
        } else {
          setError(`Component not found: ${componentName}`);
        }
      } catch (error) {
        console.error(`Failed to load component: ${componentName}`, error);
        setError(`Failed to load component: ${componentName}`);
      }
    };

    loadComponent();

    return () => {
      isMounted = false;
    };
  }, [componentName]);

  const memoizedComponent = useMemo(() => Component, [Component]);

  const [dynamicState, setDynamicState] = useState<any>(null);

  const handleStateChange = (newState: any) => {
    setDynamicState(newState);
  };

  if (memoizedComponent) {
    // å¦‚æœåŠ¨æ€ç»„ä»¶å·²åŠ è½½,å°†åŠ¨æ€ç»„ä»¶æ¸²æŸ“å‡ºæ¥,å¹¶ä¼ é€’ä¸€ä¸ªç”¨äºæ›´æ–°çˆ¶ç»„ä»¶çŠ¶æ€çš„å‡½æ•°ä½œä¸º props
    return (
      <>
        <Tabs defaultValue="demo" className="w-full">
          {/* è¿™é‡Œçœç•¥ Tabs ç›¸å…³çš„ä»£ç  */}
          <TabsContent value="demo">
            <memoizedComponent handleStateChange={handleStateChange} />
          </TabsContent>
        </Tabs>
      </>
    );
  }

  // å¦‚æœåŠ¨æ€ç»„ä»¶å°šæœªåŠ è½½,æ¸²æŸ“åŠ è½½ä¸­çš„çŠ¶æ€æˆ–é”™è¯¯æ¶ˆæ¯
  return <>{/* è¿™é‡Œçœç•¥åŠ è½½ä¸­æˆ–é”™è¯¯çŠ¶æ€çš„æ¸²æŸ“ä»£ç  */}</>;
}
```

åœ¨ä¸Šè¿°ä¿®æ”¹ä¸­,åŠ¨æ€ç»„ä»¶è¢«æ¸²æŸ“å¹¶ä¼ é€’äº†ä¸€ä¸ªåä¸º`handleStateChange`çš„å‡½æ•°ä½œä¸ºprops.åœ¨åŠ¨æ€ç»„ä»¶å†…éƒ¨,ä½ å¯ä»¥è°ƒç”¨`handleStateChange`å‡½æ•°æ¥æ›´æ–°çˆ¶ç»„ä»¶çš„çŠ¶æ€.

è¿˜æ˜¯æŠ¥é”™ğŸ¤£,aiæœç„¶ä¸èƒ½æ›¿ä»£äººç±»

`React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: <Fragment />. Did you accidentally export a JSX literal instead of a component?`

</details>

</details>

</details>

import { ForceC, ForceD } from "@components/react/p5/Forces";

#### wind ForceC(éåŠ¨æ€åŠ è½½ç»„ä»¶)

<details >
<summary>ForceC å›å½’å•ç‹¬åŠ è½½ç»„ä»¶</summary>

<ForceC client:load />

ä¸ºå•¥è¿™é‡Œç¬¬ä¸€æ¬¡å¼¹ä¸å›å»äº†,ä½†åé¢åˆå¼¹åˆ°äº†ç¬¬ä¸€æ¬¡å¼¹å›å»çš„æœ€å¤§é«˜åº¦

</details>

#### a lot of Mover that ForceD

<details >
<summary>ForceD</summary>

<ForceD client:load />

å¯ä»¥çœ‹åˆ°å°çƒæ¯”å¤§çƒâ€œå¿«â€å¤šäº†

</details>

#### exercise2.3

<details>
<summary>è¶Šé è¿‘è¾¹ç¼˜,å—åˆ°çš„åæ–¹å‘çš„åŠ›è¶Šå¤§,ç›´åˆ°å°çƒæ‰å¤´</summary>

import { ForceE } from "@components/react/p5/Forces";

<ForceE client:visible />

çœŸæœ‰æ„æ€ çœŸæœ‰æ„æ€ å°±åƒæ˜¯æ‰åœ¨äº†æ°´é‡Œ

```tsx
let distanceX = p
  .createVector(p.width, moverWithWind.position.y)
  .dist(moverWithWind.position);
let distanceY = p
  .createVector(moverWithWind.position.x, p.height)
  .dist(moverWithWind.position);
if (
  distanceX < moverWithWind.circleRadius ||
  moverWithWind.position.x > p.width
) {
  moverWithWind.applyForce(p.createVector(-1, 0));
}
if (
  distanceY < moverWithWind.circleRadius ||
  moverWithWind.position.y > p.height
) {
  moverWithWind.applyForce(p.createVector(0, -1));
}
let distanceXL = p
  .createVector(0, moverWithWind.position.y)
  .dist(moverWithWind.position);
let distanceYL = p
  .createVector(moverWithWind.position.x, 0)
  .dist(moverWithWind.position);
if (distanceXL < moverWithWind.circleRadius || moverWithWind.position.x < 0) {
  moverWithWind.applyForce(p.createVector(1, 0));
}
if (distanceYL < moverWithWind.circleRadius || moverWithWind.position.y < 0) {
  moverWithWind.applyForce(p.createVector(0, 1));
}
```

ä¼˜åŒ–ä»£ç 

import ForceF from "@components/react/p5/Forces/ForceF";

<ForceF client:visible />

```tsx
const applyEdgeForce = (p, mover, position, radius, force) => {
  const distance = p.createVector(...position).dist(mover.position);
  if (
    distance < radius ||
    position[0] < 0 ||
    position[1] < 0 ||
    position[0] > p.width ||
    position[1] > p.height
  ) {
    mover.applyForce(force);
  }
};
applyEdgeForce(
  p,
  moverWithWind,
  [p.width, moverWithWind.position.y],
  moverWithWind.circleRadius,
  p.createVector(-1, 0)
);
applyEdgeForce(
  p,
  moverWithWind,
  [0, moverWithWind.position.y],
  moverWithWind.circleRadius,
  p.createVector(1, 0)
);
applyEdgeForce(
  p,
  moverWithWind,
  [moverWithWind.position.x, p.height],
  moverWithWind.circleRadius,
  p.createVector(0, -1)
);
applyEdgeForce(
  p,
  moverWithWind,
  [moverWithWind.position.x, 0],
  moverWithWind.circleRadius,
  p.createVector(0, 1)
);
```

import ForceG from "@components/react/p5/Forces/ForceG";

<ForceG client:visible />

</details>

todo: apply friction

### 3. Oscillation(æŒ¯åŠ¨)

`è§’åº¦`

#### æŒ¯åŠ¨

<details>
<summary>æŒ¯åŠ¨ç›¸å…³çš„ç‰©ç†/æ•°å­¦</summary>

æŒ¯åŠ¨ï¼ˆOscillationï¼‰æ˜¯ç‰©ç†å­¦ä¸­ä¸€ä¸ªé‡è¦çš„æ¦‚å¿µï¼Œæ¶‰åŠåˆ°å¤šä¸ªæ•°å­¦å’Œç‰©ç†çŸ¥è¯†ã€‚æŒ¯åŠ¨é€šå¸¸æŒ‡çš„æ˜¯ç‰©ä½“å›´ç»•æŸä¸ªå¹³è¡¡ä½ç½®çš„å‘¨æœŸæ€§è¿åŠ¨ã€‚ä»¥ä¸‹æ˜¯ä¸æŒ¯åŠ¨ç›¸å…³çš„ä¸€äº›åŸºæœ¬æ¦‚å¿µå’ŒçŸ¥è¯†ï¼š

1. **ç®€è°æŒ¯åŠ¨**ï¼šç®€è°æŒ¯åŠ¨æ˜¯æœ€åŸºæœ¬çš„æŒ¯åŠ¨å½¢å¼ï¼Œæè¿°çš„æ˜¯ç‰©ä½“åœ¨å¹³è¡¡ä½ç½®é™„è¿‘çš„è¿åŠ¨ã€‚å…¶ç‰¹ç‚¹æ˜¯åŠ é€Ÿåº¦ä¸ä½ç§»æˆæ­£æ¯”ä¸”æ–¹å‘ç›¸åï¼Œç¬¦åˆèƒ¡å…‹å®šå¾‹ã€‚ç®€è°æŒ¯åŠ¨çš„æ•°å­¦è¡¨è¾¾å¼ä¸ºï¼š
   \[
   x(t) = A \sin(\omega t + \phi)
   \]
   å…¶ä¸­ï¼Œ\(x(t)\) æ˜¯ä½ç§»ï¼Œ\(A\) æ˜¯æŒ¯å¹…ï¼Œ\(\omega\) æ˜¯è§’é¢‘ç‡ï¼Œ\(\phi\) æ˜¯åˆç›¸ä½ã€‚

2. **é¢‘ç‡å’Œå‘¨æœŸ**ï¼šé¢‘ç‡ï¼ˆ\(f\)ï¼‰æ˜¯å•ä½æ—¶é—´å†…å®Œæˆçš„æŒ¯åŠ¨æ¬¡æ•°ï¼Œå‘¨æœŸï¼ˆ\(T\)ï¼‰æ˜¯å®Œæˆä¸€æ¬¡æŒ¯åŠ¨æ‰€éœ€çš„æ—¶é—´ã€‚å®ƒä»¬ä¹‹é—´çš„å…³ç³»ä¸ºï¼š
   \[
   f = \frac{1}{T}
   \]

3. **èƒ½é‡**ï¼šåœ¨æŒ¯åŠ¨è¿‡ç¨‹ä¸­ï¼Œç³»ç»Ÿçš„èƒ½é‡åœ¨åŠ¨èƒ½å’ŒåŠ¿èƒ½ä¹‹é—´è½¬æ¢ã€‚åœ¨ç®€è°æŒ¯åŠ¨ä¸­ï¼ŒåŠ¿èƒ½å’ŒåŠ¨èƒ½çš„æ€»å’Œä¿æŒä¸å˜ï¼Œè¡¨ç°ä¸ºæœºæ¢°èƒ½å®ˆæ’ã€‚

4. **é˜»å°¼æŒ¯åŠ¨**ï¼šå®é™…ç³»ç»Ÿä¸­ï¼ŒæŒ¯åŠ¨å¾€å¾€ä¼šå—åˆ°é˜»åŠ›ï¼ˆå¦‚æ‘©æ“¦åŠ›ï¼‰çš„å½±å“ï¼Œå¯¼è‡´æŒ¯å¹…é€æ¸å‡å°ï¼Œè¿™ç§ç°è±¡ç§°ä¸ºé˜»å°¼æŒ¯åŠ¨ã€‚é˜»å°¼æŒ¯åŠ¨çš„æ–¹ç¨‹é€šå¸¸åŒ…å«ä¸€ä¸ªé˜»å°¼é¡¹ï¼Œæè¿°èƒ½é‡çš„æŸå¤±ã€‚

5. **å…±æŒ¯**ï¼šå½“å¤–éƒ¨é©±åŠ¨åŠ›çš„é¢‘ç‡ä¸ç³»ç»Ÿçš„è‡ªç„¶é¢‘ç‡ç›¸åŒ¹é…æ—¶ï¼Œä¼šå‘ç”Ÿå…±æŒ¯ç°è±¡ï¼Œå¯¼è‡´æŒ¯å¹…æ˜¾è‘—å¢åŠ ã€‚è¿™åœ¨è®¸å¤šç‰©ç†å’Œå·¥ç¨‹åº”ç”¨ä¸­éƒ½éå¸¸é‡è¦ã€‚

6. **æ•°å­¦å·¥å…·**ï¼šæŒ¯åŠ¨åˆ†æå¸¸ç”¨åˆ°ä¸‰è§’å‡½æ•°ã€å¾®åˆ†æ–¹ç¨‹å’Œçº¿æ€§ä»£æ•°ç­‰æ•°å­¦å·¥å…·ï¼Œå¸®åŠ©æè¿°å’Œè§£å†³æŒ¯åŠ¨ç³»ç»Ÿçš„åŠ¨æ€è¡Œä¸ºã€‚

ç†è§£è¿™äº›åŸºæœ¬æ¦‚å¿µæœ‰åŠ©äºæ·±å…¥ç ”ç©¶æŒ¯åŠ¨ç°è±¡åŠå…¶åœ¨ç‰©ç†å­¦ã€å·¥ç¨‹å­¦å’Œå…¶ä»–ç›¸å…³é¢†åŸŸçš„åº”ç”¨ã€‚

</details>

#### angles

<details open>
<summary>angles</summary>

åœ¨ p5.js ä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œè§’åº¦æ˜¯ä»¥å¼§åº¦ï¼ˆradiansï¼‰ä¸ºå•ä½è¿›è¡Œæµ‹é‡çš„ï¼Œè€Œä¸æ˜¯ä»¥åº¦ï¼ˆdegreesï¼‰ä¸ºå•ä½ã€‚å¼§åº¦æ˜¯ä¸€ç§è§’åº¦çš„åº¦é‡æ–¹å¼ï¼Œå®ƒæ˜¯é€šè¿‡åœ†å¼§çš„é•¿åº¦ä¸åœ†çš„åŠå¾„ä¹‹é—´çš„æ¯”ç‡æ¥å®šä¹‰çš„ã€‚å…·ä½“æ¥è¯´ï¼Œä¸€ä¸ªå¼§åº¦æ˜¯æŒ‡å¼§é•¿ç­‰äºåŠå¾„çš„è§’åº¦ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›å¸¸è§çš„è§’åº¦ä¸å¼§åº¦ä¹‹é—´çš„è½¬æ¢å…³ç³»ï¼š

- ä¸€ä¸ªå®Œæ•´çš„åœ†ï¼ˆ360åº¦ï¼‰ç­‰äº $2\pi$ å¼§åº¦ã€‚
- 180åº¦ç­‰äº$\Pi$ å¼§åº¦ã€‚
- 90åº¦ç­‰äº $\frac{\pi}{2}$ å¼§åº¦ã€‚

è¿™æ„å‘³ç€åœ¨ä½¿ç”¨ p5.js è¿›è¡Œå›¾å½¢ç»˜åˆ¶æ—¶ï¼Œå¦‚æœä½ æƒ³ä½¿ç”¨åº¦æ•°æ¥æŒ‡å®šè§’åº¦ï¼Œä½ éœ€è¦å°†åº¦æ•°è½¬æ¢ä¸ºå¼§åº¦ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å…¬å¼è¿›è¡Œè½¬æ¢ï¼š

$$
\text{å¼§åº¦} = \text{åº¦æ•°} \times \frac{\pi}{180}
$$

äº†è§£è¿™ä¸€ç‚¹å¯¹äºåœ¨ p5.js ä¸­è¿›è¡Œæ—‹è½¬ã€ç»˜åˆ¶å½¢çŠ¶å’Œå¤„ç†åŠ¨ç”»ç­‰æ“ä½œéå¸¸é‡è¦ã€‚

import Angle from "@components/react/p5/Oscillation/angle";

<Angle client:visible />

```tsx
const sketch = (p: p5) => {
  const setup = () => {
    p.createCanvas(p.windowWidth / 2, 240);
    p.angleMode(p.DEGREES);
    p.frameRate(60);
  };
  const draw = () => {
    p.background(250);
    p.push();
    p.translate(p.width / 2, p.height / 2);
    p.rotate(p.frameCount);
    // center
    p.line(-50, 0, 50, 0);
    //çº¿çš„ä¸¤ç«¯ç”»ä¸¤ä¸ªå®å¿ƒåœ†
    p.fill(255, 0, 0);
    p.ellipse(-50, 0, 10);
    p.text("å¼€å§‹", -60, 20);

    p.ellipse(50, 0, 10);
    p.text("ç»“æŸ", 40, 20);

    p.fill(0);
    p.text(p.frameCount % 360, -5, 20);
    p.pop();
  };
  const resize = () => {
    p.resizeCanvas(p.windowWidth / 2, 240);
  };
  p.setup = () => {
    setup();
  };
  p.draw = draw;
  p.windowResized = resize;
};
```

</details>

#### åŠ é€Ÿåº¦

<details>
<summary>åŠ é€Ÿåº¦</summary>

import AngleVelocity from "@components/react/p5/Oscillation/angleAcceleration.tsx";

<AngleVelocity client:visible />

</details>

<details>
<summary>mover add rotate</summary>

import AngleMover from "@components/react/p5/Oscillation/angleMover.tsx";

<AngleMover client:visible />

- mover add force

import AngleAttractMover from "@components/react/p5/Oscillation/angleAttractMover.tsx";

<AngleAttractMover client:visible />

</details>

### 4. Particle System

### 5. Autonomous Agents

### 6. Physical Libraries

### 7. Cellular Automata

### 8. Fractals

### 9. Evolutionary Computing

### 10. Neural Networks

### 11. Neuroevolution

## p5 art

### flow field

<blockquote>
<details open>
<summary>flow field</summary>

<details>
<summary>FlowFieldA</summary>

import FlowFieldA from "@components/react/p5/art/flowFieldA";

<FlowFieldA client:visible />

```tsx
import type p5 from "p5";
import Basic from "@components/react/p5/index.tsx";
import { Slider } from "@shadcn/ui/slider";
import { cn } from "@utils/utils";
import { useDebounce } from "@uidotdev/usehooks";
import { useCallback, useState } from "react";

export default () => {
  let [density, setDensity] = useState(30);
  let debounceDensity = useDebounce(density, 200);
  const sketch = useCallback(
    (p: p5) => {
      let points: p5.Vector[];
      let mult: number;
      const setup = () => {
        points = [];
        mult = 0.005;
        p.createCanvas(p.windowHeight / 2, p.windowHeight / 2);
        p.noiseDetail(1, 0.5);
        // p.angleMode(p.DEGREES);
        p.frameRate(120);
        p.pixelDensity(3);
        p.background(0);
        let density = debounceDensity || 200;
        let space = p.width / density;

        for (let i = 0; i < p.width; i += space) {
          for (let j = 0; j < p.height; j += space) {
            let point = p.createVector(i, j);
            points.push(point);
          }
        }
      };
      const draw = () => {
        if (p.frameCount > 1200) {
          p.noLoop();
          return;
        } else {
          p.noStroke();
          p.fill(255);
          for (let i = 0; i < points.length; i++) {
            let r = p.map(points[i].x, 0, p.width, 50, 255);
            let g = p.map(points[i].y, 0, p.height, 255, 50);
            let b = p.map(points[i].x, 0, p.width, 255, 50);
            p.fill(r, g, b);
            let noiseX = points[i].x * mult;
            let noiseY = points[i].y * mult;
            let angle = p.map(p.noise(noiseX, noiseY), 0, 1, 0, 720);
            let walk = p.createVector(p.cos(angle) * 1, p.sin(angle) * 1);
            points[i].add(walk);
            p.ellipse(points[i].x, points[i].y, 1, 1);
          }
        }
      };
      const resize = setup;
      p.setup = setup;
      p.draw = draw;
      // p.mouseClicked = () => {
      //     console.log(p.mouseX,p.mouseY);

      //     if (p.mouseX >= 0 && p.mouseY >= 0) {
      //         p.saveCanvas('flowFieldA', 'png')
      //     }

      // };
      p.windowResized = resize;
    },
    [debounceDensity]
  );
  return (
    <>
      å¯†åº¦{density}
      <Slider
        defaultValue={[30]}
        max={40}
        min={20}
        step={1}
        className={cn("w-[100%] m-4")}
        onValueChange={value => {
          setDensity(value[0]);
        }}
        value={[density]}
      />
      <Basic sketch={sketch}></Basic>
    </>
  );
};
```

</details>

- after i changed walker angle

<details>
<summary>FlowFieldB</summary>

import FlowFieldB from "@components/react/p5/art/flowFieldB";

<FlowFieldB client:visible />

</details>

error

</details>
</blockquote>

### è´¨æ•°èºæ—‹

<details>
<summary>prime spiral points</summary>

import PrimeSpiral from "@components/react/p5/art/primeSpiral";

<PrimeSpiral client:visible />

```tsx
import type p5 from "p5";
import Basic from "@components/react/p5/index.tsx";
import { useCallback, useState } from "react";
import { useDebounce } from "@uidotdev/usehooks";
import { Slider } from "@shadcn/ui/slider";
import { cn } from "@utils/utils";

export default () => {
  let [Num, setNum] = useState(5);
  let debounceNum = useDebounce(Num, 200);

  const sketch = useCallback(
    (p: p5) => {
      let points: p5.Vector[] = [];

      const setup = () => {
        p.createCanvas(p.windowWidth / 2, p.windowWidth / 2);
        for (let i = 0; i < (p.windowWidth * debounceNum) / p.PI; i++) {
          let vector = p.createVector(i, i);
          points.push(vector);
        }
        p.background(255);
        p.translate(p.windowWidth / 4, p.windowWidth / 4);
        p.stroke(0);
        p.fill(0);
        p.line(0, p.height / 2, p.width, p.height / 2);
        p.line(p.width / 2, 0, p.width / 2, p.height);
        p.noStroke();
        for (let i = 0; i < points.length; i++) {
          let len = points[i].x;
          let x1 = p.cos(len) * len;
          let y1 = p.sin(len) * len;
          x1 = Number(x1.toFixed(2));
          y1 = Number(y1.toFixed(2));
          p.ellipse(
            x1 / debounceNum,
            y1 / debounceNum,
            debounceNum,
            debounceNum
          );
        }
      };
      const draw = () => {};
      const resize = () => {
        p.resizeCanvas(p.windowWidth / 2, 240);
      };
      p.setup = setup;
      p.draw = draw;
      p.windowResized = resize;
    },
    [debounceNum]
  );
  return (
    <>
      æ•°é‡{Num}
      <Slider
        defaultValue={[5]}
        max={10}
        min={1}
        step={0.1}
        className={cn("w-[100%] m-4")}
        onValueChange={value => {
          setNum(value[0]);
        }}
        value={[Num]}
      />
      <Basic sketch={sketch}></Basic>
    </>
  );
};
```

</details>

<details>
<summary>prime spiral curve</summary>

import PrimeSpiralCurve from "@components/react/p5/art/primeSpiralCurve";

<PrimeSpiralCurve client:visible />

</details>
<details>
<summary>prime spiral step</summary>

import PrimeSpiralStep from "@components/react/p5/art/primeSpiralStep";

<PrimeSpiralStep client:visible />

</details>

### ç»“åˆtone

<details>
<summary>tone demo</summary>

import Tone from "@components/react/p5/little/tone.tsx";

<Tone hideRandom client:visible />

</details>

## links

- https://natureofcode.com/
- https://p5js.org/
- https://processing.org/
- https://www.youtube.com/@TheCodingTrain
