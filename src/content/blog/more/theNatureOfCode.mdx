---
title: nature of code
pubDatetime: 2024-01-16T06:22:18Z
postSlug: nature of code
featured: true
draft: false
tags:
  - ä»£ç çš„æœ¬è´¨
  - p5
  - canvas
  - math
  - 2024-01
description: "ä»£ç çš„æœ¬è´¨ use p5 to know the world"
---

## ç›®å½•

## nature of code

æˆ‘ä¸p5çš„ç¼˜åˆ†çœŸçš„è›®æ·±çš„,DANIEL SHIFFMANä¹Ÿç®—æ˜¯æˆ‘çš„ç¼–ç¨‹å¯è’™è€å¸ˆäº†,
nature of code,è¿™æ˜¯ä¸€æœ¬ä»–æ’°å†™çš„ä¸€æœ¬å…³äºç¼–ç¨‹å’Œè®¡ç®—æœºç”Ÿæˆè‰ºæœ¯çš„ä¹¦ç±ï¼Œè¯¦ç»†é“¾æ¥è§[â¬‡ï¸](#links)

### code template

<details>
<summary>template</summary>

import Template from "@components/react/p5/index.tsx";

<Template client:visible />

</details>

### 0. [Randomness](https://natureofcode.com/random/)

`éšæœºæ€§` `æŸæ—å™ªå£°` `æ¦‚ç‡`

#### RandomnessA

<details>
<summary>RandomnessA</summary>
```tsx
step() {
        const choice = p.floor(p.random(4));
        switch (choice) {
          case 0:
            this.x++;
            break;
          case 1:
            this.x--;
            break;
          case 2:
            this.y++;
            break;
          case 3:
            this.y--;
            break;
          default:
            break;
        }
      }
```
import RandomnessA from "@components/react/p5/Randomness/RandomnessA.tsx";

<RandomnessA client:visible />
</details>

#### RandomnessB

<details class="mt-4">
<summary>RandomnessB</summary>

```tsx
step() {
          let xStep = p.random(-1, 1);
          let yStep = p.random(-1, 1);

          this.x += xStep;
          this.y += yStep;

      }

```

import RandomnessB from "@components/react/p5/Randomness/RandomnessB.tsx";

<RandomnessB client:visible />
</details>

#### RandomnessC

<details class="mt-4">
<summary>RandomnessC</summary>

import RandomnessC from "@components/react/p5/Randomness/RandomnessC.tsx";

<RandomnessC client:visible />
</details>

#### Probability and Nonuniform Distributions

- Create a random walker that has a greater tendency to move down and to the right. (The solution follows in the next section.)

<details>
<summary>Probability and Nonuniform Distributions
æ¦‚ç‡å’Œéå‡åŒ€åˆ†å¸ƒ</summary>
```ts
let stuff = [1,1,2,4,5,6,7,8,8,8,9,9,9,9,10];
let value = random(stuff);
console.log(value);
````

```ts
let probability = 0.1;
let r = random(1);
if (r < probability) {
  console.log("success");
}
```

</details>

#### RandomnessD

<details class="mt-4">
<summary>RandomnessD  Tends to Move to the Right è¶‹äºå‘å³çš„éšæœºåˆ†å¸ƒ</summary>

import RandomnessD from "@components/react/p5/Randomness/RandomnessD.tsx";

<RandomnessD client:visible />
</details>

#### mouseX,mouseY

<details class="mt-4">

<summary>ä¸Šè¿°ä¾‹å­ä½¿ç”¨é¼ æ ‡äº¤äº’ï¼Œå³ä½¿ç”¨mouseX,mouseY</summary>

import RandomnessE from "@components/react/p5/Randomness/RandomnessE.tsx";

<RandomnessE client:visible />
</details>

#### A Normal Distributions Of Random Numbers

<details class="mt-4">
<summary>A Normal Distributions Of Random Numbers</summary>

import RandomnessF from "@components/react/p5/Randomness/RandomnessF.tsx";

<RandomnessF client:visible />

<details>
<summary>æŸ¯é‡ŒåŒ–</summary>

```tsx
export default () => {
  const common = (p: p5, sd = 0.41) => {
    const heights = [];
    p.setup = () => {
      p.createCanvas(320, 240);
      p.background(255);
      const e = 2.71828183;
      let m = 0;
      for (let i = 0; i < p.width + 1; i++) {
        let xcoord = p.map(i, 0, p.width, -3, 3);
        let sq2pi = p.sqrt(2 * p.PI); //square root of 2 * PI
        let xmsq = -1 * (xcoord - m) * (xcoord - m); //-(x - mu)^2
        let sdsq = sd * sd; //variance (standard deviation squared)
        heights[i] = (1 / (sd * sq2pi)) * p.pow(e, xmsq / sdsq); //P(x) function
      }

      p.stroke(0);
      p.strokeWeight(2);
      p.noFill();
      p.beginShape();
      for (let i = 0; i < heights.length; i++) {
        let x = i;
        let y = p.map(heights[i], 0, 1, p.height - 2, 2);
        p.vertex(x, y);
      }
      p.endShape();
    };
  };
  const sketchA = (p: p5) => common(p, 0.41);
  const sketchB = (p: p5) => common(p, 1.5);

  return (
    <>
      <div className="flex justify-around">
        <Basic sketch={sketchA}></Basic>
        <Basic sketch={sketchB}></Basic>
      </div>
    </>
  );
};
```

</details>

</details>

#### sigma

<details class="mt-4">
<summary>æ­£æ€åˆ†å¸ƒä¸æ ‡å‡†å·®</summary>
æ­£æ€åˆ†å¸ƒï¼ˆä¹Ÿç§°ä¸ºé«˜æ–¯åˆ†å¸ƒï¼‰æ˜¯ç»Ÿè®¡å­¦ä¸­ä¸€ç§é‡è¦çš„æ¦‚ç‡åˆ†å¸ƒï¼Œå…¶ç‰¹ç‚¹æ˜¯å¯¹ç§°ã€é’Ÿå½¢æ›²çº¿ã€‚åœ¨æ­£æ€åˆ†å¸ƒä¸­ï¼Œæ ‡å‡†å·®æ˜¯ä¸€ä¸ªå…³é”®çš„å‚æ•°ï¼Œå®ƒè¡¡é‡æ•°æ®é›†ä¸­çš„å€¼ä¸å¹³å‡å€¼çš„ç¦»æ•£ç¨‹åº¦ã€‚

æ ‡å‡†å·®ç”¨æ¥åº¦é‡æ•°æ®çš„ç¦»æ•£ç¨‹åº¦ï¼Œå®ƒè¶Šå¤§è¡¨ç¤ºæ•°æ®çš„æ³¢åŠ¨è¶Šå¤§ï¼Œè¶Šå°è¡¨ç¤ºæ•°æ®çš„æ³¢åŠ¨è¶Šå°ã€‚æ ‡å‡†å·®çš„è®¡ç®—å…¬å¼å¦‚ä¸‹ï¼š

$ \sigma = \sqrt{\frac{\sum\_{i=1}^{N}(x_i - \mu)^2}{N}} $

å…¶ä¸­ï¼š

- $\sigma$ æ˜¯æ ‡å‡†å·®ï¼Œ
- $N$ æ˜¯æ•°æ®é›†ä¸­çš„è§‚æµ‹å€¼æ•°é‡ï¼Œ
- $x_i$ æ˜¯æ¯ä¸ªè§‚æµ‹å€¼ï¼Œ
- $\mu$ æ˜¯æ•°æ®é›†çš„å¹³å‡å€¼ã€‚

æ­£æ€åˆ†å¸ƒçš„ç‰¹æ€§ä¹‹ä¸€æ˜¯ï¼Œçº¦68%çš„æ•°æ®åœ¨å¹³å‡å€¼é™„è¿‘çš„ä¸€ä¸ªæ ‡å‡†å·®èŒƒå›´å†…ï¼Œçº¦95%çš„æ•°æ®åœ¨ä¸¤ä¸ªæ ‡å‡†å·®èŒƒå›´å†…ï¼Œçº¦99.7%çš„æ•°æ®åœ¨ä¸‰ä¸ªæ ‡å‡†å·®èŒƒå›´å†…ã€‚

å¦‚æœä½ æœ‰ç‰¹å®šçš„æ•°æ®é›†æˆ–é—®é¢˜ï¼Œå¯ä»¥æä¾›æ›´å¤šä¿¡æ¯ï¼Œæˆ‘å¯ä»¥å¸®ä½ æ›´å…·ä½“åœ°ç†è§£å’Œè§£é‡Šã€‚

</details>

#### randomGaussian

<details class="pt-4">
<summary>[randomGaussian æ­£æ€åˆ†å¸ƒp5æ–¹æ³•](https://p5js.org/reference/#/p5/randomGaussian)</summary>

import UseRandomGaussian from "@components/react/p5/Randomness/useRandomGaussian.tsx";

<UseRandomGaussian class="mt-4" client:visible />

</details>

#### SimulatePaint

<details>
<summary>å®è·µä¸€ä¸ªæ²¹æ¼†é£æº…æ¨¡æ‹Ÿ</summary>

import SimulatePaint from "@components/react/p5/Randomness/simulatePaint.tsx";

<SimulatePaint client:visible />

<details open class="!mt-4 ">
<summary>'å®Œç¾'åœ°åœ¨type=rangeçš„inputä½¿ç”¨äº†useDebouce</summary>

```tsx
import { useDebounce } from "@uidotdev/usehooks";
...
const debouncedSd = useDebounce(sd, 300);
    const sketch = useCallback(
        (p: p5) => {
            ...
        },
        [debouncedSd]
    );
    const handleSliderChange = (val: string) => {
        setSd(parseFloat(val));
    };

    return (
        <>
            <input
                type="range"
                value={sd}
                onChange={(e) => { handleSliderChange(e.target.value) }}
            />
            ...
        </>
```

</details>

</details>

#### ResolveReject

<details>
<summary>æ¥å—æ‹’ç»åˆ†å¸ƒ</summary>

import ResolveReject from "@components/react/p5/Randomness/ResolveReject.tsx";

<ResolveReject client:visible />

</details>

#### PerlinCurve

<details>
<summary>æŸæ—å™ªå£°</summary>

import PerlinCurve from "@components/react/p5/Randomness/PerlinCurve.tsx";

<PerlinCurve client:visible />

æŸæ—å™ªå£°å°±åƒæ˜¯æŠŠæ—¶é—´åœä½äº†ï¼Œç»™äºˆå®ƒç›¸åº”tampè¿”å›è¿ç»­çš„å˜åŒ–çš„å€¼

```tsx
let time = 0;
const draw = () => {
  let xoff = time;
  for (let i = 0; i < p.width; i++) {
    let noise_height = p.noise(xoff) * p.height;
    xoff += 0.01;
    p.vertex(i, noise_height);
  }
  p.endShape();
  time += 0.01;
};
```

</details>

#### noise range

<details>
<summary>noise range</summary>

import NoiseRange from "@components/react/p5/Randomness/NoiseRange.tsx";

<NoiseRange client:visible />

ä½¿ç”¨mapæ˜ å°„noiseç”Ÿæˆçš„å€¼

</details>

#### two-dimensional noise

<details>
<summary>two-dimensional noise</summary>

import TwoDimensionalNoise from "@components/react/p5/Randomness/TwoDimensionalNoise.tsx";

<TwoDimensionalNoise client:visible />

</details>

#### generate marble

<details>
<summary>generate marble</summary>

import Marble from "@components/react/p5/Randomness/Marble.tsx";

<Marble client:visible />

</details>

#### RandomnessG

<details>

<summary>RandomnessG</summary>

import RandomnessG from "@components/react/p5/Randomness/RandomnessG.tsx";

<RandomnessG client:visible />

</details>

#### landscape

<details>
<summary>landscape</summary>

import Landscape from "@components/react/p5/Randomness/landScape.tsx";

<Landscape client:visible />
</details>

#### wind simulation

<details>
<summary>wind simulation(actually just noise)</summary>

import ComponentName from "@components/react/p5/Randomness/windSimulation.tsx";

<ComponentName client:visible />

<details>
<summary>code</summary>

```tsx
import type p5 from "p5";
import Basic from "@components/react/p5/index.tsx";

export default () => {
  const sketch = (p: p5) => {
    let yoff = 0;
    let seed = 5;
    let { PI } = p;

    const branch = (h: number, xoff: number) => {
      let sw = p.map(h, 2, 100, 1, 5);
      p.strokeWeight(sw);
      p.line(0, 0, 0, -h);
      p.translate(0, -h);

      h *= 0.7;
      xoff += 0.1;

      if (h > 4) {
        let n = p.floor(p.random(1, 5));
        for (let i = 0; i < n; i++) {
          let noise = p.noise(xoff + i, yoff);
          let theta = p.map(noise, 0, 1, -PI / 2, PI / 2);
          if (n % 2 == 0) theta *= -1;
          p.stroke(0);
          p.push();
          p.rotate(theta);
          branch(h, xoff);
          p.pop();
        }
      }
    };

    const setup = () => {
      p.createCanvas(p.windowWidth / 4 + 20, 200);
    };

    const draw = () => {
      p.background(255);
      p.translate(p.width / 2, p.height);
      yoff += 0.005;
      p.randomSeed(seed);
      branch(60, 0);
    };

    p.mouseClicked = () => {
      yoff = p.random(1000);
      seed = p.millis();
    };
    const resize = () => p.setup();
    p.setup = setup;
    p.draw = draw;
    p.windowResized = resize;
  };
  return <Basic sketch={sketch} showControls></Basic>;
};
```

</details>

</details>

todo: flow demo

<details></details>

### 1. [Vectors](https://natureofcode.com/vectors/)

#### ball

<details>
<summary>traveling around ball</summary>

import Ball from "@components/react/p5/Vector/ball";

<Ball client:visible />

```tsx
import type p5 from "p5";
import Basic from "@components/react/p5/index.tsx";

export default () => {
  const sketch = (p: p5) => {
    let x = 100;
    let y = 200;
    let xSpeed = 1.5;
    let ySpeed = 0.8;
    const setup = () => {
      p.createCanvas(p.windowWidth / 2, 240);
    };
    const draw = () => {
      p.background(255);
      x += xSpeed;
      y += ySpeed;
      if (x + 8 > p.width || x < 8) {
        xSpeed *= -1;
      }
      if (y + 8 > p.height || y < 8) {
        ySpeed *= -1;
      }
      p.stroke(10);
      p.fill(127, 30, 30);
      p.circle(x, y, 16);
    };
    const resize = () => p.setup();
    p.setup = setup;
    p.draw = draw;
    p.windowResized = resize;
  };
  return <Basic sketch={sketch} showControls></Basic>;
};
```

</details>

#### still ball but use p5.Vector

<details>
<summary>vector add</summary>

import BallUseVector from "@components/react/p5/Vector/ballUseVector";

<BallUseVector client:visible />

```tsx
import type p5 from "p5";
import Basic from "@components/react/p5/index.tsx";

export default () => {
  const sketch = (p: p5) => {
    let pos, velocity;
    const setup = () => {
      p.createCanvas(p.windowWidth / 2, 80);
      pos = p.createVector(p.width / 2, p.height / 2);
      velocity = p.createVector(1.2, 0.8);
    };
    const draw = () => {
      p.background(204);
      p.fill(255, 0, 0);
      p.stroke(88);

      if (pos.x + 8 > p.width || pos.x < 8) {
        velocity.x = velocity.x * -1;
      }
      if (pos.y + 8 > p.height || pos.y < 8) {
        velocity.y = velocity.y * -1;
      }
      pos.add(velocity);
      p.circle(pos.x, pos.y, 16);
    };
    const resize = () => p.setup();
    p.setup = setup;
    p.draw = draw;
    p.windowResized = resize;
  };
  return <Basic sketch={sketch} showControls></Basic>;
};
```

</details>

#### 3d

<details>
<summary>ball in 3d</summary>

import BallUseVector3D from "@components/react/p5/Vector/ballUseVector3D";

<BallUseVector3D client:visible />

```tsx
import type p5 from "p5";
import Basic from "@components/react/p5/index.tsx";

export default () => {
  const sketch = (p: p5) => {
    let pos, velocity;
    const setup = () => {
      p.createCanvas(p.windowWidth / 2, p.windowHeight / 2, p.WEBGL); // åˆ›å»ºä¸€ä¸ª3Dç”»å¸ƒ
      pos = p.createVector(0, 0, 0); // åˆå§‹ä½ç½®
      velocity = p.createVector(1, 1, 4); // åˆå§‹é€Ÿåº¦
    };
    const draw = () => {
      p.background(204);
      p.fill(255, 0, 0);
      p.stroke(88);
      console.log(pos, p.width);

      p.orbitControl();

      // è¾¹ç•Œæ£€æµ‹
      if (pos.x + 16 > p.width / 3 || pos.x - 16 < -p.width / 3) {
        velocity.x = velocity.x * -1;
      }
      if (pos.y + 16 > p.height / 3 || pos.y - 16 < -p.height / 3) {
        velocity.y = velocity.y * -1;
      }
      if (pos.z + 16 > p.width / 3 || pos.z - 16 < -p.width / 3) {
        velocity.z = velocity.z * -1;
      }
      p.noFill();
      p.box((p.width * 2) / 3, (p.height * 2) / 3, (p.width * 2) / 3);
      pos.add(velocity);
      // åœ¨3Dç©ºé—´ç»˜åˆ¶çƒä½“
      p.push(); // ä¿å­˜å½“å‰çš„å˜æ¢çŠ¶æ€
      p.translate(pos.x, pos.y, pos.z); // å°†åæ ‡ç³»ç§»åŠ¨åˆ°å°çƒçš„ä½ç½®
      p.fill(126, 127, 128);
      p.sphere(16); // ç»˜åˆ¶çƒä½“
      p.pop(); // æ¢å¤ä¹‹å‰çš„å˜æ¢çŠ¶æ€
    };
    const resize = () => p.setup();
    p.setup = setup;
    p.draw = draw;
    p.windowResized = resize;
  };
  return <Basic sketch={sketch} showControls />;
};
```

</details>

#### vector subtraction

<details>
<summary>vector subtraction visualization</summary>

import Subtraction from "@components/react/p5/Vector/Subtraction";

<Subtraction client:visible />

</details>

#### vector mul divide

<details>
<summary>vector mul divide visualization</summary>

import Mul from "@components/react/p5/Vector/Mul";

<Mul client:visible />

</details>

#### magnitude

<details>
<summary>vector magnitude</summary>

import Magnitude from "@components/react/p5/Vector/Magnitude";

<Magnitude client:visible />

</details>

#### normalize

<details>
<summary>vector normalize</summary>

import Normalize from "@components/react/p5/Vector/normalize";

<Normalize client:visible />

</details>

#### Mover

<details>
<summary>Mover</summary>

import Mover from "@components/react/p5/Vector/BaseMoverDemo";

<Mover client:visible />

```tsx
import type p5 from "p5";
import Basic from "@components/react/p5/index.tsx";
import { Mover } from "./Mover";

export default () => {
  const sketch = (p: p5) => {
    let mover: Mover;
    const setup = () => {
      p.createCanvas(p.windowWidth / 2, 240);
      mover = new Mover(p);
    };
    const draw = () => {
      p.background(255);
      mover.move();
      mover.checkEdges();
      mover.show();
    };
    const resize = () => p.setup();
    p.setup = setup;
    p.draw = draw;
    p.windowResized = resize;
  };
  return <Basic sketch={sketch} showControls></Basic>;
};
```

</details>

#### InteractiveMotionBall

<details>
<summary>Mover toggle mouse</summary>

import InteractiveMotionBall from "@components/react/p5/Vector/InteractiveMotionBall";

<InteractiveMotionBall client:visible />

```tsx
import type p5 from "p5";
import Basic from "@components/react/p5/index.tsx";

class MouseMover {
  position: p5.Vector;
  velocity: p5.Vector;
  circleRadius: number = 20;
  acceleration: p5.Vector;
  p: p5;
  color: p5.Color;
  trend: number = 0.2;
  constructor(p: p5) {
    this.circleRadius = p.random(1, 20);
    //çƒè¶Šå¤§ï¼Œè¶‹åŠ¿è¶Šå°
    this.trend = p.map(this.circleRadius, 1, 20, 1, 0.5);
    this.position = p.createVector(
      p.random(this.circleRadius, p.width - this.circleRadius),
      p.random(this.circleRadius + 1, p.height - this.circleRadius - 1)
    );

    this.velocity = p.createVector(p.random(-2, 2), p.random(-2, 2));
    this.p = p;
    this.color = p.color(p.random(0, 255), p.random(0, 255), p.random(0, 255));
  }

  move() {
    let mouse = this.p.createVector(this.p.mouseX, this.p.mouseY);
    let dir = mouse;
    dir.sub(this.position);
    //é è¿‘çš„è¶‹åŠ¿
    dir.setMag(this.trend);

    // this.acceleration = this.p.createVector(this.p.random(-0.01, 0.01), this.p.random(-0.01, 0.01));
    this.acceleration = dir;
    // this.acceleration.mult(this.p.random(2));
    this.velocity.limit(10);

    this.velocity.add(this.acceleration);
    this.position.add(this.velocity);
  }

  show() {
    const p = this.p;
    p.stroke(0);
    p.fill(this.color);
    p.strokeWeight(2);
    p.circle(this.position.x, this.position.y, this.circleRadius * 2);
  }

  checkEdges() {
    const p = this.p;
    if (
      this.position.x + this.circleRadius > p.width ||
      this.position.x < this.circleRadius
    ) {
      this.velocity.x *= -1;
    }
    if (
      this.position.y + this.circleRadius > p.height ||
      this.position.y < this.circleRadius
    ) {
      this.velocity.y *= -1;
    }
  }
}

export default () => {
  const sketch = (p: p5) => {
    let movers: MouseMover[];
    const setup = () => {
      p.createCanvas(p.windowWidth / 2, 240);
      movers = new Array(1000).fill(0).map(() => new MouseMover(p));
      p.frameRate(120);
    };
    const draw = () => {
      p.background(255);
      movers.forEach(m => {
        m.move();
        m.checkEdges();
        m.show();
      });
    };
    const resize = () => p.setup();
    p.setup = setup;
    p.draw = draw;
    p.windowResized = resize;
  };
  return <Basic sketch={sketch} showControls></Basic>;
};
```

</details>

<div class="!border-[#889] !font-extrabold p-4 m-3 ">
  Itâ€™s important to note that the moving object has no knowledge about trying to
  stop at a destination;
</div>

### 2. [Forces](https://natureofcode.com/forces/)

<details>
<summary>ç‰›é¡¿ç¬¬äºŒå®šå¾‹</summary>

ç‰›é¡¿ç¬¬äºŒå®šå¾‹æ˜¯ç»å…¸åŠ›å­¦ä¸­çš„ä¸€ä¸ªåŸºæœ¬åŸç†ï¼Œæè¿°äº†åŠ›ã€è´¨é‡å’ŒåŠ é€Ÿåº¦ä¹‹é—´çš„å…³ç³»ã€‚å®ƒå¯ä»¥ç”¨æ•°å­¦å…¬å¼è¡¨ç¤ºä¸ºï¼š

\[ F = ma \]

å…¶ä¸­ï¼Œ

- \( F \) è¡¨ç¤ºä½œç”¨åœ¨ç‰©ä½“ä¸Šçš„åŠ›ï¼ˆå•ä½æ˜¯ç‰›é¡¿ï¼‰ï¼Œ
- \( m \) è¡¨ç¤ºç‰©ä½“çš„è´¨é‡ï¼ˆå•ä½æ˜¯åƒå…‹ï¼‰ï¼Œ
- \( a \) è¡¨ç¤ºç‰©ä½“çš„åŠ é€Ÿåº¦ï¼ˆå•ä½æ˜¯ç±³/ç§’^2ï¼‰ã€‚

è¿™ä¸ªå®šå¾‹è¯´æ˜ï¼Œå½“ä¸€ä¸ªåŠ›ä½œç”¨äºä¸€ä¸ªç‰©ä½“æ—¶ï¼Œå®ƒä¼šäº§ç”Ÿè¯¥ç‰©ä½“çš„åŠ é€Ÿåº¦ï¼Œä¸”è¿™ä¸ªåŠ é€Ÿåº¦çš„å¤§å°ä¸ä½œç”¨åŠ›æˆæ­£æ¯”ï¼Œä¸ç‰©ä½“çš„è´¨é‡æˆåæ¯”ã€‚æ¢å¥è¯è¯´ï¼Œè¾ƒå¤§çš„åŠ›ä¼šå¯¼è‡´è¾ƒå¤§çš„åŠ é€Ÿåº¦ï¼Œè€Œè¾ƒå¤§çš„è´¨é‡ä¼šå¯¼è‡´è¾ƒå°çš„åŠ é€Ÿåº¦ã€‚

</details>

Using forces, simulate a helium-filled balloon floating upward and bouncing off the top of a window. Can you add a wind force that changes over time, perhaps according to Perlin noise?

<details>
<summary>exec 2.1</summary>

import Balloon from "@components/react/p5/Forces/balloon.tsx";

<Balloon client:visible />
</details>

#### forceA mouse press to model wind

<details >
<summary>forceA</summary>

æœ‰ä¸€è¯´ä¸€ï¼Œæˆ‘æƒ³è¦çš„ä¸æ˜¯è¿™ä¸ªï¼Œä½†ä¸ç®¡æ€ä¹ˆè¯´å…ˆç•™ç€

import TabsCode from "@components/react/UI/TabsCode";

<TabsCode componentName="ForceA" client:load />

è®©æˆ‘æ¥çœ‹çœ‹è¿™ä¸ªæ–°å†™çš„ç»„ä»¶ä¼šè¯·æ±‚å‡ æ¬¡ForceA

<TabsCode componentName="ForceB" client:load />

<details >
<summary>è¿™ä¸ªç»„ä»¶ğŸ™…ï¼Œå†…éƒ¨è°ƒç”¨çš„åŠ¨æ€ç»„ä»¶ä¸çŸ¥é“ä¸ºä»€ä¹ˆä¸èƒ½ä½¿ç”¨useState</summary>

```tsx
import { Tabs, TabsContent, TabsList, TabsTrigger } from "@shadcn/ui/tabs";
import Code from "@components/react/editor/code";
import { useEffect, useState, useMemo } from "react";

import { ForceA, ForceB } from "@components/react/p5/Forces/index";
import ForceACode from "@components/react/p5/Forces/ForceA.tsx?raw";
import ForceBCode from "@components/react/p5/Forces/ForceB.tsx?raw";

type ComponentName = "ForceA" | "ForceB";

const components: Record<
  ComponentName,
  { component: React.ComponentType<any>; code: string }
> = {
  ForceA: { component: ForceA, code: ForceACode },
  ForceB: { component: ForceB, code: ForceBCode },
};

interface Props {
  componentName: ComponentName;
}

export default function DynamicComponent({ componentName }: Props) {
  const [code, setCode] = useState<string>("");
  const [Component, setComponent] = useState<any>(null);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    let isMounted = true;
    const loadComponent = async () => {
      try {
        if (components[componentName]) {
          setCode(components[componentName].code);
          setComponent(components[componentName].component);
          setError(null);
        } else {
          setError(`Component not found: ${componentName}`);
        }
      } catch (error) {
        console.error(`Failed to load component: ${componentName}`, error);
        setError(`Failed to load component: ${componentName}`);
      }
    };

    loadComponent();

    return () => {
      isMounted = false;
    };
  }, [componentName]);

  const memoizedComponent = useMemo(() => Component, [Component]);

  return (
    <>
      <Tabs defaultValue="demo" className="w-full">
        <TabsList>
          <TabsTrigger value="code">Code</TabsTrigger>
          <TabsTrigger value="demo">Demo</TabsTrigger>
        </TabsList>
        <TabsContent value="code">
          {error ? error : <Code>{code}</Code>}
        </TabsContent>
        <TabsContent value="demo">{memoizedComponent}</TabsContent>
      </Tabs>
    </>
  );
}
```

åŠ¨æ€ç»„ä»¶çš„æ¸²æŸ“ä½¿ç”¨äº†useMemoæ¥é¿å…åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶é‡æ–°åˆ›å»ºç»„ä»¶ã€‚ç„¶è€Œï¼ŒuseMemoåªæ˜¯å¯¹äºç»„ä»¶çš„å¼•ç”¨è¿›è¡Œäº†ç¼“å­˜ï¼Œä½†å¹¶ä¸ä¼šåœ¨ç»„ä»¶å†…éƒ¨åˆ›å»ºå®é™…çš„çŠ¶æ€ã€‚å› æ­¤ï¼Œå³ä½¿ä½ åœ¨åŠ¨æ€ç»„ä»¶ä¸­è°ƒç”¨äº†useStateï¼Œå®ƒä¹Ÿä¸ä¼šæ­£å¸¸å·¥ä½œï¼Œå› ä¸ºè¯¥ç»„ä»¶çš„æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šé‡æ–°åˆ›å»ºï¼Œå¹¶ä¸”æ¯æ¬¡é‡æ–°åˆ›å»ºæ—¶éƒ½ä¼šé‡æ–°åˆå§‹åŒ–çŠ¶æ€ã€‚(AI)

<details >
<summary>ç»§ç»­é—®ai,è¿™ä¸ªç»„ä»¶ä¸­åŠ¨æ€ç»„ä»¶å†…éƒ¨ä¸ºä»€ä¹ˆä¸èƒ½è°ƒç”¨useState,useRefç­‰</summary>

åœ¨ä½ çš„ä»£ç ä¸­ï¼ŒåŠ¨æ€ç»„ä»¶è¢«å­˜å‚¨åœ¨`Component`çŠ¶æ€ä¸­ï¼Œå¹¶åœ¨æ¸²æŸ“æ—¶è¢«è°ƒç”¨ã€‚ç„¶è€Œï¼ŒReact çš„è§„åˆ™æ˜¯åœ¨ç»„ä»¶çš„é¡¶å±‚ä½¿ç”¨ Hookï¼Œè€Œä¸æ˜¯åœ¨æ¡ä»¶è¯­å¥ã€å¾ªç¯æˆ–åµŒå¥—å‡½æ•°ä¸­ä½¿ç”¨ã€‚åŠ¨æ€ç»„ä»¶å†…éƒ¨å¯èƒ½ä¸èƒ½ç›´æ¥è°ƒç”¨`useState`ã€`useRef`ç­‰ Hookï¼Œå› ä¸ºå®ƒä»¬è¢«è®¤ä¸ºæ˜¯åœ¨ç»„ä»¶çš„éé¡¶å±‚è°ƒç”¨ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½ å¯ä»¥é€šè¿‡ä¼ é€’å‡½æ•°ä½œä¸ºpropsç»™åŠ¨æ€ç»„ä»¶ï¼Œç„¶ååœ¨åŠ¨æ€ç»„ä»¶å†…éƒ¨è°ƒç”¨è¯¥å‡½æ•°æ¥æ›´æ–°çˆ¶ç»„ä»¶çš„çŠ¶æ€ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä¿®æ”¹åçš„ç¤ºä¾‹ï¼š

```tsx
import React, { useEffect, useState, useMemo } from "react";

// å…¶ä»–å¯¼å…¥è¯­å¥

type ComponentName = "ForceA" | "ForceB";

const components: Record<
  ComponentName,
  { component: React.ComponentType<any>; code: string }
> = {
  ForceA: { component: ForceA, code: ForceACode },
  ForceB: { component: ForceB, code: ForceBCode },
};

interface Props {
  componentName: ComponentName;
}

export default function DynamicComponent({ componentName }: Props) {
  const [code, setCode] = useState<string>("");
  const [Component, setComponent] = useState<any>(null);
  const [error, setError] = useState<string | null>(null);

  useEffect(() => {
    let isMounted = true;
    const loadComponent = async () => {
      try {
        if (components[componentName]) {
          setCode(components[componentName].code);
          setComponent(components[componentName].component);
          setError(null);
        } else {
          setError(`Component not found: ${componentName}`);
        }
      } catch (error) {
        console.error(`Failed to load component: ${componentName}`, error);
        setError(`Failed to load component: ${componentName}`);
      }
    };

    loadComponent();

    return () => {
      isMounted = false;
    };
  }, [componentName]);

  const memoizedComponent = useMemo(() => Component, [Component]);

  const [dynamicState, setDynamicState] = useState<any>(null);

  const handleStateChange = (newState: any) => {
    setDynamicState(newState);
  };

  if (memoizedComponent) {
    // å¦‚æœåŠ¨æ€ç»„ä»¶å·²åŠ è½½ï¼Œå°†åŠ¨æ€ç»„ä»¶æ¸²æŸ“å‡ºæ¥ï¼Œå¹¶ä¼ é€’ä¸€ä¸ªç”¨äºæ›´æ–°çˆ¶ç»„ä»¶çŠ¶æ€çš„å‡½æ•°ä½œä¸º props
    return (
      <>
        <Tabs defaultValue="demo" className="w-full">
          {/* è¿™é‡Œçœç•¥ Tabs ç›¸å…³çš„ä»£ç  */}
          <TabsContent value="demo">
            <memoizedComponent handleStateChange={handleStateChange} />
          </TabsContent>
        </Tabs>
      </>
    );
  }

  // å¦‚æœåŠ¨æ€ç»„ä»¶å°šæœªåŠ è½½ï¼Œæ¸²æŸ“åŠ è½½ä¸­çš„çŠ¶æ€æˆ–é”™è¯¯æ¶ˆæ¯
  return <>{/* è¿™é‡Œçœç•¥åŠ è½½ä¸­æˆ–é”™è¯¯çŠ¶æ€çš„æ¸²æŸ“ä»£ç  */}</>;
}
```

åœ¨ä¸Šè¿°ä¿®æ”¹ä¸­ï¼ŒåŠ¨æ€ç»„ä»¶è¢«æ¸²æŸ“å¹¶ä¼ é€’äº†ä¸€ä¸ªåä¸º`handleStateChange`çš„å‡½æ•°ä½œä¸ºpropsã€‚åœ¨åŠ¨æ€ç»„ä»¶å†…éƒ¨ï¼Œä½ å¯ä»¥è°ƒç”¨`handleStateChange`å‡½æ•°æ¥æ›´æ–°çˆ¶ç»„ä»¶çš„çŠ¶æ€ã€‚

è¿˜æ˜¯æŠ¥é”™ğŸ¤£ï¼Œaiæœç„¶ä¸èƒ½æ›¿ä»£äººç±»

`React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: <Fragment />. Did you accidentally export a JSX literal instead of a component?`

</details>

</details>

</details>

import { ForceC, ForceD } from "@components/react/p5/Forces";

#### wind ForceC(éåŠ¨æ€åŠ è½½ç»„ä»¶)

<details >
<summary>ForceC å›å½’å•ç‹¬åŠ è½½ç»„ä»¶</summary>

<ForceC client:load />

ä¸ºå•¥è¿™é‡Œç¬¬ä¸€æ¬¡å¼¹ä¸å›å»äº†ï¼Œä½†åé¢åˆå¼¹åˆ°äº†ç¬¬ä¸€æ¬¡å¼¹å›å»çš„æœ€å¤§é«˜åº¦

</details>

#### a lot of Mover that ForceD

<details >
<summary>ForceD</summary>

<ForceD client:load />

å¯ä»¥çœ‹åˆ°å°çƒæ¯”å¤§çƒâ€œå¿«â€å¤šäº†

</details>

#### exercise2.3

<details>
<summary>è¶Šé è¿‘è¾¹ç¼˜ï¼Œå—åˆ°çš„åæ–¹å‘çš„åŠ›è¶Šå¤§ï¼Œç›´åˆ°å°çƒæ‰å¤´</summary>

import { ForceE } from "@components/react/p5/Forces";

<ForceE client:visible />

çœŸæœ‰æ„æ€ çœŸæœ‰æ„æ€ å°±åƒæ˜¯æ‰åœ¨äº†æ°´é‡Œ

```tsx
let distanceX = p
  .createVector(p.width, moverWithWind.position.y)
  .dist(moverWithWind.position);
let distanceY = p
  .createVector(moverWithWind.position.x, p.height)
  .dist(moverWithWind.position);
if (
  distanceX < moverWithWind.circleRadius ||
  moverWithWind.position.x > p.width
) {
  moverWithWind.applyForce(p.createVector(-1, 0));
}
if (
  distanceY < moverWithWind.circleRadius ||
  moverWithWind.position.y > p.height
) {
  moverWithWind.applyForce(p.createVector(0, -1));
}
let distanceXL = p
  .createVector(0, moverWithWind.position.y)
  .dist(moverWithWind.position);
let distanceYL = p
  .createVector(moverWithWind.position.x, 0)
  .dist(moverWithWind.position);
if (distanceXL < moverWithWind.circleRadius || moverWithWind.position.x < 0) {
  moverWithWind.applyForce(p.createVector(1, 0));
}
if (distanceYL < moverWithWind.circleRadius || moverWithWind.position.y < 0) {
  moverWithWind.applyForce(p.createVector(0, 1));
}
```

ä¼˜åŒ–ä»£ç 

import ForceF from "@components/react/p5/Forces/ForceF";

<ForceF client:visible />

```tsx
const applyEdgeForce = (p, mover, position, radius, force) => {
  const distance = p.createVector(...position).dist(mover.position);
  if (
    distance < radius ||
    position[0] < 0 ||
    position[1] < 0 ||
    position[0] > p.width ||
    position[1] > p.height
  ) {
    mover.applyForce(force);
  }
};
applyEdgeForce(
  p,
  moverWithWind,
  [p.width, moverWithWind.position.y],
  moverWithWind.circleRadius,
  p.createVector(-1, 0)
);
applyEdgeForce(
  p,
  moverWithWind,
  [0, moverWithWind.position.y],
  moverWithWind.circleRadius,
  p.createVector(1, 0)
);
applyEdgeForce(
  p,
  moverWithWind,
  [moverWithWind.position.x, p.height],
  moverWithWind.circleRadius,
  p.createVector(0, -1)
);
applyEdgeForce(
  p,
  moverWithWind,
  [moverWithWind.position.x, 0],
  moverWithWind.circleRadius,
  p.createVector(0, 1)
);
```

import ForceG from "@components/react/p5/Forces/ForceG";

<ForceG client:visible />

</details>

### âš ï¸

- æˆ‘ä»–å–µå†™çš„ä»£ç å…¨æ˜¯bugï¼ŒæŒ‰é’®ä»€ä¹ˆçš„éƒ½è¦å°å¿ƒç‚¹ï¼Œæˆ‘ä»–å–µä¹Ÿä¸çŸ¥é“è¿™äº›æŒ‰é’®çš„é€»è¾‘ä¸ºå•¥ä¸å¯¹

### 3. Oscillation

### 4. Particle System

### 5. Autonomous Agents

### 6. Physical Libraries

### 7. Cellular Automata

### 8. Fractals

### 9. Evolutionary Computing

### 10. Neural Networks

### 11. Neuroevolution

## links

- https://natureofcode.com/
- https://p5js.org/
- https://processing.org/
- https://www.youtube.com/@TheCodingTrain
