---
author: ajn404
pubDatetime: 2024-09-04T05:44:43Z
title: 2024å¹´9æœˆ
postSlug: 2024-09
tags:
  - "2024"
  - "2024-09"
description: ä¸Šä¸ªæœˆä¸ç®—ï¼Œå…«æœˆå…¬å¸çš„æ´»æœ‰ç‚¹å¤šï¼Œè¿™ä¸ªæœˆé‡æ¥
---

import Driver from "@components/react/little/driver.tsx";
import Tag from "@components/astro/UI/Tag.astro";

## ç›®å½•

## 2024-09-04 14:06:14

<Tag name="ts" className="max-w-[100px]" />

[ts5.6 RC æ–°ç‰¹æ€§](https://devblogs.microsoft.com/typescript/announcing-typescript-5-6-rc/#disallowed-nullish-and-truthy-checks)

## 2024-09-18 10:32:06

<details open>
<summary>view transition api</summary>
**View Transition API** æ˜¯ä¸€ä¸ªæ–°å…´çš„ Web APIï¼Œç”¨äºåœ¨ Web åº”ç”¨ä¸­åˆ›å»ºæ— ç¼çš„é¡µé¢æˆ–ç»„ä»¶è¿‡æ¸¡åŠ¨ç”»ã€‚å®ƒé€šè¿‡æµè§ˆå™¨çº§åˆ«çš„æ¸²æŸ“æŠ€æœ¯ï¼Œç®€åŒ–äº†åœ¨å•é¡µåº”ç”¨ï¼ˆSPAï¼‰æˆ–å¤šé¡µåº”ç”¨ï¼ˆMPAï¼‰ä¸­å®ç°å¹³æ»‘è¿‡æ¸¡åŠ¨ç”»çš„è¿‡ç¨‹ï¼Œä½¿é¡µé¢å†…å®¹çš„å˜åŒ–æ›´æµç•…å’Œè‡ªç„¶ã€‚

### ä¸»è¦ç‰¹æ€§

- **æ— ç¼è¿‡æ¸¡**ï¼šå…è®¸åœ¨é¡µé¢åˆ‡æ¢ã€ç»„ä»¶çŠ¶æ€å˜åŒ–æ—¶ï¼Œæä¾›å¹³æ»‘çš„è§†è§‰è¿‡æ¸¡æ•ˆæœã€‚
- **å…ƒç´ çš„å…³è”**ï¼šå¯ä»¥æ ‡è®°é¡µé¢ä¸­å˜åŒ–çš„å…ƒç´ ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨è®¡ç®—å’ŒåŠ¨ç”»åŒ–å®ƒä»¬åœ¨ä¸¤ä¸ªçŠ¶æ€ä¹‹é—´çš„è¿‡æ¸¡ã€‚
- **ç®€åŒ–è¿‡æ¸¡åŠ¨ç”»çš„ç¼–å†™**ï¼šå¼€å‘è€…æ— éœ€æ‰‹åŠ¨ç®¡ç†å¤æ‚çš„åŠ¨ç”»é€»è¾‘ï¼Œåªéœ€è¦å£°æ˜å“ªäº›å…ƒç´ éœ€è¦è¿‡æ¸¡ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨è®¡ç®—å’Œåº”ç”¨åŠ¨ç”»ã€‚
- **é€‚ç”¨äºå¤šç§åœºæ™¯**ï¼šå¯ä»¥ç”¨äºå•é¡µåº”ç”¨ï¼ˆSPAï¼‰ä¸­çš„è·¯ç”±åˆ‡æ¢ï¼Œä¹Ÿå¯ä»¥ç”¨äºå¤šé¡µåº”ç”¨ï¼ˆMPAï¼‰ä¸­çš„é¡µé¢åˆ‡æ¢ã€‚

### å·¥ä½œåŸç†

View Transition API åˆ©ç”¨äº†æµè§ˆå™¨çš„æ¸²æŸ“æœºåˆ¶ï¼Œé€šè¿‡å¿«ç…§ï¼ˆsnapshotï¼‰é¡µé¢çš„å‰åçŠ¶æ€ï¼Œç„¶åè®¡ç®—å’Œåº”ç”¨è¿‡æ¸¡åŠ¨ç”»ï¼Œä½¿é¡µé¢åˆ‡æ¢æˆ–å…ƒç´ å˜åŒ–æ›´åŠ æµç•…ã€‚

### åŸºæœ¬ä½¿ç”¨æ–¹å¼

1. **å¯åŠ¨è¿‡æ¸¡**ï¼šåœ¨é¡µé¢çŠ¶æ€å˜åŒ–æ—¶ï¼Œå¯ä»¥é€šè¿‡ JavaScript è°ƒç”¨ `document.startViewTransition()` æ¥è§¦å‘è§†å›¾çš„è¿‡æ¸¡ã€‚
2. **æ ‡è®°è¿‡æ¸¡å…ƒç´ **ï¼šä½¿ç”¨ `view-transition-name` å±æ€§æ ‡è®°ä½ æƒ³è¦è¿‡æ¸¡çš„å…ƒç´ ï¼Œæµè§ˆå™¨å°†è·Ÿè¸ªè¿™äº›å…ƒç´ ï¼Œå¹¶åº”ç”¨è¿‡æ¸¡æ•ˆæœã€‚

### ç¤ºä¾‹

#### 1. å•é¡µåº”ç”¨ä¸­çš„è¿‡æ¸¡

```html
<style>
  .box {
    width: 100px;
    height: 100px;
    background-color: lightblue;
    margin: 20px;
    transition: all 0.5s ease;
  }

  .new-state {
    width: 200px;
    background-color: lightcoral;
  }
</style>

<div class="box" id="box" view-transition-name="box"></div>

<script>
  const box = document.getElementById("box");

  // å¯åŠ¨è§†å›¾è¿‡æ¸¡
  document.getElementById("box").addEventListener("click", () => {
    document.startViewTransition(() => {
      box.classList.toggle("new-state");
    });
  });
</script>
```

åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œ`startViewTransition()` è¢«ç”¨æ¥å¯åŠ¨è¿‡æ¸¡åŠ¨ç”»ï¼Œå½“ç‚¹å‡» `box` æ—¶ï¼Œå®ƒä¼šåœ¨ä¸¤ç§çŠ¶æ€ï¼ˆåŸå§‹çŠ¶æ€å’Œ `new-state`ï¼‰ä¹‹é—´è¿›è¡Œå¹³æ»‘çš„è¿‡æ¸¡ã€‚

#### 2. å¤šé¡µåº”ç”¨ä¸­çš„è¿‡æ¸¡

View Transition API è¿˜å¯ä»¥åœ¨é¡µé¢å¯¼èˆªæ—¶ç”¨äºå¤šé¡µåº”ç”¨ï¼Œç¡®ä¿é¡µé¢åˆ‡æ¢åŠ¨ç”»ä¹ŸåŒæ ·æµç•…ã€‚

```javascript
document.startViewTransition(() => {
  window.location.href = "/new-page";
});
```

å½“ä½ å¯¼èˆªåˆ°æ–°çš„é¡µé¢æ—¶ï¼Œ`startViewTransition` å°†ç¡®ä¿æ—§é¡µé¢ä¸æ–°é¡µé¢ä¹‹é—´çš„åˆ‡æ¢æ˜¯å¹³æ»‘çš„ï¼Œå¹¶ä¸”æµè§ˆå™¨ä¼šè‡ªåŠ¨ç”Ÿæˆè¿‡æ¸¡åŠ¨ç”»ã€‚

### ä¼˜ç‚¹

- **ç®€åŒ–åŠ¨ç”»å¼€å‘**ï¼šå¼€å‘è€…ä¸å†éœ€è¦æ‰‹åŠ¨å¤„ç†åŠ¨ç”»çš„å¤æ‚ç»†èŠ‚ï¼ŒView Transition API ä¼šè‡ªåŠ¨ç®¡ç†åŠ¨ç”»çš„å¼€å§‹å’Œç»“æŸã€‚
- **æé«˜æ€§èƒ½**ï¼šç”±äºåŠ¨ç”»ç”±æµè§ˆå™¨æœ¬åœ°å¤„ç†ï¼Œå› æ­¤èƒ½å¤Ÿè·å¾—æ›´é«˜çš„æ€§èƒ½å’Œæµç•…åº¦ã€‚
- **ç»Ÿä¸€è¿‡æ¸¡**ï¼šå¯ä»¥åœ¨é¡µé¢åˆ‡æ¢ã€å…ƒç´ å˜åŒ–ç­‰å¤šç§åœºæ™¯ä¸‹ç»Ÿä¸€å®ç°è¿‡æ¸¡åŠ¨ç”»æ•ˆæœã€‚

### æµè§ˆå™¨æ”¯æŒ

ç›®å‰ï¼ŒView Transition API å¤„äºå®éªŒæ€§é˜¶æ®µï¼Œæ”¯æŒåº¦æ­£åœ¨é€æ¸æå‡ã€‚ç°ä»£æµè§ˆå™¨å¦‚ Chrome 110+ å·²ç»å¼€å§‹æ”¯æŒè¯¥ APIï¼Œä¸è¿‡å…¶ä»–æµè§ˆå™¨å¦‚ Firefox å’Œ Safari å¯èƒ½ä»åœ¨å¼€å‘ä¸­ã€‚å¯ä»¥é€šè¿‡ `feature-detection` æ£€æŸ¥å½“å‰æµè§ˆå™¨æ˜¯å¦æ”¯æŒè¯¥åŠŸèƒ½ã€‚

### æ€»ç»“

View Transition API æ˜¯ Web åŠ¨ç”»å¼€å‘çš„ä¸€ä¸ªå¼ºå¤§å·¥å…·ï¼Œèƒ½å¤Ÿå¤§å¹…ç®€åŒ–é¡µé¢è¿‡æ¸¡æ•ˆæœçš„å®ç°ï¼Œå°¤å…¶é€‚ç”¨äºéœ€è¦åœ¨å‰åçŠ¶æ€é—´æä¾›å¹³æ»‘è¿‡æ¸¡çš„åœºæ™¯ã€‚å®ƒæå‡äº† Web åº”ç”¨çš„ç”¨æˆ·ä½“éªŒï¼Œè®©é¡µé¢åˆ‡æ¢ã€çŠ¶æ€å˜åŒ–æ›´åŠ æµç•…è‡ªç„¶ã€‚

</details>

## 2024-09-18 21:09:59

å†³å®šé‡æ–°å­¦ä¹ ts

## 2024-09-20 10:30:54

tokenğŸ§‘â€ğŸ«å¤±æ•ˆï¼Œå¾ˆçƒ¦

### add github api

- è·å–åŸºæœ¬ä¿¡æ¯

<details>
<summary>https://api.github.com/user</summary>

import Demo from "@components/astro/github/demo.astro";

<Demo />

</details>

- è·å–actionçŠ¶æ€

<details>
<summary>Click to expand</summary>

import Action from "@components/astro/github/action.astro";

<Action />{" "}

</details>

### æ–°å¢å­—ä½“ Whisper

ç­¾åå­—ä½“ <span class="font-whisper">Whisper</span>

<blockquote class="font-whisper text-2xl">
  From fairest creatures we desire increase,
  <br />
  That thereby beauty's rose might never die,
  <br />
  But as the riper should by time decease,
  <br />
  His tender heir might bear his memory:
  <br />
  But thou, contending with old age and death,
  <br />
  To hide thyself, diedst not leave me so.
  <br />
  Thy self thy foe, to thy sweet self too cruel,
  <br />
  Thou that art now the world's fresh ornament,
  <br />
  And only herald of the gaudy spring,
  <br />
  Wilt thou, upon the high and giddy mast,
  <br />
  Seal up thy lips, and drown the whole world in tears?
  <br />
  O, let me not be made a fool of thee,
  <br />
  To be so cruel, and yet so fair!
  <br />
</blockquote>

### show code

<details>
<summary>ä»Šå¤©å†™äº†ä¸€ä¸ªè¿˜æœ‰ç‚¹ä¸é”™çš„ä»£ç </summary>

```js
socket = new WebSocket(`ws://${host}/websocket/position/ajn404`);
let lastExecutionTime = 0; // ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´
let cache = [];
let processing = false;
const cacheMap = new Map();

socket.addEventListener("message", function (event) {
  const parsedData = JSON.parse(event.data);

  // å¤„ç†è­¦å‘Šé€šçŸ¥
  if (parsedData.method === "warning") {
    showNotification(parsedData);
    return;
  }

  const currentTime = Date.now(); // è·å–å½“å‰æ—¶é—´
  // å¦‚æœè·ç¦»ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´å°äº 100msï¼Œåˆ™ç»§ç»­ç¼“å­˜æ•°æ®
  if (currentTime - lastExecutionTime < 100) {
    cacheMap.set(parsedData.params.tagId, parsedData.params); // ç”¨ tagId ä½œä¸ºé”®ï¼Œå»é‡å­˜å‚¨æ•°æ®
    return;
  }
  lastExecutionTime = currentTime; // æ›´æ–°ä¸Šæ¬¡æ‰§è¡Œæ—¶é—´
  cacheMap.set(parsedData.params.tagId, parsedData.params); // ç”¨ tagId ä½œä¸ºé”®ï¼Œå»é‡å­˜å‚¨æ•°æ®

  // å¦‚æœæ­£åœ¨å¤„ç†ç¼“å­˜ä¸­çš„æ•°æ®ï¼Œåˆ™ä¸å†å¤„ç†
  if (processing) return;
  processing = true; // æ ‡è®°ä¸ºæ­£åœ¨å¤„ç†

  setTimeout(() => {
    // å°† Map è½¬æ¢ä¸ºæ•°ç»„ï¼Œå–å‡ºæ‰€æœ‰çš„ç¼“å­˜æ•°æ®
    cache = Array.from(cacheMap.values());

    // è¿‡æ»¤å¹¶è·å–è½¦è¾†å’Œäººå‘˜çš„æ›´æ–°æ•°æ®
    const updateData = getGraphicData(
      cache.filter(item => item.entityType === "car"),
      "car"
    );

    const updateDataMember = getGraphicData(
      cache.filter(item => item.entityType === "staff"),
      "member"
    );

    // æ›´æ–°è½¦è¾†ä½ç½®
    if (updateData && updateData.length > 0) {
      vehicleLocation.locationView.update(updateData);
    }

    // æ›´æ–°äººå‘˜ä½ç½®
    if (updateDataMember && updateDataMember.length > 0) {
      memberLocation.locationView.update(updateDataMember);
    }

    cacheMap.clear(); // æ¸…ç©º Map ä»¥ä¿è¯ç¼“å­˜ä¸é‡å¤

    if (!memberLocation.positionGroupGraphics) {
      cache = [...updateDataMember];
    }

    if (!vehicleLocation.positionGroupGraphics) {
      cache = [...cache, ...updateData];
    }

    // å¤„ç†å®Œæˆåæ¸…ç©ºç¼“å­˜å¹¶é‡ç½®æ ‡è®°

    processing = false;

    console.log(cache, updateDataMember, updateData);
  }, 0); // å¼‚æ­¥å¤„ç†ï¼Œä¿è¯ä¸ä¼šé˜»å¡æ¶ˆæ¯æ¥æ”¶
});
```

</details>

### Visual Viewport API

<details>
<summary>ä»€ä¹ˆæ˜¯Visual Viewport API</summary>

Visual Viewport API æ˜¯ä¸€ç§æœºåˆ¶ï¼Œå…è®¸å¼€å‘è€…æŸ¥è¯¢å’Œä¿®æ”¹çª—å£å¯è§†åŒºåŸŸçš„å±æ€§ã€‚ [1](https://developer.mozilla.org/en-US/docs/Web/API/Visual_Viewport_API) å¯è§†åŒºåŸŸæ˜¯æŒ‡å±å¹•ä¸Šé™¤å»å±å¹•é”®ç›˜ã€ç¼©æ”¾åŒºåŸŸå¤–ä»¥åŠå…¶ä»–ä¸éšé¡µé¢ç¼©æ”¾çš„å±å¹•å…ƒç´ åï¼Œå®é™…å¯è§çš„éƒ¨åˆ†ã€‚ [1](https://developer.mozilla.org/en-US/docs/Web/API/Visual_Viewport_API)

ç§»åŠ¨ç½‘é¡µåŒ…å«ä¸¤ä¸ªè§†å£ï¼šå¸ƒå±€è§†å£å’Œå¯è§†è§†å£ã€‚ [1](https://developer.mozilla.org/en-US/docs/Web/API/Visual_Viewport_API) å¸ƒå±€è§†å£æ¶µç›–é¡µé¢ä¸Šçš„æ‰€æœ‰å…ƒç´ ï¼Œè€Œå¯è§†è§†å£æ˜¯å±å¹•ä¸Šå®é™…å¯è§çš„éƒ¨åˆ†ã€‚ [1](https://developer.mozilla.org/en-US/docs/Web/API/Visual_Viewport_API)[6](https://github.com/WICG/visual-viewport) å½“ç”¨æˆ·æ”¾å¤§é¡µé¢æ—¶ï¼Œå¯è§†è§†å£ä¼šç¼©å°ï¼Œä½†å¸ƒå±€è§†å£ä¿æŒä¸å˜ã€‚ [1](https://developer.mozilla.org/en-US/docs/Web/API/Visual_Viewport_API) ç”¨æˆ·ç•Œé¢åŠŸèƒ½ï¼ˆå¦‚å±å¹•é”®ç›˜ï¼‰å¯ä»¥ç¼©å°å¯è§†è§†å£ï¼Œè€Œä¸ä¼šå½±å“å¸ƒå±€è§†å£ã€‚ [1](https://developer.mozilla.org/en-US/docs/Web/API/Visual_Viewport_API) Visual Viewport API å…è®¸å¼€å‘è€…ç›¸å¯¹äºå±å¹•ä¸Šæ˜¾ç¤ºçš„å†…å®¹å®šä½å…ƒç´ ï¼Œä»è€Œè§£å†³å¸ƒå±€è§†å£å’Œå¯è§†è§†å£ä¸ä¸€è‡´çš„é—®é¢˜ã€‚ [1](https://developer.mozilla.org/en-US/docs/Web/API/Visual_Viewport_API)

</details>

## 2024-09-23 14:15:19

### æ¯æ—¥è‹±è¯­

<div id="second">
  I <span id="use">use</span> <span id="nestjs">Nest.Js</span> at work but{" "}
  <span id="dislike">donâ€™t like it</span>, too much{" "}
  <span id="boilerplate">boilerplate</span>. I like{" "}
  <span id="express">express</span> more, very <span id="easy">easy</span> to
  use with <span id="ts">TS</span> too.
</div>

<Driver
  client:load
  elements='[
          {"element":"#use","popover":{"title":"use","description":"è¡¨ç¤ºåº”ç”¨æˆ–ä½¿ç”¨æŸç‰©ï¼Œé€šå¸¸æŒ‡å·¥ä½œæˆ–å¼€å‘ä¸­çš„å®è·µã€‚","side":"top","align":"start"}},
          {"element":"#nestjs","popover":{"title":"Nest.Js","description":"ä¸€ç§æ¸è¿›å¼çš„Node.jsæ¡†æ¶ï¼Œä¸“ä¸ºæ„å»ºå¯æ‰©å±•çš„æœåŠ¡å™¨ç«¯åº”ç”¨è€Œè®¾è®¡ï¼Œç»“åˆäº†é¢å‘å¯¹è±¡å’Œå‡½æ•°å¼ç¼–ç¨‹ã€‚","side":"top","align":"start"}},
          {"element":"#dislike","popover":{"title":"donâ€™t like it","description":"è¡¨è¾¾å¯¹æŸäº‹ç‰©çš„åæ„Ÿæˆ–ä¸æ»¡ã€‚æ­¤å¤„æŒ‡ä½œè€…ä¸å–œæ¬¢Nest.Jsã€‚","side":"top","align":"start"}},
          {"element":"#boilerplate","popover":{"title":"boilerplate","description":"æŒ‡é‡å¤çš„ã€å†—ä½™çš„ä»£ç ï¼Œé€šå¸¸æ˜¯å¼€å‘è€…è®¤ä¸ºä¸å¿…è¦æˆ–ç¹ççš„éƒ¨åˆ†ã€‚","side":"top","align":"start"}},
          {"element":"#express","popover":{"title":"express","description":"ä¸€ä¸ªç®€æ´ä¸”çµæ´»çš„Node.jsæ¡†æ¶ï¼Œç”¨äºæ„å»ºæœåŠ¡å™¨ç«¯åº”ç”¨ï¼Œå¼€å‘è€…å¸¸ç§°å…¶ä¸ºè½»é‡ã€å¿«é€Ÿã€‚","side":"top","align":"start"}},
          {"element":"#easy","popover":{"title":"easy","description":"è¡¨ç¤ºç®€å•ã€æ–¹ä¾¿ï¼Œæ­¤å¤„æŒ‡Express.jsæ¯”Nest.Jsæ›´åŠ å®¹æ˜“ä½¿ç”¨ã€‚","side":"top","align":"start"}},
          {"element":"#ts","popover":{"title":"TS","description":"TypeScriptçš„ç®€ç§°ï¼Œæ˜¯JavaScriptçš„è¶…é›†ï¼Œæ·»åŠ äº†é™æ€ç±»å‹æ”¯æŒã€‚","side":"top","align":"start"}}
        ]'
/>
