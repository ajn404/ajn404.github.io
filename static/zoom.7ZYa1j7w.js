import{S as L,g as nt,j as ot,k as it,T as ut,d as rt,l as U,m as j,s as I,o as C}from"./transform.Cz8yado1.js";import{i as st}from"./zoom.B6wIwFkC.js";import{p as D}from"./pointer.Kth1cJfI.js";import{d as at,y as ht}from"./nodrag.gN7VjRWd.js";(function(){try{var n=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},c=new n.Error().stack;c&&(n._sentryDebugIds=n._sentryDebugIds||{},n._sentryDebugIds[c]="ec3a427b-5e2c-45e1-ba93-0581c0050f39",n._sentryDebugIdIdentifier="sentry-dbid-ec3a427b-5e2c-45e1-ba93-0581c0050f39")}catch{}})();function bt(n){return typeof n=="string"?new L([document.querySelectorAll(n)],[document.documentElement]):new L([ot(n)],nt)}var ct=[null];function _t(n,c){var l=n.__transition,d,p;if(l){c=c==null?null:c+"";for(p in l)if((d=l[p]).state>it&&d.name===c)return new ut([[n]],ct,c,+p)}return null}const B=n=>()=>n;function lt(n,{sourceEvent:c,target:l,transform:d,dispatch:p}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:c,enumerable:!0,configurable:!0},target:{value:l,enumerable:!0,configurable:!0},transform:{value:d,enumerable:!0,configurable:!0},_:{value:p}})}function H(n){n.stopImmediatePropagation()}function S(n){n.preventDefault(),n.stopImmediatePropagation()}function ft(n){return(!n.ctrlKey||n.type==="wheel")&&!n.button}function mt(){var n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,n.hasAttribute("viewBox")?(n=n.viewBox.baseVal,[[n.x,n.y],[n.x+n.width,n.y+n.height]]):[[0,0],[n.width.baseVal.value,n.height.baseVal.value]]):[[0,0],[n.clientWidth,n.clientHeight]]}function O(){return this.__zoom||U}function gt(n){return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*(n.ctrlKey?10:1)}function pt(){return navigator.maxTouchPoints||"ontouchstart"in this}function dt(n,c,l){var d=n.invertX(c[0][0])-l[0][0],p=n.invertX(c[1][0])-l[1][0],y=n.invertY(c[0][1])-l[0][1],m=n.invertY(c[1][1])-l[1][1];return n.translate(p>d?(d+p)/2:Math.min(0,d)||Math.max(0,p),m>y?(y+m)/2:Math.min(0,y)||Math.max(0,m))}function Tt(){var n=ft,c=mt,l=dt,d=gt,p=pt,y=[0,1/0],m=[[-1/0,-1/0],[1/0,1/0]],V=250,P=st,x=rt("start","zoom","end"),M,X,E,W=500,$=150,q=0,A=10;function r(t){t.property("__zoom",O).on("wheel.zoom",J,{passive:!1}).on("mousedown.zoom",N).on("dblclick.zoom",Q).filter(p).on("touchstart.zoom",R).on("touchmove.zoom",tt).on("touchend.zoom touchcancel.zoom",et).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}r.transform=function(t,o,e,i){var u=t.selection?t.selection():t;u.property("__zoom",O),t!==u?Z(t,o,e,i):u.interrupt().each(function(){b(this,arguments).event(i).start().zoom(null,typeof o=="function"?o.apply(this,arguments):o).end()})},r.scaleBy=function(t,o,e,i){r.scaleTo(t,function(){var u=this.__zoom.k,s=typeof o=="function"?o.apply(this,arguments):o;return u*s},e,i)},r.scaleTo=function(t,o,e,i){r.transform(t,function(){var u=c.apply(this,arguments),s=this.__zoom,a=e==null?G(u):typeof e=="function"?e.apply(this,arguments):e,h=s.invert(a),f=typeof o=="function"?o.apply(this,arguments):o;return l(k(Y(s,f),a,h),u,m)},e,i)},r.translateBy=function(t,o,e,i){r.transform(t,function(){return l(this.__zoom.translate(typeof o=="function"?o.apply(this,arguments):o,typeof e=="function"?e.apply(this,arguments):e),c.apply(this,arguments),m)},null,i)},r.translateTo=function(t,o,e,i,u){r.transform(t,function(){var s=c.apply(this,arguments),a=this.__zoom,h=i==null?G(s):typeof i=="function"?i.apply(this,arguments):i;return l(U.translate(h[0],h[1]).scale(a.k).translate(typeof o=="function"?-o.apply(this,arguments):-o,typeof e=="function"?-e.apply(this,arguments):-e),s,m)},i,u)};function Y(t,o){return o=Math.max(y[0],Math.min(y[1],o)),o===t.k?t:new j(o,t.x,t.y)}function k(t,o,e){var i=o[0]-e[0]*t.k,u=o[1]-e[1]*t.k;return i===t.x&&u===t.y?t:new j(t.k,i,u)}function G(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function Z(t,o,e,i){t.on("start.zoom",function(){b(this,arguments).event(i).start()}).on("interrupt.zoom end.zoom",function(){b(this,arguments).event(i).end()}).tween("zoom",function(){var u=this,s=arguments,a=b(u,s).event(i),h=c.apply(u,s),f=e==null?G(h):typeof e=="function"?e.apply(u,s):e,w=Math.max(h[1][0]-h[0][0],h[1][1]-h[0][1]),g=u.__zoom,v=typeof o=="function"?o.apply(u,s):o,_=P(g.invert(f).concat(w/g.k),v.invert(f).concat(w/v.k));return function(z){if(z===1)z=v;else{var T=_(z),K=w/T[2];z=new j(K,f[0]-T[0]*K,f[1]-T[1]*K)}a.zoom(null,z)}})}function b(t,o,e){return!e&&t.__zooming||new F(t,o)}function F(t,o){this.that=t,this.args=o,this.active=0,this.sourceEvent=null,this.extent=c.apply(t,o),this.taps=0}F.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,o){return this.mouse&&t!=="mouse"&&(this.mouse[1]=o.invert(this.mouse[0])),this.touch0&&t!=="touch"&&(this.touch0[1]=o.invert(this.touch0[0])),this.touch1&&t!=="touch"&&(this.touch1[1]=o.invert(this.touch1[0])),this.that.__zoom=o,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var o=I(this.that).datum();x.call(t,this.that,new lt(t,{sourceEvent:this.sourceEvent,target:r,transform:this.that.__zoom,dispatch:x}),o)}};function J(t,...o){if(!n.apply(this,arguments))return;var e=b(this,o).event(t),i=this.__zoom,u=Math.max(y[0],Math.min(y[1],i.k*Math.pow(2,d.apply(this,arguments)))),s=D(t);if(e.wheel)(e.mouse[0][0]!==s[0]||e.mouse[0][1]!==s[1])&&(e.mouse[1]=i.invert(e.mouse[0]=s)),clearTimeout(e.wheel);else{if(i.k===u)return;e.mouse=[s,i.invert(s)],C(this),e.start()}S(t),e.wheel=setTimeout(a,$),e.zoom("mouse",l(k(Y(i,u),e.mouse[0],e.mouse[1]),e.extent,m));function a(){e.wheel=null,e.end()}}function N(t,...o){if(E||!n.apply(this,arguments))return;var e=t.currentTarget,i=b(this,o,!0).event(t),u=I(t.view).on("mousemove.zoom",f,!0).on("mouseup.zoom",w,!0),s=D(t,e),a=t.clientX,h=t.clientY;at(t.view),H(t),i.mouse=[s,this.__zoom.invert(s)],C(this),i.start();function f(g){if(S(g),!i.moved){var v=g.clientX-a,_=g.clientY-h;i.moved=v*v+_*_>q}i.event(g).zoom("mouse",l(k(i.that.__zoom,i.mouse[0]=D(g,e),i.mouse[1]),i.extent,m))}function w(g){u.on("mousemove.zoom mouseup.zoom",null),ht(g.view,i.moved),S(g),i.event(g).end()}}function Q(t,...o){if(n.apply(this,arguments)){var e=this.__zoom,i=D(t.changedTouches?t.changedTouches[0]:t,this),u=e.invert(i),s=e.k*(t.shiftKey?.5:2),a=l(k(Y(e,s),i,u),c.apply(this,o),m);S(t),V>0?I(this).transition().duration(V).call(Z,a,i,t):I(this).call(r.transform,a,i,t)}}function R(t,...o){if(n.apply(this,arguments)){var e=t.touches,i=e.length,u=b(this,o,t.changedTouches.length===i).event(t),s,a,h,f;for(H(t),a=0;a<i;++a)h=e[a],f=D(h,this),f=[f,this.__zoom.invert(f),h.identifier],u.touch0?!u.touch1&&u.touch0[2]!==f[2]&&(u.touch1=f,u.taps=0):(u.touch0=f,s=!0,u.taps=1+!!M);M&&(M=clearTimeout(M)),s&&(u.taps<2&&(X=f[0],M=setTimeout(function(){M=null},W)),C(this),u.start())}}function tt(t,...o){if(this.__zooming){var e=b(this,o).event(t),i=t.changedTouches,u=i.length,s,a,h,f;for(S(t),s=0;s<u;++s)a=i[s],h=D(a,this),e.touch0&&e.touch0[2]===a.identifier?e.touch0[0]=h:e.touch1&&e.touch1[2]===a.identifier&&(e.touch1[0]=h);if(a=e.that.__zoom,e.touch1){var w=e.touch0[0],g=e.touch0[1],v=e.touch1[0],_=e.touch1[1],z=(z=v[0]-w[0])*z+(z=v[1]-w[1])*z,T=(T=_[0]-g[0])*T+(T=_[1]-g[1])*T;a=Y(a,Math.sqrt(z/T)),h=[(w[0]+v[0])/2,(w[1]+v[1])/2],f=[(g[0]+_[0])/2,(g[1]+_[1])/2]}else if(e.touch0)h=e.touch0[0],f=e.touch0[1];else return;e.zoom("touch",l(k(a,h,f),e.extent,m))}}function et(t,...o){if(this.__zooming){var e=b(this,o).event(t),i=t.changedTouches,u=i.length,s,a;for(H(t),E&&clearTimeout(E),E=setTimeout(function(){E=null},W),s=0;s<u;++s)a=i[s],e.touch0&&e.touch0[2]===a.identifier?delete e.touch0:e.touch1&&e.touch1[2]===a.identifier&&delete e.touch1;if(e.touch1&&!e.touch0&&(e.touch0=e.touch1,delete e.touch1),e.touch0)e.touch0[1]=this.__zoom.invert(e.touch0[0]);else if(e.end(),e.taps===2&&(a=D(a,this),Math.hypot(X[0]-a[0],X[1]-a[1])<A)){var h=I(this).on("dblclick.zoom");h&&h.apply(this,arguments)}}}return r.wheelDelta=function(t){return arguments.length?(d=typeof t=="function"?t:B(+t),r):d},r.filter=function(t){return arguments.length?(n=typeof t=="function"?t:B(!!t),r):n},r.touchable=function(t){return arguments.length?(p=typeof t=="function"?t:B(!!t),r):p},r.extent=function(t){return arguments.length?(c=typeof t=="function"?t:B([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),r):c},r.scaleExtent=function(t){return arguments.length?(y[0]=+t[0],y[1]=+t[1],r):[y[0],y[1]]},r.translateExtent=function(t){return arguments.length?(m[0][0]=+t[0][0],m[1][0]=+t[1][0],m[0][1]=+t[0][1],m[1][1]=+t[1][1],r):[[m[0][0],m[0][1]],[m[1][0],m[1][1]]]},r.constrain=function(t){return arguments.length?(l=t,r):l},r.duration=function(t){return arguments.length?(V=+t,r):V},r.interpolate=function(t){return arguments.length?(P=t,r):P},r.on=function(){var t=x.on.apply(x,arguments);return t===x?r:t},r.clickDistance=function(t){return arguments.length?(q=(t=+t)*t,r):Math.sqrt(q)},r.tapDistance=function(t){return arguments.length?(A=+t,r):A},r}export{_t as d,bt as s,Tt as z};
//# sourceMappingURL=zoom.7ZYa1j7w.js.map
