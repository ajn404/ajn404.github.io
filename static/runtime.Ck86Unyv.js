import{f as Ot}from"./format.HwC_tL7Y.js";import{_ as J}from"./preload-helper.ddZQF9G8.js";import{r as It,g as kt}from"./reverse.CJyOsb0K.js";import{t as Lt,a as Pt,c as Mt,b as Rt,d as jt}from"./autoType.BOF6Cg8k.js";import"./_sentry-release-injection-file.B-UwqLso.js";(function(){try{var e=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},t=new e.Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="6e74077e-9950-4d80-8ec7-59dd28654119",e._sentryDebugIdIdentifier="sentry-dbid-6e74077e-9950-4d80-8ec7-59dd28654119")}catch{}})();function K(e,t,n){n=n||{};var r=e.ownerDocument,o=r.defaultView.CustomEvent;typeof o=="function"?o=new o(t,{detail:n}):(o=r.createEvent("Event"),o.initEvent(t,!1,!1),o.detail=n),e.dispatchEvent(o)}function et(e){return Array.isArray(e)||e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function tt(e){return e===(e|0)+""}function g(e){const t=document.createElement("span");return t.className="observablehq--cellname",t.textContent=`${e} = `,t}const Dt=Symbol.prototype.toString;function L(e){return Dt.call(e)}const{getOwnPropertySymbols:Ft,prototype:{hasOwnProperty:Bt}}=Object,{toStringTag:Ut}=Symbol,nt={},B=Ft;function ie(e,t){return Bt.call(e,t)}function pe(e){return e[Ut]||e.constructor&&e.constructor.name||"Object"}function _(e,t){try{const n=e[t];return n&&n.constructor,n}catch{return nt}}const Vt=[{symbol:"@@__IMMUTABLE_INDEXED__@@",name:"Indexed",modifier:!0},{symbol:"@@__IMMUTABLE_KEYED__@@",name:"Keyed",modifier:!0},{symbol:"@@__IMMUTABLE_LIST__@@",name:"List",arrayish:!0},{symbol:"@@__IMMUTABLE_MAP__@@",name:"Map"},{symbol:"@@__IMMUTABLE_ORDERED__@@",name:"Ordered",modifier:!0,prefix:!0},{symbol:"@@__IMMUTABLE_RECORD__@@",name:"Record"},{symbol:"@@__IMMUTABLE_SET__@@",name:"Set",arrayish:!0,setish:!0},{symbol:"@@__IMMUTABLE_STACK__@@",name:"Stack",arrayish:!0}];function rt(e){try{let t=Vt.filter(({symbol:i})=>e[i]===!0);if(!t.length)return;const n=t.find(i=>!i.modifier),r=n.name==="Map"&&t.find(i=>i.modifier&&i.prefix),o=t.some(i=>i.arrayish),s=t.some(i=>i.setish);return{name:`${r?r.name:""}${n.name}`,symbols:t,arrayish:o&&!s,setish:s}}catch{return null}}const{getPrototypeOf:ge,getOwnPropertyDescriptors:zt}=Object,it=ge({});function ot(e,t,n,r){let o=et(e),s,i,a,l;e instanceof Map?e instanceof e.constructor?(s=`Map(${e.size})`,i=Wt):(s="Map()",i=R):e instanceof Set?e instanceof e.constructor?(s=`Set(${e.size})`,i=Yt):(s="Set()",i=R):o?(s=`${e.constructor.name}(${e.length})`,i=Gt):(l=rt(e))?(s=`Immutable.${l.name}${l.name==="Record"?"":`(${e.size})`}`,o=l.arrayish,i=l.arrayish?Qt:l.setish?Ht:Kt):r?(s=pe(e),i=Jt):(s=pe(e),i=R);const c=document.createElement("span");c.className="observablehq--expanded",n&&c.appendChild(g(n));const u=c.appendChild(document.createElement("a"));u.innerHTML=`<svg width=8 height=8 class='observablehq--caret'>
    <path d='M4 7L0 1h8z' fill='currentColor' />
  </svg>`,u.appendChild(document.createTextNode(`${s}${o?" [":" {"}`)),u.addEventListener("mouseup",function(f){f.stopPropagation(),X(c,Ee(e,null,n,r))}),i=i(e);for(let f=0;!(a=i.next()).done&&f<20;++f)c.appendChild(a.value);if(!a.done){const f=c.appendChild(document.createElement("a"));f.className="observablehq--field",f.style.display="block",f.appendChild(document.createTextNode("  … more")),f.addEventListener("mouseup",function(p){p.stopPropagation(),c.insertBefore(a.value,c.lastChild.previousSibling);for(let d=0;!(a=i.next()).done&&d<19;++d)c.insertBefore(a.value,c.lastChild.previousSibling);a.done&&c.removeChild(c.lastChild.previousSibling),K(c,"load")})}return c.appendChild(document.createTextNode(o?"]":"}")),c}function*Wt(e){for(const[t,n]of e)yield Zt(t,n);yield*R(e)}function*Yt(e){for(const t of e)yield at(t);yield*R(e)}function*Ht(e){for(const t of e)yield at(t)}function*Gt(e){for(let t=0,n=e.length;t<n;++t)t in e&&(yield x(t,_(e,t),"observablehq--index"));for(const t in e)!tt(t)&&ie(e,t)&&(yield x(t,_(e,t),"observablehq--key"));for(const t of B(e))yield x(L(t),_(e,t),"observablehq--symbol")}function*Qt(e){let t=0;for(const n=e.size;t<n;++t)yield x(t,e.get(t),!0)}function*Jt(e){for(const n in zt(e))yield x(n,_(e,n),"observablehq--key");for(const n of B(e))yield x(L(n),_(e,n),"observablehq--symbol");const t=ge(e);t&&t!==it&&(yield st(t))}function*R(e){for(const n in e)ie(e,n)&&(yield x(n,_(e,n),"observablehq--key"));for(const n of B(e))yield x(L(n),_(e,n),"observablehq--symbol");const t=ge(e);t&&t!==it&&(yield st(t))}function*Kt(e){for(const[t,n]of e)yield x(t,n,"observablehq--key")}function st(e){const t=document.createElement("div"),n=t.appendChild(document.createElement("span"));return t.className="observablehq--field",n.className="observablehq--prototype-key",n.textContent="  <prototype>",t.appendChild(document.createTextNode(": ")),t.appendChild(y(e,void 0,void 0,void 0,!0)),t}function x(e,t,n){const r=document.createElement("div"),o=r.appendChild(document.createElement("span"));return r.className="observablehq--field",o.className=n,o.textContent=`  ${e}`,r.appendChild(document.createTextNode(": ")),r.appendChild(y(t)),r}function Zt(e,t){const n=document.createElement("div");return n.className="observablehq--field",n.appendChild(document.createTextNode("  ")),n.appendChild(y(e)),n.appendChild(document.createTextNode(" => ")),n.appendChild(y(t)),n}function at(e){const t=document.createElement("div");return t.className="observablehq--field",t.appendChild(document.createTextNode("  ")),t.appendChild(y(e)),t}function Ie(e){const t=window.getSelection();return t.type==="Range"&&(t.containsNode(e,!0)||e.contains(t.anchorNode)||e.contains(t.focusNode))}function Ee(e,t,n,r){let o=et(e),s,i,a,l;if(e instanceof Map?e instanceof e.constructor?(s=`Map(${e.size})`,i=Xt):(s="Map()",i=j):e instanceof Set?e instanceof e.constructor?(s=`Set(${e.size})`,i=en):(s="Set()",i=j):o?(s=`${e.constructor.name}(${e.length})`,i=rn):(l=rt(e))?(s=`Immutable.${l.name}${l.name==="Record"?"":`(${e.size})`}`,o=l.arrayish,i=l.arrayish?nn:l.setish?tn:on):(s=pe(e),i=j),t){const f=document.createElement("span");return f.className="observablehq--shallow",n&&f.appendChild(g(n)),f.appendChild(document.createTextNode(s)),f.addEventListener("mouseup",function(p){Ie(f)||(p.stopPropagation(),X(f,Ee(e)))}),f}const c=document.createElement("span");c.className="observablehq--collapsed",n&&c.appendChild(g(n));const u=c.appendChild(document.createElement("a"));u.innerHTML=`<svg width=8 height=8 class='observablehq--caret'>
    <path d='M7 4L1 8V0z' fill='currentColor' />
  </svg>`,u.appendChild(document.createTextNode(`${s}${o?" [":" {"}`)),c.addEventListener("mouseup",function(f){Ie(c)||(f.stopPropagation(),X(c,ot(e,null,n,r)))},!0),i=i(e);for(let f=0;!(a=i.next()).done&&f<20;++f)f>0&&c.appendChild(document.createTextNode(", ")),c.appendChild(a.value);return a.done||c.appendChild(document.createTextNode(", …")),c.appendChild(document.createTextNode(o?"]":"}")),c}function*Xt(e){for(const[t,n]of e)yield sn(t,n);yield*j(e)}function*en(e){for(const t of e)yield y(t,!0);yield*j(e)}function*tn(e){for(const t of e)yield y(t,!0)}function*nn(e){let t=-1,n=0;for(const r=e.size;n<r;++n)n>t+1&&(yield Z(n-t-1)),yield y(e.get(n),!0),t=n;n>t+1&&(yield Z(n-t-1))}function*rn(e){let t=-1,n=0;for(const r=e.length;n<r;++n)n in e&&(n>t+1&&(yield Z(n-t-1)),yield y(_(e,n),!0),t=n);n>t+1&&(yield Z(n-t-1));for(const r in e)!tt(r)&&ie(e,r)&&(yield D(r,_(e,r),"observablehq--key"));for(const r of B(e))yield D(L(r),_(e,r),"observablehq--symbol")}function*j(e){for(const t in e)ie(e,t)&&(yield D(t,_(e,t),"observablehq--key"));for(const t of B(e))yield D(L(t),_(e,t),"observablehq--symbol")}function*on(e){for(const[t,n]of e)yield D(t,n,"observablehq--key")}function Z(e){const t=document.createElement("span");return t.className="observablehq--empty",t.textContent=e===1?"empty":`empty × ${e}`,t}function D(e,t,n){const r=document.createDocumentFragment(),o=r.appendChild(document.createElement("span"));return o.className=n,o.textContent=e,r.appendChild(document.createTextNode(": ")),r.appendChild(y(t,!0)),r}function sn(e,t){const n=document.createDocumentFragment();return n.appendChild(y(e,!0)),n.appendChild(document.createTextNode(" => ")),n.appendChild(y(t,!0)),n}function an(e){return Ot(e,"Invalid Date")}var cn=Error.prototype.toString;function ln(e){return e.stack||cn.call(e)}var un=RegExp.prototype.toString;function fn(e){return un.call(e)}const ce=20;function dn(e,t,n,r){if(t===!1){if(Le(e,/["\n]/g)<=Le(e,/`|\${/g)){const c=document.createElement("span");r&&c.appendChild(g(r));const u=c.appendChild(document.createElement("span"));return u.className="observablehq--string",u.textContent=JSON.stringify(e),c}const i=e.split(`
`);if(i.length>ce&&!n){const c=document.createElement("div");r&&c.appendChild(g(r));const u=c.appendChild(document.createElement("span"));u.className="observablehq--string",u.textContent="`"+ke(i.slice(0,ce).join(`
`));const f=c.appendChild(document.createElement("span")),p=i.length-ce;return f.textContent=`Show ${p} truncated line${p>1?"s":""}`,f.className="observablehq--string-expand",f.addEventListener("mouseup",function(d){d.stopPropagation(),X(c,y(e,t,!0,r))}),c}const a=document.createElement("span");r&&a.appendChild(g(r));const l=a.appendChild(document.createElement("span"));return l.className=`observablehq--string${n?" observablehq--expanded":""}`,l.textContent="`"+ke(e)+"`",a}const o=document.createElement("span");r&&o.appendChild(g(r));const s=o.appendChild(document.createElement("span"));return s.className="observablehq--string",s.textContent=JSON.stringify(e.length>100?`${e.slice(0,50)}…${e.slice(-49)}`:e),o}function ke(e){return e.replace(/[\\`\x00-\x09\x0b-\x19]|\${/g,pn)}function pn(e){var t=e.charCodeAt(0);switch(t){case 8:return"\\b";case 9:return"\\t";case 11:return"\\v";case 12:return"\\f";case 13:return"\\r"}return t<16?"\\x0"+t.toString(16):t<32?"\\x"+t.toString(16):"\\"+e}function Le(e,t){for(var n=0;t.exec(e);)++n;return n}var mn=Function.prototype.toString,hn={prefix:"async ƒ"},bn={prefix:"async ƒ*"},Pe={prefix:"class"},wn={prefix:"ƒ"},yn={prefix:"ƒ*"};function _n(e,t){var n,r,o=mn.call(e);switch(e.constructor&&e.constructor.name){case"AsyncFunction":n=hn;break;case"AsyncGeneratorFunction":n=bn;break;case"GeneratorFunction":n=yn;break;default:n=/^class\b/.test(o)?Pe:wn;break}return n===Pe?P(n,"",t):(r=/^(?:async\s*)?(\w+)\s*=>/.exec(o))?P(n,"("+r[1]+")",t):(r=/^(?:async\s*)?\(\s*(\w+(?:\s*,\s*\w+)*)?\s*\)/.exec(o))?P(n,r[1]?"("+r[1].replace(/\s*,\s*/g,", ")+")":"()",t):(r=/^(?:async\s*)?function(?:\s*\*)?(?:\s*\w+)?\s*\(\s*(\w+(?:\s*,\s*\w+)*)?\s*\)/.exec(o))?P(n,r[1]?"("+r[1].replace(/\s*,\s*/g,", ")+")":"()",t):P(n,"(…)",t)}function P(e,t,n){var r=document.createElement("span");r.className="observablehq--function",n&&r.appendChild(g(n));var o=r.appendChild(document.createElement("span"));return o.className="observablehq--keyword",o.textContent=e.prefix,r.appendChild(document.createTextNode(t)),r}const{prototype:{toString:vn}}=Object;function y(e,t,n,r,o){let s=typeof e;switch(s){case"boolean":case"undefined":{e+="";break}case"number":{e=e===0&&1/e<0?"-0":e+"";break}case"bigint":{e=e+"n";break}case"symbol":{e=L(e);break}case"function":return _n(e,r);case"string":return dn(e,t,n,r);default:{if(e===null){s=null,e="null";break}if(e instanceof Date){s="date",e=an(e);break}if(e===nt){s="forbidden",e="[forbidden]";break}switch(vn.call(e)){case"[object RegExp]":{s="regexp",e=fn(e);break}case"[object Error]":case"[object DOMException]":{s="error",e=ln(e);break}default:return(n?ot:Ee)(e,t,r,o)}break}}const i=document.createElement("span");r&&i.appendChild(g(r));const a=i.appendChild(document.createElement("span"));return a.className=`observablehq--${s}`,a.textContent=e,i}function X(e,t){e.classList.contains("observablehq--inspect")&&t.classList.add("observablehq--inspect"),e.parentNode.replaceChild(t,e),K(t,"load")}const gn=/\s+\(\d+:\d+\)$/m;class Me{constructor(t){if(!t)throw new Error("invalid node");this._node=t,t.classList.add("observablehq")}pending(){const{_node:t}=this;t.classList.remove("observablehq--error"),t.classList.add("observablehq--running")}fulfilled(t,n){const{_node:r}=this;if((!En(t)||t.parentNode&&t.parentNode!==r)&&(t=y(t,!1,r.firstChild&&r.firstChild.classList&&r.firstChild.classList.contains("observablehq--expanded"),n),t.classList.add("observablehq--inspect")),r.classList.remove("observablehq--running","observablehq--error"),r.firstChild!==t)if(r.firstChild){for(;r.lastChild!==r.firstChild;)r.removeChild(r.lastChild);r.replaceChild(t,r.firstChild)}else r.appendChild(t);K(r,"update")}rejected(t,n){const{_node:r}=this;for(r.classList.remove("observablehq--running"),r.classList.add("observablehq--error");r.lastChild;)r.removeChild(r.lastChild);var o=document.createElement("div");o.className="observablehq--inspect",n&&o.appendChild(g(n)),o.appendChild(document.createTextNode((t+"").replace(gn,""))),r.appendChild(o),K(r,"error",{error:t})}}Me.into=function(e){if(typeof e=="string"&&(e=document.querySelector(e),e==null))throw new Error("container not found");return function(){return new Me(e.appendChild(document.createElement("div")))}};function En(e){return(e instanceof Element||e instanceof Text)&&e instanceof e.constructor}function b(e,t,n){return{resolve(r=n){return`${e}@${t}/${r}`}}}const xn=b("d3","7.9.0","dist/d3.min.js"),Tn=b("@observablehq/inputs","0.11.0","dist/inputs.min.js"),Cn=b("@observablehq/plot","0.6.16","dist/plot.umd.min.js"),An=b("@observablehq/graphviz","0.2.1","dist/graphviz.min.js"),le=b("@observablehq/highlight.js","2.0.0","highlight.min.js"),Re=b("@observablehq/katex","0.11.1","dist/katex.min.js"),Nn=b("lodash","4.17.21","lodash.min.js"),Sn=b("htl","0.3.1","dist/htl.min.js"),$n=b("jszip","3.10.1","dist/jszip.min.js"),qn=b("marked","0.3.12","marked.min.js"),je=b("sql.js","1.8.0","dist/sql-wasm.js"),On=b("vega","5.22.1","build/vega.min.js"),In=b("vega-lite","5.6.0","build/vega-lite.min.js"),kn=b("vega-lite-api","5.0.0","build/vega-lite-api.min.js"),me=b("apache-arrow","4.0.1","Arrow.es2015.min.js"),Ln=b("apache-arrow","9.0.0","+esm"),ct=b("apache-arrow","11.0.0","+esm"),Pn=b("arquero","4.8.8","dist/arquero.min.js"),Mn=b("topojson-client","3.1.0","dist/topojson-client.min.js"),Rn=b("exceljs","4.3.0","dist/exceljs.min.js"),jn=b("mermaid","9.2.2","dist/mermaid.min.js"),De=b("leaflet","1.9.3","dist/leaflet.js"),M=b("@duckdb/duckdb-wasm","1.24.0","+esm"),H=new Map,U=[],he=U.map,Dn=U.some,Fn=U.hasOwnProperty,Bn=/^((?:@[^/@]+\/)?[^/@]+)(?:@([^/]+))?(?:\/(.*))?$/,Un=/^\d+\.\d+\.\d+(-[\w-.+]+)?$/,Fe=/(?:\.[^/]*|\/)$/;class k extends Error{constructor(t){super(t)}}k.prototype.name=k.name;function Be(e){const t=Bn.exec(e);return t&&{name:t[1],version:t[2],path:t[3]}}function lt(e="https://cdn.jsdelivr.net/npm/",t=["unpkg","jsdelivr","browser","main"]){if(!/\/$/.test(e))throw new Error("origin lacks trailing slash");function n(o){for(const s of t){let i=o[s];if(typeof i=="string")return i.startsWith("./")&&(i=i.slice(2)),Fe.test(i)?i:`${i}.js`}}function r(o){const s=`${e}${o.name}${o.version?`@${o.version}`:""}/package.json`;let i=H.get(s);return i||H.set(s,i=fetch(s).then(a=>{if(!a.ok)throw new k("unable to load package.json");return a.redirected&&!H.has(a.url)&&H.set(a.url,i),a.json()})),i}return async function(s,i){if(s.startsWith(e)&&(s=s.substring(e.length)),/^(\w+:)|\/\//i.test(s))return s;if(/^[.]{0,2}\//i.test(s))return new URL(s,i??location).href;if(!s.length||/^[\s._]/.test(s)||/\s$/.test(s))throw new k("illegal name");const a=Be(s);if(!a)return`${e}${s}`;if(!a.version&&i!=null&&i.startsWith(e)){const c=await r(Be(i.substring(e.length)));a.version=c.dependencies&&c.dependencies[a.name]||c.peerDependencies&&c.peerDependencies[a.name]}if(a.path&&!Fe.test(a.path)&&(a.path+=".js"),a.path&&a.version&&Un.test(a.version))return`${e}${a.name}@${a.version}/${a.path}`;const l=await r(a);return`${e}${l.name}@${l.version}/${a.path||n(l)||"index.js"}`}}var Vn=oe(lt());function oe(e){const t=new Map,n=o(null);function r(a){if(typeof a!="string")return a;let l=t.get(a);return l||t.set(a,l=new Promise((c,u)=>{const f=document.createElement("script");f.onload=()=>{try{c(U.pop()(o(a)))}catch{u(new k("invalid module"))}f.remove()},f.onerror=()=>{u(new k("unable to load module")),f.remove()},f.async=!0,f.src=a,window.define=ut,document.head.appendChild(f)})),l}function o(a){return l=>Promise.resolve(e(l,a)).then(r)}function s(a){return oe((l,c)=>l in a&&(l=a[l],c=null,typeof l!="string")?l:e(l,c))}function i(a){return arguments.length>1?Promise.all(he.call(arguments,n)).then(zn):n(a)}return i.alias=s,i.resolve=e,i}function zn(e){const t={};for(const n of e)for(const r in n)Fn.call(n,r)&&(n[r]==null?Object.defineProperty(t,r,{get:Wn(n,r)}):t[r]=n[r]);return t}function Wn(e,t){return()=>e[t]}function Yn(e){return e=e+"",e==="exports"||e==="module"}function ut(e,t,n){const r=arguments.length;r<2?(n=e,t=[]):r<3&&(n=t,t=typeof e=="string"?[]:e),U.push(Dn.call(t,Yn)?o=>{const s={},i={exports:s};return Promise.all(he.call(t,a=>(a=a+"",a==="exports"?s:a==="module"?i:o(a)))).then(a=>(n.apply(null,a),i.exports))}:o=>Promise.all(he.call(t,o)).then(s=>typeof n=="function"?n.apply(null,s):n))}ut.amd={};const S="https://cdn.observableusercontent.com/npm/";let $=Vn;function Hn(e){$=e}function Gn(e){return e==null?$:oe(e)}async function ft(e){const[t,n]=await Promise.all([e(je.resolve()),e.resolve(je.resolve("dist/"))]);return t({locateFile:r=>`${n}${r}`})}class V{constructor(t){Object.defineProperties(this,{_db:{value:t}})}static async open(t){const[n,r]=await Promise.all([ft($),Promise.resolve(t).then(be)]);return new V(new n.Database(r))}async query(t,n){return await Jn(this._db,t,n)}async queryRow(t,n){return(await this.query(t,n))[0]||null}async explain(t,n){const r=await this.query(`EXPLAIN QUERY PLAN ${t}`,n);return N("pre",{className:"observablehq--inspect"},[ue(r.map(o=>o.detail).join(`
`))])}async describeTables({schema:t}={}){return this.query(`SELECT NULLIF(schema, 'main') AS schema, name FROM pragma_table_list() WHERE type = 'table'${t==null?"":" AND schema = ?"} AND name NOT LIKE 'sqlite_%' ORDER BY schema, name`,t==null?[]:[t])}async describeColumns({schema:t,table:n}={}){if(n==null)throw new Error("missing table");const r=await this.query(`SELECT name, type, "notnull" FROM pragma_table_info(?${t==null?"":", ?"}) ORDER BY cid`,t==null?[n]:[n,t]);if(!r.length)throw new Error(`table not found: ${n}`);return r.map(({name:o,type:s,notnull:i})=>({name:o,type:Qn(s),databaseType:s,nullable:!i}))}async describe(t){const n=await(t===void 0?this.query("SELECT name FROM sqlite_master WHERE type = 'table'"):this.query("SELECT * FROM pragma_table_info(?)",[t]));if(!n.length)throw new Error("Not found");const{columns:r}=n;return N("table",{value:n},[N("thead",[N("tr",r.map(o=>N("th",[ue(o)])))]),N("tbody",n.map(o=>N("tr",r.map(s=>N("td",[ue(o[s])])))))])}async sql(){return this.query(...this.queryTag.apply(this,arguments))}queryTag(t,...n){return[t.join("?"),n]}}Object.defineProperty(V.prototype,"dialect",{value:"sqlite"});function Qn(e){switch(e){case"NULL":return"null";case"INT":case"INTEGER":case"TINYINT":case"SMALLINT":case"MEDIUMINT":case"BIGINT":case"UNSIGNED BIG INT":case"INT2":case"INT8":return"integer";case"TEXT":case"CLOB":return"string";case"REAL":case"DOUBLE":case"DOUBLE PRECISION":case"FLOAT":case"NUMERIC":return"number";case"BLOB":return"buffer";case"DATE":case"DATETIME":return"string";default:return/^(?:(?:(?:VARYING|NATIVE) )?CHARACTER|(?:N|VAR|NVAR)CHAR)\(/.test(e)?"string":/^(?:DECIMAL|NUMERIC)\(/.test(e)?"number":"other"}}function be(e){return typeof e=="string"?fetch(e).then(be):e instanceof Response||e instanceof Blob?e.arrayBuffer().then(be):e instanceof ArrayBuffer?new Uint8Array(e):e}async function Jn(e,t,n){const[r]=await e.exec(t,n);if(!r)return[];const{columns:o,values:s}=r,i=s.map(a=>Object.fromEntries(a.map((l,c)=>[o[c],l])));return i.columns=o,i}function N(e,t,n){arguments.length===2&&(n=t,t=void 0);const r=document.createElement(e);if(t!==void 0)for(const o in t)r[o]=t[o];if(n!==void 0)for(const o of n)r.appendChild(o);return r}function ue(e){return document.createTextNode(e)}function xe(e){return e&&typeof e.toArrowBuffer=="function"}function ee(e){return e&&typeof e.getChild=="function"&&typeof e.toArray=="function"&&e.schema&&Array.isArray(e.schema.fields)}function Kn(e){return e.schema.fields.map(Zn)}function Zn(e){return{name:e.name,type:Xn(e.type),nullable:e.nullable,databaseType:String(e.type)}}function Xn(e){switch(e.typeId){case 2:return"integer";case 3:case 7:return"number";case 4:case 15:return"buffer";case 5:return"string";case 6:return"boolean";case 8:case 9:case 10:return"date";case 12:case 16:return"array";case 13:case 14:return"object";case 11:case 17:default:return"other"}}async function Te(){return await J(()=>import(`${S}${ct.resolve()}`),[])}let fe;class z{constructor(t){Object.defineProperties(this,{_db:{value:t}})}async queryStream(t,n){const r=await this._db.connect();let o,s;try{if(n?.length>0?o=await(await r.prepare(t)).send(...n):o=await r.send(t),s=await o.next(),s.done)throw new Error("missing first batch")}catch(i){throw await r.close(),i}return{schema:Kn(s.value),async*readRows(){try{for(;!s.done;)yield s.value.toArray(),s=await o.next()}finally{await r.close()}}}}async query(t,n){const r=await this.queryStream(t,n),o=[];for await(const s of r.readRows())for(const i of s)o.push(i);return o.schema=r.schema,o}async queryRow(t,n){const o=(await this.queryStream(t,n)).readRows();try{const{done:s,value:i}=await o.next();return s||!i.length?null:i[0]}finally{await o.return()}}async sql(t,...n){return await this.query(t.join("?"),n)}queryTag(t,...n){return[t.join("?"),n]}escape(t){return`"${t}"`}async describeTables(){return(await this.query("SHOW TABLES")).map(({name:n})=>({name:n}))}async describeColumns({table:t}={}){return(await this.query(`DESCRIBE ${this.escape(t)}`)).map(({column_name:r,column_type:o,null:s})=>({name:r,type:ir(o),nullable:s!=="NO",databaseType:o}))}static async of(t={},n={}){const r=await rr();return n.query?.castTimestampToDate===void 0&&(n={...n,query:{...n.query,castTimestampToDate:!0}}),n.query?.castBigIntToDouble===void 0&&(n={...n,query:{...n.query,castBigIntToDouble:!0}}),await r.open(n),await Promise.all(Object.entries(t).map(async([o,s])=>{if(s instanceof w)await Ue(r,o,s);else if(ee(s))await te(r,o,s);else if(Array.isArray(s))await Ve(r,o,s);else if(xe(s))await tr(r,o,s);else if("data"in s){const{data:i,...a}=s;ee(i)?await te(r,o,i,a):await Ve(r,o,i,a)}else if("file"in s){const{file:i,...a}=s;await Ue(r,o,i,a)}else throw new Error(`invalid source: ${s}`)})),new z(r)}}Object.defineProperty(z.prototype,"dialect",{value:"duckdb"});async function Ue(e,t,n,r){const o=await n.url();if(o.startsWith("blob:")){const i=await n.arrayBuffer();await e.registerFileBuffer(n.name,new Uint8Array(i))}else await e.registerFileURL(n.name,new URL(o,location).href,4);const s=await e.connect();try{switch(n.mimeType){case"text/csv":case"text/tab-separated-values":return await s.insertCSVFromPath(n.name,{name:t,schema:"main",...r}).catch(async i=>{if(i.toString().includes("Could not convert"))return await er(s,n,t);throw i});case"application/json":return await s.insertJSONFromPath(n.name,{name:t,schema:"main",...r});default:if(/\.arrow$/i.test(n.name)){const i=new Uint8Array(await n.arrayBuffer());return await s.insertArrowFromIPCStream(i,{name:t,schema:"main",...r})}if(/\.parquet$/i.test(n.name))return await s.query(`CREATE VIEW '${t}' AS SELECT * FROM parquet_scan('${n.name}')`);throw new Error(`unknown file type: ${n.mimeType}`)}}finally{await s.close()}}async function er(e,t,n){return await(await e.prepare(`CREATE TABLE '${n}' AS SELECT * FROM read_csv_auto(?, ALL_VARCHAR=TRUE)`)).send(t.name)}async function te(e,t,n,r){const o=await e.connect();try{await o.insertArrowTable(n,{name:t,schema:"main",...r})}finally{await o.close()}}async function tr(e,t,n){const o=(await Te()).tableFromIPC(n.toArrowBuffer());return await te(e,t,o)}async function Ve(e,t,n,r){const s=(await Te()).tableFromJSON(n);return await te(e,t,s,r)}async function nr(){const e=await J(()=>import(`${S}${M.resolve()}`),[]),t=await e.selectBundle({mvp:{mainModule:`${S}${M.resolve("dist/duckdb-mvp.wasm")}`,mainWorker:`${S}${M.resolve("dist/duckdb-browser-mvp.worker.js")}`},eh:{mainModule:`${S}${M.resolve("dist/duckdb-eh.wasm")}`,mainWorker:`${S}${M.resolve("dist/duckdb-browser-eh.worker.js")}`}}),n=new e.ConsoleLogger;return{module:e,bundle:t,logger:n}}async function rr(){fe===void 0&&(fe=nr());const{module:e,bundle:t,logger:n}=await fe,r=await e.createWorker(t.mainWorker),o=new e.AsyncDuckDB(n,r);return await o.instantiate(t.mainModule),o}function ir(e){switch(e){case"BIGINT":case"HUGEINT":case"UBIGINT":return"bigint";case"DOUBLE":case"REAL":case"FLOAT":return"number";case"INTEGER":case"SMALLINT":case"TINYINT":case"USMALLINT":case"UINTEGER":case"UTINYINT":return"integer";case"BOOLEAN":return"boolean";case"DATE":case"TIMESTAMP":case"TIMESTAMP WITH TIME ZONE":return"date";case"VARCHAR":case"UUID":return"string";default:return/^DECIMAL\(/.test(e)?"integer":"other"}}const Ce=20;function or(e,t){return e&&(typeof e.sql=="function"||typeof e.queryTag=="function"&&(typeof e.query=="function"||typeof e.queryStream=="function"))&&t!=="table"&&e!==yt}function se(e){return Array.isArray(e)&&(dt(e.schema)||pt(e.columns)||sr(e)||ht(e)||bt(e))||wt(e)}function sr(e){const t=Math.min(Ce,e.length);for(let n=0;n<t;++n){const r=e[n];if(r===null||typeof r!="object")return!1}return t>0&&ar(e[0])}function ar(e){for(const t in e)return!0;return!1}function dt(e){return Array.isArray(e)&&e.every(cr)}function pt(e){return Array.isArray(e)&&e.every(t=>typeof t=="string")}function cr(e){return e&&typeof e.name=="string"&&typeof e.type=="string"}function mt(e){return wt(e)||ht(e)||bt(e)}function ht(e){const t=Math.min(Ce,e.length);if(!(t>0))return!1;let n,r=!1;for(let o=0;o<t;++o){const s=e[o];if(s==null)continue;const i=typeof s;if(n===void 0)switch(i){case"number":case"boolean":case"string":case"bigint":n=i;break;default:return!1}else if(i!==n)return!1;r=!0}return r}function bt(e){const t=Math.min(Ce,e.length);if(!(t>0))return!1;let n=!1;for(let r=0;r<t;++r){const o=e[r];if(o!=null){if(!(o instanceof Date))return!1;n=!0}}return n}function wt(e){return e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}const yt=Object.assign(async(e,t,n,r)=>{if(e=await lr(await e,r),or(e))return ze(e,mr(t,e),n);if(se(e))return kr(e,t);throw e?new Error("invalid data source"):new Error("missing data source")},{sql(e,t,n){return async function(){return ze(await ur(await e,n),arguments,t)}}});function _t(e){const t=new WeakMap;return(n,r)=>{if(!n||typeof n!="object")throw new Error("invalid data source");let o=t.get(n);return(!o||se(n)&&n.length!==o._numRows)&&(o=e(n,r),o._numRows=n.length,t.set(n,o)),o}}const lr=_t(async(e,t)=>{if(e instanceof w){switch(e.mimeType){case"text/csv":return e.csv();case"text/tab-separated-values":return e.tsv();case"application/json":return e.json();case"application/x-sqlite3":return e.sqlite()}if(/\.(arrow|parquet)$/i.test(e.name))return I(e,t);throw new Error(`unsupported file type: ${e.mimeType}`)}return ee(e)||xe(e)?I(e,t):se(e)&&mt(e)?Array.from(e,n=>({value:n})):e}),ur=_t(async(e,t)=>{if(e instanceof w){switch(e.mimeType){case"text/csv":case"text/tab-separated-values":case"application/json":return I(e,t);case"application/x-sqlite3":return e.sqlite()}if(/\.(arrow|parquet)$/i.test(e.name))return I(e,t);throw new Error(`unsupported file type: ${e.mimeType}`)}return se(e)?I(await fr(e,t),t):ee(e)||xe(e)?I(e,t):e});async function fr(e,t){const n=await Te();return mt(e)?n.tableFromArrays({[t]:e}):n.tableFromJSON(e)}function I(e,t=e instanceof w?dr(e):"__table"){return z.of({[t]:e})}function dr(e){return e.name.replace(/@\d+(?=\.|$)/,"").replace(/\.\w+$/,"")}async function ze(e,t,n){if(!e)throw new Error("missing data source");if(typeof e.queryTag=="function"){const r=new AbortController,o={signal:r.signal};if(n.then(()=>r.abort("invalidated")),typeof e.queryStream=="function")return pr(e.queryStream(...e.queryTag.apply(e,t),o));if(typeof e.query=="function")return e.query(...e.queryTag.apply(e,t),o)}if(typeof e.sql=="function")return e.sql.apply(e,t);throw new Error("source does not implement query, queryStream, or sql")}async function*pr(e){let t=performance.now();const n=await e,r=[];r.done=!1,r.error=null,r.schema=n.schema;try{for await(const o of n.readRows()){performance.now()-t>150&&r.length>0&&(yield r,t=performance.now());for(const s of o)r.push(s)}r.done=!0,yield r}catch(o){r.error=o,yield r}}function mr(e,t){const n=typeof t.escape=="function"?t.escape:f=>f,{select:r,from:o,filter:s,sort:i,slice:a}=e;if(!o.table)throw new Error("missing from table");if(r.columns&&r.columns.length===0)throw new Error("at least one column must be selected");const l=new Map(e.names?.map(({column:f,name:p})=>[f,p])),u=[[`SELECT ${r.columns?r.columns.map(f=>{const p=l.get(f);return p?`${n(f)} AS ${n(p)}`:n(f)}).join(", "):"*"} FROM ${hr(o.table,n)}`]];for(let f=0;f<s.length;++f)h(f?`
AND `:`
WHERE `,u),br(s[f],u,n);for(let f=0;f<i.length;++f)h(f?", ":`
ORDER BY `,u),We(i[f],u,n);if(t.dialect==="mssql"||t.dialect==="oracle"){if(a.to!==null||a.from!==null){if(!i.length){if(!r.columns)throw new Error("at least one column must be explicitly specified. Received '*'.");h(`
ORDER BY `,u),We({column:r.columns[0],direction:"ASC"},u,n)}h(`
OFFSET ${a.from||0} ROWS`,u),h(`
FETCH NEXT ${a.to!==null?a.to-(a.from||0):1e9} ROWS ONLY`,u)}}else(a.to!==null||a.from!==null)&&h(`
LIMIT ${a.to!==null?a.to-(a.from||0):1e9}`,u),a.from!==null&&h(` OFFSET ${a.from}`,u);return u}function hr(e,t){if(typeof e=="object"){let n="";return e.database!=null&&(n+=t(e.database)+"."),e.schema!=null&&(n+=t(e.schema)+"."),n+=t(e.table),n}else return t(e)}function h(e,t){const n=t[0];n[n.length-1]+=e}function We({column:e,direction:t},n,r){h(`${r(e)} ${t.toUpperCase()}`,n)}function br({type:e,operands:t},n,r){if(t.length<1)throw new Error("Invalid operand length");if(t.length===1||e==="v"||e==="nv")switch(O(t[0],n,r),e){case"n":case"nv":h(" IS NULL",n);return;case"nn":case"v":h(" IS NOT NULL",n);return;default:throw new Error("Invalid filter operation")}if(t.length===2&&!["in","nin"].includes(e))if(["c","nc"].includes(e)){switch(O(t[0],n,r),e){case"c":h(" LIKE ",n);break;case"nc":h(" NOT LIKE ",n);break}O(yr(t[1]),n,r);return}else{switch(O(t[0],n,r),e){case"eq":h(" = ",n);break;case"ne":h(" <> ",n);break;case"gt":h(" > ",n);break;case"lt":h(" < ",n);break;case"gte":h(" >= ",n);break;case"lte":h(" <= ",n);break;default:throw new Error("Invalid filter operation")}O(t[1],n,r);return}switch(O(t[0],n,r),e){case"in":h(" IN (",n);break;case"nin":h(" NOT IN (",n);break;default:throw new Error("Invalid filter operation")}wr(t.slice(1),n),h(")",n)}function O(e,t,n){e.type==="column"?h(n(e.value),t):(t.push(e.value),t[0].push(""))}function wr(e,t){let n=!0;for(const r of e)n?n=!1:h(",",t),t.push(r.value),t[0].push("")}function yr(e){return{...e,value:`%${e.value}%`}}function vt(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))}function _r(e,t){return vt(e,t)||(e<t?-1:e>t?1:0)}function vr(e,t){return vt(e,t)||(e>t?-1:e<t?1:0)}const gr=e=>typeof e=="number"&&!Number.isNaN(e),Er=e=>Number.isInteger(e)&&!Number.isNaN(e),xr=e=>typeof e=="string",Tr=e=>typeof e=="boolean",Cr=e=>typeof e=="bigint",Ar=e=>e instanceof Date&&!isNaN(e),Nr=e=>e instanceof ArrayBuffer,Sr=e=>Array.isArray(e),$r=e=>typeof e=="object"&&e!==null,qr=e=>e!=null;function Ye(e){switch(e){case"string":return xr;case"bigint":return Cr;case"boolean":return Tr;case"number":return gr;case"integer":return Er;case"date":return Ar;case"buffer":return Nr;case"array":return Sr;case"object":return $r;case"other":default:return qr}}const gt=/^(([-+]\d{2})?\d{4}(-\d{2}(-\d{2}))|(\d{1,2})\/(\d{1,2})\/(\d{2,4}))([T ]\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/;function Or(e,t){switch(t){case"string":return typeof e=="string"||e==null?e:String(e);case"boolean":if(typeof e=="string"){const n=e.trim().toLowerCase();return n==="true"?!0:n==="false"?!1:null}return typeof e=="boolean"||e==null?e:!!e;case"bigint":return typeof e=="bigint"||e==null?e:Number.isInteger(typeof e=="string"&&!e.trim()?NaN:+e)?BigInt(e):void 0;case"integer":case"number":return typeof e=="number"?e:e==null||typeof e=="string"&&!e.trim()?NaN:Number(e);case"date":{if(e instanceof Date||e==null)return e;if(typeof e=="number")return new Date(e);const n=String(e).trim();return typeof e=="string"&&!n?null:new Date(gt.test(n)?n:NaN)}case"array":case"object":case"buffer":case"other":return e;default:throw new Error(`Unable to coerce to type: ${t}`)}}function Ir(e){const{columns:t}=e;let{schema:n}=e;return dt(n)?{schema:n,inferred:!1}:(n=Et(e,pt(t)?t:void 0),{schema:n,inferred:!0})}function He(e,t){const n=e;let{schema:r,inferred:o}=Ir(e);const s=new Map(r.map(({name:i,type:a})=>[i,a]));if(t.types){for(const{name:i,type:a}of t.types){s.set(i,a),r===n.schema&&(r=r.slice());const l=r.findIndex(c=>c.name===i);l>-1&&(r[l]={...r[l],type:a})}e=e.map(i=>we(i,s,r))}else o&&(e=e.map(i=>we(i,s,r)));return{source:e,schema:r}}function Ge(e,t){if(!t.names)return e;const n=new Map(t.names.map(r=>[r.column,r]));return e.map(r=>Object.fromEntries(Object.keys(r).map(o=>[n.get(o)?.name??o,r[o]])))}function kr(e,t){const n=new Map,r=e,o=He(e,t);e=o.source;let s=o.schema;if(t.derive){const c=[];t.derive.map(({name:f,value:p})=>{let d=[];Ge(e,t).map((m,v)=>{let Y;try{Y=p(m)}catch(qt){d.push({index:v,error:qt}),Y=void 0}c[v]?c[v]={...c[v],[f]:Y}:c.push({[f]:Y})}),d.length&&n.set(f,d)});const u=He(c,t);e=e.map((f,p)=>({...f,...u.source[p]})),s=[...s,...u.schema]}for(const{type:c,operands:u}of t.filter){const[{value:f}]=u,p=u.slice(1).map(({value:d})=>d);switch(c){case"v":{const[d]=p,m=Ye(d);e=e.filter(v=>m(v[f]));break}case"nv":{const[d]=p,m=Ye(d);e=e.filter(v=>!m(v[f]));break}case"eq":{const[d]=p;if(d instanceof Date){const m=+d;e=e.filter(v=>+v[f]===m)}else e=e.filter(m=>m[f]===d);break}case"ne":{const[d]=p;e=e.filter(m=>m[f]!==d);break}case"c":{const[d]=p;e=e.filter(m=>typeof m[f]=="string"&&m[f].includes(d));break}case"nc":{const[d]=p;e=e.filter(m=>typeof m[f]=="string"&&!m[f].includes(d));break}case"in":{const d=new Set(p);e=e.filter(m=>d.has(m[f]));break}case"nin":{const d=new Set(p);e=e.filter(m=>!d.has(m[f]));break}case"n":{e=e.filter(d=>d[f]==null);break}case"nn":{e=e.filter(d=>d[f]!=null);break}case"lt":{const[d]=p;e=e.filter(m=>m[f]<d);break}case"lte":{const[d]=p;e=e.filter(m=>m[f]<=d);break}case"gt":{const[d]=p;e=e.filter(m=>m[f]>d);break}case"gte":{const[d]=p;e=e.filter(m=>m[f]>=d);break}default:throw new Error(`unknown filter type: ${c}`)}}for(const{column:c,direction:u}of It(t.sort)){const f=u==="desc"?vr:_r;e===r&&(e=e.slice()),e.sort((p,d)=>f(p[c],d[c]))}let{from:i,to:a}=t.slice;i=i==null?0:Math.max(0,i),a=a==null?1/0:Math.max(0,a),(i>0||a<1/0)&&(e=e.slice(Math.max(0,i),Math.max(0,a)));let l=s.slice();if(t.select.columns){if(s){const c=new Map(s.map(u=>[u.name,u]));s=t.select.columns.map(u=>c.get(u))}e=e.map(c=>Object.fromEntries(t.select.columns.map(u=>[u,c[u]])))}if(t.names){const c=new Map(t.names.map(u=>[u.column,u]));s&&(s=s.map(u=>{const f=c.get(u.name);return{...u,...f?{name:f.name}:null}})),l&&(l=l.map(u=>{const f=c.get(u.name);return{...u,...f?{name:f.name}:null}})),e=Ge(e,t)}return e!==r&&s&&(e.schema=s),e.fullSchema=l,e.errors=n,e}function we(e,t,n){const r={};for(const o of n){const s=t.get(o.name),i=e[o.name];r[o.name]=s==="raw"?i:Or(i,s)}return r}function Lr(){return{boolean:0,integer:0,number:0,date:0,string:0,array:0,object:0,bigint:0,buffer:0,defined:0}}const Pr=["boolean","integer","number","date","bigint","array","object","buffer"];function Mr(e){const t=new Set;for(const n of e)if(n)for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.add(r);return Array.from(t)}function Et(e,t=Mr(e)){const n=[],o=e.slice(0,100);for(const s of t){const i=Lr();for(const c of o){let u=c[s];if(u==null)continue;const f=typeof u;if(f!=="string")++i.defined,Array.isArray(u)?++i.array:u instanceof Date?++i.date:u instanceof ArrayBuffer?++i.buffer:f==="number"?(++i.number,Number.isInteger(u)&&++i.integer):f in i&&++i[f];else{if(u=u.trim(),!u)continue;++i.defined,++i.string,/^(true|false)$/i.test(u)?++i.boolean:u&&!isNaN(u)?(++i.number,Number.isInteger(+u)&&++i.integer):gt.test(u)&&++i.date}}const a=Math.max(1,i.defined*.9),l=kt(Pr,c=>i[c]>=a?i[c]:NaN)??(i.string>=a?"string":"other");n.push({name:s,type:l,inferred:l})}return n}class Rr{constructor(t){Object.defineProperties(this,{_:{value:t},sheetNames:{value:t.worksheets.map(n=>n.name),enumerable:!0}})}sheet(t,n){const r=typeof t=="number"?this.sheetNames[t]:this.sheetNames.includes(t+="")?t:null;if(r==null)throw new Error(`Sheet not found: ${t}`);const o=this._.getWorksheet(r);return jr(o,n)}}function jr(e,{range:t,headers:n}={}){let[[r,o],[s,i]]=Dr(t,e);const a=n?e._rows[o++]:null;let l=new Set(["#"]);for(let u=r;u<=s;u++){const f=a?Qe(a.findCell(u+1)):null;let p=f&&f+""||Fr(u);for(;l.has(p);)p+="_";l.add(p)}l=new Array(r).concat(Array.from(l));const c=new Array(i-o+1);for(let u=o;u<=i;u++){const f=c[u-o]=Object.create(null,{"#":{value:u+1}}),p=e.getRow(u+1);if(p.hasValues)for(let d=r;d<=s;d++){const m=Qe(p.findCell(d+1));m!=null&&(f[l[d+1]]=m)}}return c.columns=l.filter(()=>!0),c}function Qe(e){if(!e)return;const{value:t}=e;if(t&&typeof t=="object"&&!(t instanceof Date)){if(t.formula||t.sharedFormula)return t.result&&t.result.error?NaN:t.result;if(t.richText)return Je(t);if(t.text){let{text:n}=t;return n.richText&&(n=Je(n)),t.hyperlink&&t.hyperlink!==n?`${t.hyperlink} ${n}`:n}return t}return t}function Je(e){return e.richText.map(t=>t.text).join("")}function Dr(e=":",{columnCount:t,rowCount:n}){if(e+="",!e.match(/^[A-Z]*\d*:[A-Z]*\d*$/))throw new Error("Malformed range specifier");const[[r=0,o=0],[s=t-1,i=n-1]]=e.split(":").map(Br);return[[r,o],[s,i]]}function Fr(e){let t="";e++;do t=String.fromCharCode(64+(e%26||26))+t;while(e=Math.floor((e-1)/26));return t}function Br(e){const[,t,n]=e.match(/^([A-Z]*)(\d*)$/);let r=0;if(t)for(let o=0;o<t.length;o++)r+=Math.pow(26,t.length-o-1)*(t.charCodeAt(o)-64);return[r?r-1:void 0,n?+n-1:void 0]}async function E(e){const t=await fetch(await e.url());if(!t.ok)throw new Error(`Unable to load file: ${e.name}`);return t}function Ur(e,t){const n=new Map(t.map(({name:r,type:o})=>[r,o]));return Object.assign(e.map(r=>we(r,n,t)),{schema:t})}async function Ke(e,t,{array:n=!1,typed:r=!1}={}){const o=await e.text(),s=t==="	"?n?Lt:Pt:n?Mt:Rt;if(r==="auto"&&!n){const i=s(o);return Ur(i,Et(i,i.columns))}return s(o,r&&jt)}class Ae{constructor(t,n){Object.defineProperty(this,"name",{value:t,enumerable:!0}),n!==void 0&&Object.defineProperty(this,"mimeType",{value:n+"",enumerable:!0})}async blob(){return(await E(this)).blob()}async arrayBuffer(){return(await E(this)).arrayBuffer()}async text(){return(await E(this)).text()}async json(){return(await E(this)).json()}async stream(){return(await E(this)).body}async csv(t){return Ke(this,",",t)}async tsv(t){return Ke(this,"	",t)}async image(t){const n=await this.url();return new Promise((r,o)=>{const s=new Image;new URL(n,document.baseURI).origin!==new URL(location).origin&&(s.crossOrigin="anonymous"),Object.assign(s,t),s.onload=()=>r(s),s.onerror=()=>o(new Error(`Unable to load file: ${this.name}`)),s.src=n})}async arrow({version:t=4}={}){switch(t){case 4:{const[n,r]=await Promise.all([$(me.resolve()),E(this)]);return n.Table.from(r)}case 9:{const[n,r]=await Promise.all([J(()=>import(`${S}${Ln.resolve()}`),[]),E(this)]);return n.tableFromIPC(r)}case 11:{const[n,r]=await Promise.all([J(()=>import(`${S}${ct.resolve()}`),[]),E(this)]);return n.tableFromIPC(r)}default:throw new Error(`unsupported arrow version: ${t}`)}}async sqlite(){return V.open(E(this))}async zip(){const[t,n]=await Promise.all([$($n.resolve()),this.arrayBuffer()]);return new Wr(await t.loadAsync(n))}async xml(t="application/xml"){return new DOMParser().parseFromString(await this.text(),t)}async html(){return this.xml("text/html")}async xlsx(){const[t,n]=await Promise.all([$(Rn.resolve()),this.arrayBuffer()]);return new Rr(await new t.Workbook().xlsx.load(n))}}class w extends Ae{constructor(t,n,r){super(n,r),Object.defineProperty(this,"_url",{value:t})}async url(){return await this._url+""}}function Vr(e){throw new Error(`File not found: ${e}`)}function zr(e){return Object.assign(t=>{const n=e(t+="");if(n==null)throw new Error(`File not found: ${t}`);if(typeof n=="object"&&"url"in n){const{url:r,mimeType:o}=n;return new w(r,t,o)}return new w(n,t)},{prototype:w.prototype})}class Wr{constructor(t){Object.defineProperty(this,"_",{value:t}),this.filenames=Object.keys(t.files).filter(n=>!t.files[n].dir)}file(t){const n=this._.file(t+="");if(!n||n.dir)throw new Error(`file not found: ${t}`);return new Yr(n)}}class Yr extends Ae{constructor(t){super(t.name),Object.defineProperty(this,"_",{value:t}),Object.defineProperty(this,"_url",{writable:!0})}async url(){return this._url||(this._url=this.blob().then(URL.createObjectURL))}async blob(){return this._.async("blob")}async arrayBuffer(){return this._.async("arraybuffer")}async text(){return this._.async("text")}async json(){return JSON.parse(await this.text())}}function Hr(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n}function Gr(e,t,n){n==null&&(n=devicePixelRatio);var r=document.createElement("canvas");r.width=e*n,r.height=t*n,r.style.width=e+"px";var o=r.getContext("2d");return o.scale(n,n),o}function Qr(e,t="untitled",n="Save"){const r=document.createElement("a"),o=r.appendChild(document.createElement("button"));o.textContent=n,r.download=t;async function s(){await new Promise(requestAnimationFrame),URL.revokeObjectURL(r.href),r.removeAttribute("href"),o.textContent=n,o.disabled=!1}return r.onclick=async i=>{if(o.disabled=!0,r.href)return s();o.textContent="Saving…";try{const a=await(typeof e=="function"?e():e);o.textContent="Download",r.href=URL.createObjectURL(a)}catch{o.textContent=n}if(i.eventPhase)return s();o.disabled=!1},r}var G={math:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Jr(e,t){var n=e+="",r=n.indexOf(":"),o;r>=0&&(n=e.slice(0,r))!=="xmlns"&&(e=e.slice(r+1));var s=G.hasOwnProperty(n)?document.createElementNS(G[n],e):document.createElement(e);if(t)for(var i in t)n=i,r=n.indexOf(":"),o=t[i],r>=0&&(n=i.slice(0,r))!=="xmlns"&&(i=i.slice(r+1)),G.hasOwnProperty(n)?s.setAttributeNS(G[n],i,o):s.setAttribute(i,o);return s}function Kr(e){var t=document.createElement("input");return e!=null&&(t.type=e),t}function Zr(e,t,n){arguments.length===1&&(t=e,e=null);var r=document.createElement("input");return r.min=e=e==null?0:+e,r.max=t=t==null?1:+t,r.step=n==null?"any":n=+n,r.type="range",r}function Xr(e){var t=document.createElement("select");return Array.prototype.forEach.call(e,function(n){var r=document.createElement("option");r.value=r.textContent=n,t.appendChild(r)}),t}function ei(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("viewBox",[0,0,e,t]),n.setAttribute("width",e),n.setAttribute("height",t),n}function ti(e){return document.createTextNode(e)}var ni=0;function xt(e){return new Tt("O-"+(e==null?"":e+"-")+ ++ni)}function Tt(e){this.id=e,this.href=new URL(`#${e}`,location)+""}Tt.prototype.toString=function(){return"url("+this.href+")"};const ri=Object.freeze(Object.defineProperty({__proto__:null,canvas:Hr,context2d:Gr,download:Qr,element:Jr,input:Kr,range:Zr,select:Xr,svg:ei,text:ti,uid:xt},Symbol.toStringTag,{value:"Module"}));function ii(e){return new Promise(function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsArrayBuffer(e)})}function oi(e){return new Promise(function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsText(e)})}function si(e){return new Promise(function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsDataURL(e)})}const ai=Object.freeze(Object.defineProperty({__proto__:null,buffer:ii,text:oi,url:si},Symbol.toStringTag,{value:"Module"}));function Ne(){return this}function Ct(e,t){let n=!1;if(typeof t!="function")throw new Error("dispose is not a function");return{[Symbol.iterator]:Ne,next:()=>n?{done:!0}:(n=!0,{done:!1,value:e}),return:()=>(n=!0,t(e),{done:!0}),throw:()=>({done:n=!0})}}function*ci(e,t){for(var n,r=-1;!(n=e.next()).done;)t(n.value,++r)&&(yield n.value)}function ae(e){let t=!1,n,r;const o=e(s);if(o!=null&&typeof o!="function")throw new Error(typeof o.then=="function"?"async initializers are not supported":"initializer returned something, but not a dispose function");function s(a){return r?(r(a),r=null):t=!0,n=a}function i(){return{done:!1,value:t?(t=!1,Promise.resolve(n)):new Promise(a=>r=a)}}return{[Symbol.iterator]:Ne,throw:()=>({done:!0}),return:()=>(o?.(),{done:!0}),next:i}}function li(e){return ae(function(t){var n=ui(e),r=Ze(e);function o(){t(Ze(e))}return e.addEventListener(n,o),r!==void 0&&t(r),function(){e.removeEventListener(n,o)}})}function Ze(e){switch(e.type){case"range":case"number":return e.valueAsNumber;case"date":return e.valueAsDate;case"checkbox":return e.checked;case"file":return e.multiple?e.files:e.files[0];case"select-multiple":return Array.from(e.selectedOptions,t=>t.value);default:return e.value}}function ui(e){switch(e.type){case"button":case"submit":case"checkbox":return"click";case"file":return"change";default:return"input"}}function*fi(e,t){for(var n,r=-1;!(n=e.next()).done;)yield t(n.value,++r)}function di(e){let t;const n=[],r=e(o);if(r!=null&&typeof r!="function")throw new Error(typeof r.then=="function"?"async initializers are not supported":"initializer returned something, but not a dispose function");function o(i){return n.push(i),t&&(t(n.shift()),t=null),i}function s(){return{done:!1,value:n.length?Promise.resolve(n.shift()):new Promise(i=>t=i)}}return{[Symbol.iterator]:Ne,throw:()=>({done:!0}),return:()=>(r?.(),{done:!0}),next:s}}function*pi(e,t,n){e=+e,t=+t,n=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+n;for(var r=-1,o=Math.max(0,Math.ceil((t-e)/n))|0;++r<o;)yield e+r*n}function mi(e,t){if(!(!isFinite(t=+t)||t<0||t!==t|0)){for(var n,r=-1;!(n=e.next()).done;)if(++r===t)return n.value}}function hi(e){const t=URL.createObjectURL(new Blob([e],{type:"text/javascript"})),n=new Worker(t);return Ct(n,()=>{n.terminate(),URL.revokeObjectURL(t)})}const bi=Object.freeze(Object.defineProperty({__proto__:null,disposable:Ct,filter:ci,input:li,map:fi,observe:ae,queue:di,range:pi,valueAt:mi,worker:hi},Symbol.toStringTag,{value:"Module"}));function Se(e,t){return function(n){var r=n[0],o=[],s,i=null,a,l,c,u,f,p,d,m=-1;for(u=1,f=arguments.length;u<f;++u){if(s=arguments[u],s instanceof Node)o[++m]=s,r+="<!--o:"+m+"-->";else if(Array.isArray(s)){for(p=0,d=s.length;p<d;++p)a=s[p],a instanceof Node?(i===null&&(o[++m]=i=document.createDocumentFragment(),r+="<!--o:"+m+"-->"),i.appendChild(a)):(i=null,r+=a);i=null}else r+=s;r+=n[u]}if(i=e(r),++m>0){for(l=new Array(m),c=document.createTreeWalker(i,NodeFilter.SHOW_COMMENT,null,!1);c.nextNode();)a=c.currentNode,/^o:/.test(a.nodeValue)&&(l[+a.nodeValue.slice(2)]=a);for(u=0;u<m;++u)(a=l[u])&&a.parentNode.replaceChild(o[u],a)}return i.childNodes.length===1?i.removeChild(i.firstChild):i.nodeType===11?((a=t()).appendChild(i),a):i}}const wi=Se(function(e){var t=document.createElement("template");return t.innerHTML=e.trim(),document.importNode(t.content,!0)},function(){return document.createElement("span")});async function yi(e){const t=await e(De.resolve());if(!t._style){const n=document.createElement("link");n.rel="stylesheet",n.href=await e.resolve(De.resolve("dist/leaflet.css")),t._style=document.head.appendChild(n)}return t}function _i(e){return e(qn.resolve()).then(function(t){return Se(function(n){var r=document.createElement("div");r.innerHTML=t(n,{langPrefix:""}).trim();var o=r.querySelectorAll("pre code[class]");return o.length>0&&e(le.resolve()).then(function(s){o.forEach(function(i){function a(){s.highlightBlock(i),i.parentNode.classList.add("observablehq--md-pre")}s.getLanguage(i.className)?a():e(le.resolve("async-languages/index.js")).then(l=>{if(l.has(i.className))return e(le.resolve("async-languages/"+l.get(i.className))).then(c=>{s.registerLanguage(i.className,c)})}).then(a,a)})}),r},function(){return document.createElement("div")})})}async function vi(e){const t=await e(jn.resolve());return t.initialize({securityLevel:"loose",theme:"neutral"}),function(){const r=document.createElement("div");return r.innerHTML=t.render(xt().id,String.raw.apply(String,arguments)),r.removeChild(r.firstChild)}}function gi(e){let t;Object.defineProperties(this,{generator:{value:ae(n=>void(t=n))},value:{get:()=>e,set:n=>t(e=n)}}),e!==void 0&&t(e)}function*Ei(){for(;;)yield Date.now()}function xi(e,t){return new Promise(function(n){setTimeout(function(){n(t)},e)})}var ye=new Map;function Ti(e,t){var n=new Promise(function(r){ye.delete(t);var o=t-e;if(!(o>0))throw new Error("invalid time");if(o>2147483647)throw new Error("too long to wait");setTimeout(r,o)});return ye.set(t,n),n}function At(e,t){var n;return(n=ye.get(e=+e))?n.then(()=>t):(n=Date.now())>=e?Promise.resolve(t):Ti(n,e).then(()=>t)}function Ci(e,t){return At(Math.ceil((Date.now()+1)/e)*e,t)}const Ai=Object.freeze(Object.defineProperty({__proto__:null,delay:xi,tick:Ci,when:At},Symbol.toStringTag,{value:"Module"}));function Ni(e,t){if(/^(\w+:)|\/\//i.test(e))return e;if(/^[.]{0,2}\//i.test(e))return new URL(e,t??location).href;if(!e.length||/^[\s._]/.test(e)||/\s$/.test(e))throw new Error("illegal name");return"https://unpkg.com/"+e}const Si=Se(function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.innerHTML=e.trim(),t},function(){return document.createElementNS("http://www.w3.org/2000/svg","g")});var $i=String.raw;function qi(e){return new Promise(function(t,n){var r=document.createElement("link");r.rel="stylesheet",r.href=e,r.onerror=n,r.onload=t,document.head.appendChild(r)})}function Oi(e){return Promise.all([e(Re.resolve()),e.resolve(Re.resolve("dist/katex.min.css")).then(qi)]).then(function(t){var n=t[0],r=o();function o(s){return function(){var i=document.createElement("div");return n.render($i.apply(String,arguments),i,s),i.removeChild(i.firstChild)}}return r.options=o,r.block=o({displayMode:!0}),r})}async function Ii(e){const[t,n,r]=await Promise.all([On,In,kn].map(o=>e(o.resolve())));return r.register(t,n)}function ki(){return ae(function(e){var t=e(document.body.clientWidth);function n(){var r=document.body.clientWidth;r!==t&&e(t=r)}return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}})}const Li=Object.assign(Object.defineProperties(function(t){const n=Gn(t);Object.defineProperties(this,Pi({FileAttachment:()=>Vr,Mutable:()=>gi,now:Ei,width:ki,dot:()=>n(An.resolve()),htl:()=>n(Sn.resolve()),html:()=>wi,md:()=>_i(n),svg:()=>Si,tex:()=>Oi(n),_:()=>n(Nn.resolve()),aq:()=>n.alias({"apache-arrow":me.resolve()})(Pn.resolve()),Arrow:()=>n(me.resolve()),d3:()=>n(xn.resolve()),DuckDBClient:()=>z,Inputs:()=>n(Tn.resolve()).then(r=>({...r,file:r.fileOf(Ae)})),L:()=>yi(n),mermaid:()=>vi(n),Plot:()=>n(Cn.resolve()),__query:()=>yt,require:()=>n,resolve:()=>Ni,SQLite:()=>ft(n),SQLiteDatabaseClient:()=>V,topojson:()=>n(Mn.resolve()),vl:()=>Ii(n),aapl:()=>new w("https://static.observableusercontent.com/files/3ccff97fd2d93da734e76829b2b066eafdaac6a1fafdec0faf6ebc443271cfc109d29e80dd217468fcb2aff1e6bffdc73f356cc48feb657f35378e6abbbb63b9").csv({typed:!0}),alphabet:()=>new w("https://static.observableusercontent.com/files/75d52e6c3130b1cae83cda89305e17b50f33e7420ef205587a135e8562bcfd22e483cf4fa2fb5df6dff66f9c5d19740be1cfaf47406286e2eb6574b49ffc685d").csv({typed:!0}),cars:()=>new w("https://static.observableusercontent.com/files/048ec3dfd528110c0665dfa363dd28bc516ffb7247231f3ab25005036717f5c4c232a5efc7bb74bc03037155cb72b1abe85a33d86eb9f1a336196030443be4f6").csv({typed:!0}),citywages:()=>new w("https://static.observableusercontent.com/files/39837ec5121fcc163131dbc2fe8c1a2e0b3423a5d1e96b5ce371e2ac2e20a290d78b71a4fb08b9fa6a0107776e17fb78af313b8ea70f4cc6648fad68ddf06f7a").csv({typed:!0}),diamonds:()=>new w("https://static.observableusercontent.com/files/87942b1f5d061a21fa4bb8f2162db44e3ef0f7391301f867ab5ba718b225a63091af20675f0bfe7f922db097b217b377135203a7eab34651e21a8d09f4e37252").csv({typed:!0}),flare:()=>new w("https://static.observableusercontent.com/files/a6b0d94a7f5828fd133765a934f4c9746d2010e2f342d335923991f31b14120de96b5cb4f160d509d8dc627f0107d7f5b5070d2516f01e4c862b5b4867533000").csv({typed:!0}),industries:()=>new w("https://static.observableusercontent.com/files/76f13741128340cc88798c0a0b7fa5a2df8370f57554000774ab8ee9ae785ffa2903010cad670d4939af3e9c17e5e18e7e05ed2b38b848ac2fc1a0066aa0005f").csv({typed:!0}),miserables:()=>new w("https://static.observableusercontent.com/files/31d904f6e21d42d4963ece9c8cc4fbd75efcbdc404bf511bc79906f0a1be68b5a01e935f65123670ed04e35ca8cae3c2b943f82bf8db49c5a67c85cbb58db052").json(),olympians:()=>new w("https://static.observableusercontent.com/files/31ca24545a0603dce099d10ee89ee5ae72d29fa55e8fc7c9ffb5ded87ac83060d80f1d9e21f4ae8eb04c1e8940b7287d179fe8060d887fb1f055f430e210007c").csv({typed:!0}),penguins:()=>new w("https://static.observableusercontent.com/files/715db1223e067f00500780077febc6cebbdd90c151d3d78317c802732252052ab0e367039872ab9c77d6ef99e5f55a0724b35ddc898a1c99cb14c31a379af80a").csv({typed:!0}),pizza:()=>new w("https://static.observableusercontent.com/files/c653108ab176088cacbb338eaf2344c4f5781681702bd6afb55697a3f91b511c6686ff469f3e3a27c75400001a2334dbd39a4499fe46b50a8b3c278b7d2f7fb5").csv({typed:!0}),weather:()=>new w("https://static.observableusercontent.com/files/693a46b22b33db0f042728700e0c73e836fa13d55446df89120682d55339c6db7cc9e574d3d73f24ecc9bc7eb9ac9a1e7e104a1ee52c00aab1e77eb102913c1f").csv({typed:!0}),DOM:ri,Files:ai,Generators:bi,Promises:Ai}))},{resolve:{get:()=>$.resolve,enumerable:!0,configurable:!0},require:{get:()=>$,set:Hn,enumerable:!0,configurable:!0}}),{resolveFrom:lt,requireFrom:oe});function Pi(e){return Object.fromEntries(Object.entries(e).map(Mi))}function Mi([e,t]){return[e,{value:t,writable:!0,enumerable:!0}]}class T extends Error{constructor(t,n){super(t),this.input=n}}T.prototype.name="RuntimeError";function Ri(e){return e&&typeof e.next=="function"&&typeof e.return=="function"}function _e(e){return()=>e}function ne(e){return e}function ji(e){return()=>{throw e}}const Di=Array.prototype,Fi=Di.map;function A(){}const $e=1,W=2,Q=3,F=Symbol("no-observer");function q(e,t,n,r){n||(n=F),Object.defineProperties(this,{_observer:{value:n,writable:!0},_definition:{value:qe,writable:!0},_duplicate:{value:void 0,writable:!0},_duplicates:{value:void 0,writable:!0},_indegree:{value:NaN,writable:!0},_inputs:{value:[],writable:!0},_invalidate:{value:A,writable:!0},_module:{value:t},_name:{value:null,writable:!0},_outputs:{value:new Set,writable:!0},_promise:{value:Promise.resolve(void 0),writable:!0},_reachable:{value:n!==F,writable:!0},_rejector:{value:zi(this)},_shadow:{value:Bi(t,r)},_type:{value:e},_value:{value:void 0,writable:!0},_version:{value:0,writable:!0}})}Object.defineProperties(q.prototype,{_pending:{value:Qi,writable:!0,configurable:!0},_fulfilled:{value:Ji,writable:!0,configurable:!0},_rejected:{value:Ki,writable:!0,configurable:!0},_resolve:{value:Yi,writable:!0,configurable:!0},define:{value:Wi,writable:!0,configurable:!0},delete:{value:Gi,writable:!0,configurable:!0},import:{value:Hi,writable:!0,configurable:!0}});function Bi(e,t){return t?.shadow?new Map(Object.entries(t.shadow).map(([n,r])=>[n,new q(W,e).define([],r)])):null}function Ui(e){e._module._runtime._dirty.add(e),e._outputs.add(this)}function Vi(e){e._module._runtime._dirty.add(e),e._outputs.delete(this)}function qe(){throw qe}function C(){throw C}function zi(e){return t=>{throw t===C?t:t===qe?new T(`${e._name} is not defined`,e._name):t instanceof Error&&t.message?new T(t.message,e._name):new T(`${e._name} could not be resolved`,e._name)}}function Xe(e){return()=>{throw new T(`${e} is defined more than once`)}}function Wi(e,t,n){switch(arguments.length){case 1:{n=e,e=t=null;break}case 2:{n=t,typeof e=="string"?t=null:(t=e,e=null);break}}return Oe.call(this,e==null?null:String(e),t==null?[]:Fi.call(t,this._resolve,this),typeof n=="function"?n:_e(n))}function Yi(e){return this._shadow?.get(e)??this._module._resolve(e)}function Oe(e,t,n){const r=this._module._scope,o=this._module._runtime;if(this._inputs.forEach(Vi,this),t.forEach(Ui,this),this._inputs=t,this._definition=n,this._value=void 0,n===A?o._variables.delete(this):o._variables.add(this),e!==this._name||r.get(e)!==this){let s,i;if(this._name)if(this._outputs.size)r.delete(this._name),i=this._module._resolve(this._name),i._outputs=this._outputs,this._outputs=new Set,i._outputs.forEach(function(a){a._inputs[a._inputs.indexOf(this)]=i},this),i._outputs.forEach(o._updates.add,o._updates),o._dirty.add(i).add(this),r.set(this._name,i);else if((i=r.get(this._name))===this)r.delete(this._name);else if(i._type===Q)i._duplicates.delete(this),this._duplicate=void 0,i._duplicates.size===1&&(i=i._duplicates.keys().next().value,s=r.get(this._name),i._outputs=s._outputs,s._outputs=new Set,i._outputs.forEach(function(a){a._inputs[a._inputs.indexOf(s)]=i}),i._definition=i._duplicate,i._duplicate=void 0,o._dirty.add(s).add(i),o._updates.add(i),r.set(this._name,i));else throw new Error;if(this._outputs.size)throw new Error;e&&((i=r.get(e))?i._type===Q?(this._definition=Xe(e),this._duplicate=n,i._duplicates.add(this)):i._type===W?(this._outputs=i._outputs,i._outputs=new Set,this._outputs.forEach(function(a){a._inputs[a._inputs.indexOf(i)]=this},this),o._dirty.add(i).add(this),r.set(e,this)):(i._duplicate=i._definition,this._duplicate=n,s=new q(Q,this._module),s._name=e,s._definition=this._definition=i._definition=Xe(e),s._outputs=i._outputs,i._outputs=new Set,s._outputs.forEach(function(a){a._inputs[a._inputs.indexOf(i)]=s}),s._duplicates=new Set([this,i]),o._dirty.add(i).add(s),o._updates.add(i).add(s),r.set(e,s)):r.set(e,this)),this._name=e}return this._version>0&&++this._version,o._updates.add(this),o._compute(),this}function Hi(e,t,n){return arguments.length<3&&(n=t,t=e),Oe.call(this,String(t),[n._resolve(String(e))],ne)}function Gi(){return Oe.call(this,null,[],A)}function Qi(){this._observer.pending&&this._observer.pending()}function Ji(e){this._observer.fulfilled&&this._observer.fulfilled(e,this._name)}function Ki(e){this._observer.rejected&&this._observer.rejected(e,this._name)}const Nt=Symbol("variable"),St=Symbol("invalidation"),$t=Symbol("visibility");function re(e,t=[]){Object.defineProperties(this,{_runtime:{value:e},_scope:{value:new Map},_builtins:{value:new Map([["@variable",Nt],["invalidation",St],["visibility",$t],...t])},_source:{value:null,writable:!0}})}Object.defineProperties(re.prototype,{_resolve:{value:io,writable:!0,configurable:!0},redefine:{value:Zi,writable:!0,configurable:!0},define:{value:Xi,writable:!0,configurable:!0},derive:{value:ro,writable:!0,configurable:!0},import:{value:eo,writable:!0,configurable:!0},value:{value:no,writable:!0,configurable:!0},variable:{value:to,writable:!0,configurable:!0},builtin:{value:oo,writable:!0,configurable:!0}});function Zi(e){const t=this._scope.get(e);if(!t)throw new T(`${e} is not defined`);if(t._type===Q)throw new T(`${e} is defined more than once`);return t.define.apply(t,arguments)}function Xi(){const e=new q($e,this);return e.define.apply(e,arguments)}function eo(){const e=new q($e,this);return e.import.apply(e,arguments)}function to(e,t){return new q($e,this,e,t)}async function no(e){let t=this._scope.get(e);if(!t)throw new T(`${e} is not defined`);if(t._observer===F){t=this.variable(!0).define([e],ne);try{return await ve(this._runtime,t)}finally{t.delete()}}else return ve(this._runtime,t)}async function ve(e,t){await e._compute();try{return await t._promise}catch(n){if(n===C)return ve(e,t);throw n}}function ro(e,t){const n=new Map,r=new Set,o=[];function s(a){let l=n.get(a);return l||(l=new re(a._runtime,a._builtins),l._source=a,n.set(a,l),o.push([l,a]),r.add(a),l)}const i=s(this);for(const a of e){const{alias:l,name:c}=typeof a=="object"?a:{name:a};i.import(c,l??c,t)}for(const a of r)for(const[l,c]of a._scope)if(c._definition===ne){if(a===this&&i._scope.has(l))continue;const u=c._inputs[0]._module;u._source&&s(u)}for(const[a,l]of o)for(const[c,u]of l._scope){const f=a._scope.get(c);if(!(f&&f._type!==W))if(u._definition===ne){const p=u._inputs[0],d=p._module;a.import(p._name,c,n.get(d)||d)}else a.define(c,u._inputs.map(so),u._definition)}return i}function io(e){let t=this._scope.get(e),n;if(!t)if(t=new q(W,this),this._builtins.has(e))t.define(e,_e(this._builtins.get(e)));else if(this._runtime._builtin._scope.has(e))t.import(e,this._runtime._builtin);else{try{n=this._runtime._global(e)}catch(r){return t.define(e,ji(r))}n===void 0?this._scope.set(t._name=e,t):t.define(e,_e(n))}return t}function oo(e,t){this._builtins.set(e,t)}function so(e){return e._name}const ao=typeof requestAnimationFrame=="function"?requestAnimationFrame:typeof setImmediate=="function"?setImmediate:e=>setTimeout(e,0);function co(e=new Li,t=No){const n=this.module();if(Object.defineProperties(this,{_dirty:{value:new Set},_updates:{value:new Set},_precomputes:{value:[],writable:!0},_computing:{value:null,writable:!0},_init:{value:null,writable:!0},_modules:{value:new Map},_variables:{value:new Set},_disposed:{value:!1,writable:!0},_builtin:{value:n},_global:{value:t}}),e)for(const r in e)new q(W,n).define(r,[],e[r])}Object.defineProperties(co.prototype,{_precompute:{value:fo,writable:!0,configurable:!0},_compute:{value:po,writable:!0,configurable:!0},_computeSoon:{value:mo,writable:!0,configurable:!0},_computeNow:{value:ho,writable:!0,configurable:!0},dispose:{value:lo,writable:!0,configurable:!0},module:{value:uo,writable:!0,configurable:!0},fileAttachments:{value:zr,writable:!0,configurable:!0}});function lo(){this._computing=Promise.resolve(),this._disposed=!0,this._variables.forEach(e=>{e._invalidate(),e._version=NaN})}function uo(e,t=A){let n;if(e===void 0)return(n=this._init)?(this._init=null,n):new re(this);if(n=this._modules.get(e),n)return n;this._init=n=new re(this),this._modules.set(e,n);try{e(this,t)}finally{this._init=null}return n}function fo(e){this._precomputes.push(e),this._compute()}function po(){return this._computing||(this._computing=this._computeSoon())}function mo(){return new Promise(ao).then(()=>this._disposed?void 0:this._computeNow())}async function ho(){let e=[],t,n,r=this._precomputes;if(r.length){this._precomputes=[];for(const s of r)s();await bo(3)}t=new Set(this._dirty),t.forEach(function(s){s._inputs.forEach(t.add,t);const i=Ao(s);i>s._reachable?this._updates.add(s):i<s._reachable&&s._invalidate(),s._reachable=i},this),t=new Set(this._updates),t.forEach(function(s){s._reachable?(s._indegree=0,s._outputs.forEach(t.add,t)):(s._indegree=NaN,t.delete(s))}),this._computing=null,this._updates.clear(),this._dirty.clear(),t.forEach(function(s){s._outputs.forEach(yo)});do{for(t.forEach(function(s){s._indegree===0&&e.push(s)});n=e.pop();)Eo(n),n._outputs.forEach(o),t.delete(n);t.forEach(function(s){wo(s)&&(To(s,new T("circular definition")),s._outputs.forEach(_o),t.delete(s))})}while(t.size);function o(s){--s._indegree===0&&e.push(s)}}function bo(e=0){let t=Promise.resolve();for(let n=0;n<e;++n)t=t.then(()=>{});return t}function wo(e){const t=new Set(e._inputs);for(const n of t){if(n===e)return!0;n._inputs.forEach(t.add,t)}return!1}function yo(e){++e._indegree}function _o(e){--e._indegree}function vo(e){return e._promise.catch(e._rejector)}function de(e){return new Promise(function(t){e._invalidate=t})}function go(e,t){let n=typeof IntersectionObserver=="function"&&t._observer&&t._observer._node,r=!n,o=A,s=A,i,a;return n&&(a=new IntersectionObserver(([l])=>(r=l.isIntersecting)&&(i=null,o())),a.observe(n),e.then(()=>(a.disconnect(),a=null,s()))),function(l){return r?Promise.resolve(l):a?(i||(i=new Promise((c,u)=>(o=c,s=u))),i.then(()=>l)):Promise.reject()}}function Eo(e){e._invalidate(),e._invalidate=A,e._pending();const t=e._value,n=++e._version;let r=null;const o=e._promise=(e._inputs.length?Promise.all(e._inputs.map(vo)).then(s):new Promise(a=>a(e._definition.call(t)))).then(i);function s(a){if(e._version!==n)throw C;for(let l=0,c=a.length;l<c;++l)switch(a[l]){case St:{a[l]=r=de(e);break}case $t:{r||(r=de(e)),a[l]=go(r,e);break}case Nt:{a[l]=e;break}}return e._definition.apply(t,a)}function i(a){if(e._version!==n)throw C;return Ri(a)?((r||de(e)).then(Co(a)),xo(e,n,a)):a}o.then(a=>{e._value=a,e._fulfilled(a)},a=>{a===C||e._version!==n||(e._value=void 0,e._rejected(a))})}function xo(e,t,n){const r=e._module._runtime;let o;function s(l){return new Promise(c=>c(n.next(o))).then(({done:c,value:u})=>c?void 0:Promise.resolve(u).then(l))}function i(){const l=s(c=>{if(e._version!==t)throw C;return o=c,a(c,l).then(()=>r._precompute(i)),e._fulfilled(c),c});l.catch(c=>{c===C||e._version!==t||(a(void 0,l),e._rejected(c))})}function a(l,c){return e._value=l,e._promise=c,e._outputs.forEach(r._updates.add,r._updates),r._compute()}return s(l=>{if(e._version!==t)throw C;return o=l,r._precompute(i),l})}function To(e,t){e._invalidate(),e._invalidate=A,e._pending(),++e._version,e._indegree=NaN,(e._promise=Promise.reject(t)).catch(A),e._value=void 0,e._rejected(t)}function Co(e){return function(){e.return()}}function Ao(e){if(e._observer!==F)return!0;const t=new Set(e._outputs);for(const n of t){if(n._observer!==F)return!0;n._outputs.forEach(t.add,t)}return!1}function No(e){return globalThis[e]}export{Me as I,co as R};
//# sourceMappingURL=runtime.Ck86Unyv.js.map
