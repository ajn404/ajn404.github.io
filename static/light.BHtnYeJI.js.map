{"version":3,"file":"light.BHtnYeJI.js","sources":["../../src/components/react/cesium/demo/light.tsx"],"sourcesContent":["import { useEffect, useRef, useReducer } from \"react\";\nimport { Viewer, Ion, IonWorldImageryStyle, ImageryLayer } from \"cesium\";\nimport \"cesium/Build/Cesium/Widgets/widgets.css\";\nIon.defaultAccessToken =\n  \"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiIwOWRkMzFlYS0yMDVhLTRkNzYtYWJmMC1hMmE1NjljN2MyNjMiLCJpZCI6NzMzNDQsImlhdCI6MTYzNjgxNDEzNX0.Q2MfD_lkQgsJ-R3NPfYjS9QA9q_j4Py8DktYKsPmZNg\";\n\n// 定义状态类型\ntype State = {\n  viewer: Viewer | null;\n  scene: any | null;\n};\n\n// 定义action类型\ntype Action =\n  | { type: \"INIT_VIEWER\"; payload: { viewer: Viewer; scene: any } }\n  | { type: \"DESTROY_VIEWER\" };\n\n// 创建reducer函数\nfunction cesiumReducer(state: State, action: Action): State {\n  switch (action.type) {\n    case \"INIT_VIEWER\":\n      return {\n        ...state,\n        viewer: action.payload.viewer,\n        scene: action.payload.scene,\n      };\n    case \"DESTROY_VIEWER\":\n      return {\n        ...state,\n        viewer: null,\n        scene: null,\n      };\n    default:\n      return state;\n  }\n}\n\nexport default function Control() {\n  const cesiumRef = useRef(null);\n  const [state, dispatch] = useReducer(cesiumReducer, {\n    viewer: null,\n    scene: null,\n  });\n\n  useEffect(() => {\n    if (cesiumRef.current && !state.viewer) {\n      const viewer = new Viewer(cesiumRef.current, {\n        terrainProvider: undefined,\n        baseLayerPicker: false,\n        geocoder: false,\n        homeButton: false,\n        sceneModePicker: false,\n        navigationHelpButton: false,\n        animation: false,\n        timeline: false,\n        fullscreenButton: false,\n        baseLayer: ImageryLayer.fromWorldImagery({}),\n      });\n\n      //@ts-ignore\n      viewer._cesiumWidget._creditContainer.parentNode.removeChild(\n        //@ts-ignore\n        viewer._cesiumWidget._creditContainer\n      );\n\n      const scene = viewer.scene;\n      const canvas = viewer.canvas;\n      canvas.setAttribute(\"tabindex\", \"0\");\n      canvas.onclick = () => canvas.focus();\n\n      dispatch({ type: \"INIT_VIEWER\", payload: { viewer, scene } });\n\n      const handleWheel = (event: WheelEvent) => {\n        event.stopPropagation();\n      };\n      cesiumRef.current.addEventListener(\"wheel\", handleWheel);\n\n      return () => {\n        viewer.destroy();\n        dispatch({ type: \"DESTROY_VIEWER\" });\n      };\n    }\n  }, []);\n\n  return (\n    <div>\n      <div\n        onDoubleClick={() => {\n          if (cesiumRef.current) {\n            if (document.fullscreenElement) {\n              document.exitFullscreen();\n            } else {\n              cesiumRef.current.requestFullscreen();\n            }\n          }\n        }}\n        ref={cesiumRef}\n        style={{ width: \"100%\", height: \"500px\", userSelect: \"none\" }}\n      />\n    </div>\n  );\n}\n"],"names":["Ion","cesiumReducer","state","action","Control","cesiumRef","useRef","dispatch","useReducer","useEffect","viewer","Viewer","ImageryLayer","scene","canvas","handleWheel","event","jsx"],"mappings":"0mBAGAA,EAAI,mBACF,uLAcF,SAASC,EAAcC,EAAcC,EAAuB,CAC1D,OAAQA,EAAO,KAAM,CACnB,IAAK,cACI,MAAA,CACL,GAAGD,EACH,OAAQC,EAAO,QAAQ,OACvB,MAAOA,EAAO,QAAQ,KACxB,EACF,IAAK,iBACI,MAAA,CACL,GAAGD,EACH,OAAQ,KACR,MAAO,IACT,EACF,QACS,OAAAA,CAAA,CAEb,CAEA,SAAwBE,GAAU,CAC1B,MAAAC,EAAYC,SAAO,IAAI,EACvB,CAACJ,EAAOK,CAAQ,EAAIC,EAAAA,WAAWP,EAAe,CAClD,OAAQ,KACR,MAAO,IAAA,CACR,EAEDQ,OAAAA,EAAAA,UAAU,IAAM,CACd,GAAIJ,EAAU,SAAW,CAACH,EAAM,OAAQ,CACtC,MAAMQ,EAAS,IAAIC,EAAON,EAAU,QAAS,CAC3C,gBAAiB,OACjB,gBAAiB,GACjB,SAAU,GACV,WAAY,GACZ,gBAAiB,GACjB,qBAAsB,GACtB,UAAW,GACX,SAAU,GACV,iBAAkB,GAClB,UAAWO,EAAa,iBAAiB,CAAE,CAAA,CAAA,CAC5C,EAGMF,EAAA,cAAc,iBAAiB,WAAW,YAE/CA,EAAO,cAAc,gBACvB,EAEA,MAAMG,EAAQH,EAAO,MACfI,EAASJ,EAAO,OACfI,EAAA,aAAa,WAAY,GAAG,EAC5BA,EAAA,QAAU,IAAMA,EAAO,MAAM,EAE3BP,EAAA,CAAE,KAAM,cAAe,QAAS,CAAE,OAAAG,EAAQ,MAAAG,CAAA,EAAS,EAEtD,MAAAE,EAAeC,GAAsB,CACzCA,EAAM,gBAAgB,CACxB,EACU,OAAAX,EAAA,QAAQ,iBAAiB,QAASU,CAAW,EAEhD,IAAM,CACXL,EAAO,QAAQ,EACNH,EAAA,CAAE,KAAM,iBAAkB,CACrC,CAAA,CAEJ,EAAG,EAAE,QAGF,MACC,CAAA,SAAAU,EAAA,IAAC,MAAA,CACC,cAAe,IAAM,CACfZ,EAAU,UACR,SAAS,kBACX,SAAS,eAAe,EAExBA,EAAU,QAAQ,kBAAkB,EAG1C,EACA,IAAKA,EACL,MAAO,CAAE,MAAO,OAAQ,OAAQ,QAAS,WAAY,MAAO,CAAA,CAAA,EAEhE,CAEJ"}