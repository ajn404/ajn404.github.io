import{j as lt}from"./jsx-runtime.DZ3s2XAB.js";import{r as cn}from"./index.D4IXJ7me.js";import{p as $e,i as _n,s as jt,B as Si,D as ze,r as En}from"./transform.Cz8yado1.js";import{a as As}from"./ascending.CsD5ogAT.js";import{d as Xe,b as Ts,t as Cs,l as Ai,i as Is,a as Es}from"./linear.BndfXy2v.js";import{m as Ct,p as Ls,s as Ze,t as Ti,a as Ci,b as Ii,c as Ds,d as Ns,e as ks,f as Os,g as Fs,h as Rs,i as Tr,j as Ei,k as Li,u as Di,l as Ni,n as ki,o as Bs,q as js,r as qs,v as Ws,w as Ps,x as zs,y as Cr,z as Oi,A as Fi,B as Vs,C as Gn,D as Ln,E as Hs,F as _s,G as Gs,H as Ks,I as Us,J as Ys,K as Xs,L as Zs,M as Js,N as Qs,O as tu,P as eu,Q as nu,R as Pt,S as ru,T as iu,U as Dn,V as ou,W as au,X as su,Y as zt,Z as uu,_ as lu,$ as fu,a0 as cu,a1 as du,a2 as hu,a3 as mu,a4 as pu,a5 as gu,a6 as yu,a7 as bu,a8 as wu,a9 as Ri,aa as Bi,ab as ji,ac as qi,ad as Ve,ae as Wi,af as He,ag as Pi,ah as zi,ai as Vi,aj as Hi,ak as _i,al as Gi,am as Ki,an as Ui,ao as Yi,ap as Xi,aq as Zi,ar as Ji,as as Qi,at as to,au as eo,av as no,aw as ro,ax as io,ay as oo,az as ao,aA as so,aB as uo,aC as lo,aD as fo,aE as co,aF as ho,aG as mo,aH as po,aI as pt,aJ as xu,aK as $u,aL as vu,aM as Mu,aN as Ir,aO as Su,aP as Er,aQ as Au,aR as Tu,aS as Cu,aT as Iu,aU as Eu,aV as Lu,aW as Du,aX as Nu,aY as ku,aZ as Ou,a_ as Fu,a$ as Ru,b0 as Bu,b1 as ju,b2 as qu,b3 as Wu,b4 as Pu,b5 as zu,b6 as Vu,b7 as Hu,b8 as _u,b9 as Gu,ba as Ku,bb as Uu,bc as Nt,bd as Yu,be as Xu,bf as Kn,bg as Zu,bh as Ju,bi as Qu,bj as tl,bk as el,bl as nl,bm as rl,bn as il,bo as ol,bp as go,bq as al,br as sl,bs as ul,bt as ll,bu as fl,bv as qe,bw as Un,bx as _e,by as cl,bz as dl,bA as hl,bB as ml,bC as pl,bD as gl,bE as yl,bF as bl,bG as wl,bH as xl,bI as $l,bJ as vl,bK as Ml,bL as Sl,bM as Al,bN as Tl,bO as Cl,bP as Il,bQ as Yn}from"./symbol.C3Vo_426.js";import{r as Lr}from"./range.D-5Q8ioH.js";import{I as Je,i as El,o as Ll,a as Xn}from"./ordinal.D9ljPjiG.js";import{w as yo,c as bo,i as wo}from"./rainbow.DjUF6Jfe.js";import{s as Dl}from"./category10.CPFRveg8.js";import{r as Ge,g as xo}from"./reverse.CJyOsb0K.js";import{f as Nl}from"./format.HwC_tL7Y.js";import{p as kl}from"./pointer.Kth1cJfI.js";import{b as Zn}from"./defaultLocale.BMuxjawy.js";import{a as Nn}from"./path.C6h6bzIp.js";import"./_sentry-release-injection-file.B-UwqLso.js";import"./_commonjsHelpers.DqoTaOmB.js";import"./init.BEQ4XkHb.js";import"./path.B_4UUwUb.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},e=new t.Error().stack;e&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[e]="c50cc801-e72a-4b52-93e7-18e3e8765a4a",t._sentryDebugIdIdentifier="sentry-dbid-c50cc801-e72a-4b52-93e7-18e3e8765a4a")}catch{}})();const Ol=/^(?:[-+]\d{2})?\d{4}(?:-\d{2}(?:-\d{2})?)?(?:T\d{2}:\d{2}(?::\d{2}(?:\.\d{3})?)?(?:Z|[-+]\d{2}:?\d{2})?)?$/;function $o(t,e){return Ol.test(t+="")?new Date(t):e}function Vt(t){return t!=null&&!Number.isNaN(t)}function wt(t,e){return+Vt(e)-+Vt(t)||As(t,e)}function Ke(t,e){return+Vt(e)-+Vt(t)||Xe(t,e)}function vo(t){return t!=null&&`${t}`!=""}function Mo(t){return isFinite(t)?t:NaN}function Jn(t){return t>0&&isFinite(t)?t:NaN}function So(t){return t<0&&isFinite(t)?t:NaN}function re(t){if(t==null)return;const e=t[0],n=t[t.length-1];return Xe(e,n)}const ee=1e3,Lt=ee*60,Dt=Lt*60,xt=Dt*24,yt=xt*7,qt=xt*30,Et=xt*365,dn=[["millisecond",1],["2 milliseconds",2],["5 milliseconds",5],["10 milliseconds",10],["20 milliseconds",20],["50 milliseconds",50],["100 milliseconds",100],["200 milliseconds",200],["500 milliseconds",500],["second",ee],["5 seconds",5*ee],["15 seconds",15*ee],["30 seconds",30*ee],["minute",Lt],["5 minutes",5*Lt],["15 minutes",15*Lt],["30 minutes",30*Lt],["hour",Dt],["3 hours",3*Dt],["6 hours",6*Dt],["12 hours",12*Dt],["day",xt],["2 days",2*xt],["week",yt],["2 weeks",2*yt],["month",qt],["3 months",3*qt],["6 months",6*qt],["year",Et],["2 years",2*Et],["5 years",5*Et],["10 years",10*Et],["20 years",20*Et],["50 years",50*Et],["100 years",100*Et]],Qn=new Map([["second",ee],["minute",Lt],["hour",Dt],["day",xt],["monday",yt],["tuesday",yt],["wednesday",yt],["thursday",yt],["friday",yt],["saturday",yt],["sunday",yt],["week",yt],["month",qt],["year",Et]]),Ao=new Map([["second",Ze],["minute",Ti],["hour",Ci],["day",Ii],["monday",Ds],["tuesday",Ns],["wednesday",ks],["thursday",Os],["friday",Fs],["saturday",Rs],["sunday",Tr],["week",Tr],["month",Ei],["year",Li]]),tr=new Map([["second",Ze],["minute",Di],["hour",Ni],["day",ki],["monday",Bs],["tuesday",js],["wednesday",qs],["thursday",Ws],["friday",Ps],["saturday",zs],["sunday",Cr],["week",Cr],["month",Oi],["year",Fi]]),ve=Symbol("intervalDuration"),Qe=Symbol("intervalType");for(const[t,e]of Ao)e[ve]=Qn.get(t),e[Qe]="time";for(const[t,e]of tr)e[ve]=Qn.get(t),e[Qe]="utc";const he=[["year",Fi,"utc"],["month",Oi,"utc"],["day",ki,"utc",6*qt],["hour",Ni,"utc",3*xt],["minute",Di,"utc",6*Dt],["second",Ze,"utc",30*Lt]],We=[["year",Li,"time"],["month",Ei,"time"],["day",Ii,"time",6*qt],["hour",Ci,"time",3*xt],["minute",Ti,"time",6*Dt],["second",Ze,"time",30*Lt]],Fl=[he[0],We[0],he[1],We[1],he[2],We[2],...he.slice(3)];function To(t){let e=`${t}`.toLowerCase();e.endsWith("s")&&(e=e.slice(0,-1));let n=1;const r=/^(?:(\d+)\s+)/.exec(e);switch(r&&(e=e.slice(r[0].length),n=+r[1]),e){case"quarter":e="month",n*=3;break;case"half":e="month",n*=6;break}let i=tr.get(e);if(!i)throw new Error(`unknown interval: ${t}`);if(n>1&&!i.every)throw new Error(`non-periodic interval: ${e}`);return[e,n]}function Co(t){return Eo(To(t),"time")}function Io(t){return Eo(To(t),"utc")}function Eo([t,e],n){let r=(n==="time"?Ao:tr).get(t);return e>1&&(r=r.every(e),r[ve]=Qn.get(t)*e,r[Qe]=n),r}function Dr(t,e){if(!(e>1))return;const n=t[ve];if(!dn.some(([,i])=>i===n)||n%xt===0&&xt<n&&n<qt)return;const[r]=dn[Ts(([,i])=>Math.log(i)).center(dn,Math.log(n*e))];return(t[Qe]==="time"?Co:Io)(r)}function Nr(t,e,n){const r=e==="time"?Vs:Gn;if(n==null)return r(t==="year"?"%Y":t==="month"?"%Y-%m":t==="day"?"%Y-%m-%d":t==="hour"||t==="minute"?"%Y-%m-%dT%H:%M":t==="second"?"%Y-%m-%dT%H:%M:%S":"%Y-%m-%dT%H:%M:%S.%L");const i=Rl(n);switch(t){case"millisecond":return Qt(r(".%L"),r(":%M:%S"),i);case"second":return Qt(r(":%S"),r("%-I:%M"),i);case"minute":return Qt(r("%-I:%M"),r("%p"),i);case"hour":return Qt(r("%-I %p"),r("%b %-d"),i);case"day":return Qt(r("%-d"),r("%b"),i);case"month":return Qt(r("%b"),r("%Y"),i);case"year":return r("%Y")}throw new Error("unable to format time ticks")}function Rl(t){return t==="left"||t==="right"?(e,n)=>`
${e}
${n}`:t==="top"?(e,n)=>`${n}
${e}`:(e,n)=>`${e}
${n}`}function Bl(t){return t==="time"?We:t==="utc"?he:Fl}function jl(t,e,n){const r=Ct(Ls(e,(i,o)=>Math.abs(o-i)));if(r<1e3)return Nr("millisecond","utc",n);for(const[i,o,a,s]of Bl(t)){if(r>s||i==="hour"&&!r)break;if(e.every(u=>o.floor(u)>=u))return Nr(i,a,n)}}function Qt(t,e,n){return(r,i,o)=>{const a=t(r,i),s=e(r,i),u=i-re(o);return i!==u&&o[u]!==void 0&&s===e(o[u],u)?a:n(a,s)}}const er=Object.getPrototypeOf(Uint8Array),ql=Object.prototype.toString;function Gt(t){return t instanceof Array||t instanceof er}function Lo(t){return t instanceof er&&!Wl(t)}function Do(t){return t?.prototype instanceof er&&!Pl(t)}function Wl(t){return t instanceof BigInt64Array||t instanceof BigUint64Array}function Pl(t){return t===BigInt64Array||t===BigUint64Array}const No=Symbol("reindex");function ft(t,e,n){const r=typeof e;return r==="string"?_o(t)?nr(t.getChild(e),n):kr(t,ko(e),n):r==="function"?kr(t,e,n):r==="number"||e instanceof Date||r==="boolean"?U(t,Tt(e),n):typeof e?.transform=="function"?kn(e.transform(t),n):zl(kn(e,n),t?.[No])}function zl(t,e){return t!=null&&e?or(t,e):t}function kr(t,e,n){return U(t,Do(n)?(r,i)=>rr(e(r,i)):e,n)}function kn(t,e){return e===void 0?Kt(t):Go(t)?nr(t,e):t instanceof e?t:e.from(t,Do(e)&&!Lo(t)?rr:void 0)}function nr(t,e){return t==null?t:(e===void 0||e===Array)&&pf(t.type)?Ro(Or(t)):kn(Or(t),e)}function Or(t){return t.nullCount?t.toJSON():t.toArray()}const Pe=[null],ko=t=>e=>{const n=e[t];return n===void 0&&e.type==="Feature"?e.properties?.[t]:n},Oo={transform:Ot},dt={transform:t=>t},Vl=()=>1,Hl=()=>!0,et=t=>t==null?t:`${t}`,nt=t=>t==null?t:+t,Fo=t=>t?t[0]:void 0,_l=t=>t?t[1]:void 0,Tt=t=>()=>t;function Gl(t){const e=+`${t}`.slice(1)/100;return(n,r)=>Ln(n,e,r)}function Fr(t){return Lo(t)?t:U(t,rr,Float64Array)}function rr(t){return t==null?NaN:Number(t)}function Ro(t){return U(t,Kl)}function Kl(t){return t instanceof Date&&!isNaN(t)?t:typeof t=="string"?$o(t):t==null||isNaN(t=Number(t))?void 0:new Date(t)}function Ht(t,e){return t===void 0&&(t=e),t===null?[void 0,"none"]:en(t)?[void 0,t]:[t,void 0]}function at(t,e){return t===void 0&&(t=e),t===null||typeof t=="number"?[void 0,t]:[t,void 0]}function Bo(t,e,n){if(t!=null)return gt(t,e,n)}function gt(t,e,n){const r=`${t}`.toLowerCase();if(!n.includes(r))throw new Error(`invalid ${e}: ${t}`);return r}function ie(t){return _o(t)?t:Kt(t)}function Kt(t){if(t==null||Gt(t))return t;if(Go(t))return nr(t);if(jo(t))switch(t.type){case"FeatureCollection":return t.features;case"GeometryCollection":return t.geometries;default:return[t]}return Array.from(t)}function jo(t){switch(t?.type){case"FeatureCollection":case"GeometryCollection":case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":return!0;default:return!1}}function U(t,e,n=Array){return t==null?t:t instanceof n?t.map(e):n.from(t,e)}function me(t,e=Array){return t instanceof e?t.slice():e.from(t)}function qo({x:t,x1:e,x2:n}){return t!==void 0||e!==void 0||n!==void 0}function Ul({y:t,y1:e,y2:n}){return t!==void 0||e!==void 0||n!==void 0}function Yl(t){return qo(t)||Ul(t)||t.interval!==void 0}function Ut(t){return t?.toString===ql}function On(t){return Ut(t)&&(t.type!==void 0||t.domain!==void 0)}function ir(t){return Ut(t)&&typeof t.transform!="function"}function pe(t){return ir(t)&&t.value===void 0&&t.channel===void 0}function Xl(t,e,n,r=dt){return e===void 0&&n===void 0?(e=0,n=t===void 0?r:t):e===void 0?e=t===void 0?0:t:n===void 0&&(n=t===void 0?0:t),[e,n]}function Wo(t,e){return t===void 0&&e===void 0?[Fo,_l]:[t,e]}function Zl({z:t,fill:e,stroke:n}={}){return t===void 0&&([t]=Ht(e)),t===void 0&&([t]=Ht(n)),t}function ge(t){return Gt(t)?t.length:t?.numRows}function Ot(t){const e=ge(t),n=new Uint32Array(e);for(let r=0;r<e;++r)n[r]=r;return n}function or(t,e){return Gt(t)?U(e,n=>t[n],t.constructor):U(e,n=>t.at(n))}function Jl(t,e,n){return t.subarray?t.subarray(e,n):t.slice(e,n)}function Le(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Fn(t){let e;return[{transform:()=>e,label:Me(t)},n=>e=n]}function Ql(t){return t==null?[t]:Fn(t)}function Me(t,e){return typeof t=="string"?t:t&&t.label!==void 0?t.label:e}function tf(t,e){return{transform(n){const r=t.transform(n),i=e.transform(n);return ct(r)||ct(i)?U(r,(o,a)=>new Date((+r[a]+ +i[a])/2)):U(r,(o,a)=>(+r[a]+ +i[a])/2,Float64Array)},label:t.label}}function ef(t,e){const n=Po(e?.interval,e?.type);return n?U(t,n):t}function Po(t,e){const n=ar(t,e);return n&&(r=>Vt(r)?n.floor(r):r)}function ar(t,e){if(t!=null){if(typeof t=="number")return nf(t);if(typeof t=="string")return(e==="time"?Co:Io)(t);if(typeof t.floor!="function")throw new Error("invalid interval; missing floor method");if(typeof t.offset!="function")throw new Error("invalid interval; missing offset method");return t}}function nf(t){t=+t,0<t&&t<1&&Number.isInteger(1/t)&&(t=-1/t);const e=Math.abs(t);return t<0?{floor:n=>Math.floor(n*e)/e,offset:(n,r=1)=>(n*e+Math.floor(r))/e,range:(n,r)=>Lr(Math.ceil(n*e),r*e).map(i=>i/e)}:{floor:n=>Math.floor(n/e)*e,offset:(n,r=1)=>n+e*Math.floor(r),range:(n,r)=>Lr(Math.ceil(n/e),r/e).map(i=>i*e)}}function Se(t,e){if(t=ar(t,e),t&&typeof t.range!="function")throw new Error("invalid interval: missing range method");return t}function rf(t,e){if(t=Se(t,e),t&&typeof t.ceil!="function")throw new Error("invalid interval: missing ceil method");return t}function of(t){return typeof t?.range=="function"}function tn(t){return t===void 0||ir(t)?t:{value:t}}function af(t){return t==null?null:{transform:e=>ft(e,t,Float64Array),label:Me(t)}}function Yt(t){return t&&typeof t[Symbol.iterator]=="function"}function zo(t){for(const e of t)if(e!=null)return typeof e!="object"||e instanceof Date}function Rr(t){for(const e of t){if(e==null)continue;const n=typeof e;return n==="string"||n==="boolean"}}function ct(t){for(const e of t)if(e!=null)return e instanceof Date}function sf(t){for(const e of t)if(e!=null)return typeof e=="string"&&isNaN(e)&&$o(e)}function uf(t){for(const e of t)if(e!=null){if(typeof e!="string")return!1;if(e.trim())return!isNaN(e)}}function lf(t){for(const e of t)if(e!=null)return typeof e=="number"}function hn(t,e){let n;for(const r of t)if(r!=null){if(!e(r))return!1;n=!0}return n}const ff=new Set("none,currentcolor,transparent,aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,grey,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow".split(","));function en(t){return typeof t!="string"?!1:(t=t.toLowerCase().trim(),/^#[0-9a-f]{3,8}$/.test(t)||/^(?:url|var|rgb|rgba|hsl|hsla|hwb|lab|lch|oklab|oklch|color|color-mix)\(.*\)$/.test(t)||ff.has(t))}function cf(t){return typeof t=="number"&&(0<=t&&t<=1||isNaN(t))}function ot(t){return t==null||ye(t)}function ye(t){return/^\s*none\s*$/i.test(t)}function df(t){return/^\s*round\s*$/i.test(t)}function Rn(t,e){return Bo(t,e,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function sr(t="middle"){return Rn(t,"frameAnchor")}function hf(t={},...e){let n=t;for(const r of e)for(const i in r)if(n[i]===void 0){const o=r[i];n===t?n={...n,[i]:o}:n[i]=o}return n}function mf(t){console.warn("named iterables are deprecated; please use an object instead");const e=new Set;return Object.fromEntries(Array.from(t,n=>{const{name:r}=n;if(r==null)throw new Error("missing name");const i=`${r}`;if(i==="__proto__")throw new Error(`illegal name: ${i}`);if(e.has(i))throw new Error(`duplicate name: ${i}`);return e.add(i),[r,n]}))}function Vo(t){return Yt(t)?mf(t):t}function Ho(t){return t===!0?t="frame":t===!1?t=null:!jo(t)&&t!=null&&(t=gt(t,"clip",["frame","sphere"]),t==="sphere"&&(t={type:"Sphere"})),t}function _o(t){return t&&typeof t.getChild=="function"&&typeof t.toArray=="function"&&t.schema&&Array.isArray(t.schema.fields)}function Go(t){return t&&typeof t.toArray=="function"&&t.type}function pf(t){return t&&(t.typeId===8||t.typeId===10)&&t.unit===1}const bt=Symbol("position"),It=Symbol("color"),Ae=Symbol("radius"),Te=Symbol("length"),Ce=Symbol("opacity"),nn=Symbol("symbol"),Ko=Symbol("projection"),K=new Map([["x",bt],["y",bt],["fx",bt],["fy",bt],["r",Ae],["color",It],["opacity",Ce],["symbol",nn],["length",Te],["projection",Ko]]);function gf(t){return t===bt||t===Ko}function yf(t){return t===bt||t===Ae||t===Te||t===Ce}const bf=Math.sqrt(3),wf=2/bf,xf={draw(t,e){const n=Math.sqrt(e/Math.PI),r=n*wf,i=r/2;t.moveTo(0,r),t.lineTo(n,i),t.lineTo(n,-i),t.lineTo(0,-r),t.lineTo(-n,-i),t.lineTo(-n,i),t.closePath()}},Uo=new Map([["asterisk",Hs],["circle",_s],["cross",Gs],["diamond",Ks],["diamond2",Us],["hexagon",xf],["plus",Ys],["square",Xs],["square2",Zs],["star",Js],["times",Qs],["triangle",tu],["triangle2",eu],["wye",nu]]);function Yo(t){return t&&typeof t.draw=="function"}function $f(t){return Yo(t)?!0:typeof t!="string"?!1:Uo.has(t.toLowerCase())}function ur(t){if(t==null||Yo(t))return t;const e=Uo.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid symbol: ${t}`)}function Xo({filter:t,sort:e,reverse:n,transform:r,initializer:i,...o}={},a){if(r===void 0&&(t!=null&&(r=Zo(t)),e!=null&&!pe(e)&&(r=mn(r,Qo(e))),n&&(r=mn(r,Jo))),a!=null&&i!=null)throw new Error("transforms cannot be applied after initializers");return{...o,...(e===null||pe(e))&&{sort:e},transform:mn(r,a)}}function Ue({filter:t,sort:e,reverse:n,initializer:r,...i}={},o){return r===void 0&&(t!=null&&(r=Zo(t)),e!=null&&!pe(e)&&(r=pn(r,Qo(e))),n&&(r=pn(r,Jo))),{...i,...(e===null||pe(e))&&{sort:e},initializer:pn(r,o)}}function mn(t,e){return t==null?e===null?void 0:e:e==null?t===null?void 0:t:function(n,r,i){return{data:n,facets:r}=t.call(this,n,r,i),e.call(this,ie(n),r,i)}}function pn(t,e){return t==null?e===null?void 0:e:e==null?t===null?void 0:t:function(n,r,i,...o){let a,s,u,f,l,c;return{data:s=n,facets:u=r,channels:a}=t.call(this,n,r,i,...o),{data:l=s,facets:c=u,channels:f}=e.call(this,s,u,{...i,...a},...o),{data:l,facets:c,channels:{...a,...f}}}}function Zo(t){return(e,n)=>{const r=ft(e,t);return{data:e,facets:n.map(i=>i.filter(o=>r[o]))}}}function Jo(t,e){return{data:t,facets:e.map(n=>n.slice().reverse())}}function Qo(t){return(typeof t=="function"&&t.length!==1?vf:Mf)(t)}function vf(t){return(e,n)=>{const r=Gt(e)?(i,o)=>t(e[i],e[o]):(i,o)=>t(e.get(i),e.get(o));return{data:e,facets:n.map(i=>i.slice().sort(r))}}}function Mf(t){let e,n;({channel:e,value:t,order:n}={...tn(t)});const r=e?.startsWith("-");if(r&&(e=e.slice(1)),n===void 0&&(n=r?Ke:wt),typeof n!="function")switch(`${n}`.toLowerCase()){case"ascending":n=wt;break;case"descending":n=Ke;break;default:throw new Error(`invalid order: ${n}`)}return(i,o,a)=>{let s;if(e===void 0)s=ft(i,t);else{if(a===void 0)throw new Error("channel sort requires an initializer");if(s=a[e],!s)return{};s=s.value}const u=(f,l)=>n(s[f],s[l]);return{data:i,facets:o.map(f=>f.slice().sort(u))}}}function Sf(t,e,n=Af){if(t==null)return n(t);if(typeof t.reduceIndex=="function")return t;if(typeof t.reduce=="function"&&Ut(t))return Tf(t);if(typeof t=="function")return Cf(t);if(/^p\d{2}$/i.test(t))return At(Gl(t));switch(`${t}`.toLowerCase()){case"first":return Ef;case"last":return Lf;case"identity":return If;case"count":return jr;case"distinct":return Df;case"sum":return e==null?jr:Nf;case"proportion":return qr(e,"data");case"proportion-facet":return qr(e,"facet");case"deviation":return At(uu);case"min":return At(zt);case"min-index":return At(su);case"max":return At(Ct);case"max-index":return At(au);case"mean":return Br(ou);case"median":return Br(Dn);case"variance":return At(iu);case"mode":return At(ru)}return n(t)}function Af(t){throw new Error(`invalid reduce: ${t}`)}function Tf(t){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...t,reduceIndex:t.reduce.bind(t)}}function Cf(t){return{reduceIndex(e,n,r){return t(or(n,e),r)}}}function At(t){return{reduceIndex(e,n){return t(e,r=>n[r])}}}function Br(t){return{reduceIndex(e,n){const r=t(e,i=>n[i]);return ct(n)?new Date(r):r}}}const If={reduceIndex(t,e){return or(e,t)}},Ef={reduceIndex(t,e){return e[t[0]]}},Lf={reduceIndex(t,e){return e[t[t.length-1]]}},jr={label:"Frequency",reduceIndex(t){return t.length}},Df={label:"Distinct",reduceIndex(t,e){const n=new Je;for(const r of t)n.add(e[r]);return n.size}},Nf=At(Pt);function qr(t,e){return t==null?{scope:e,label:"Frequency",reduceIndex:(n,r,i=1)=>n.length/i}:{scope:e,reduceIndex:(n,r,i=1)=>Pt(n,o=>r[o])/i}}function be(t,{scale:e,type:n,value:r,filter:i,hint:o,label:a=Me(r)},s){return o===void 0&&typeof r?.transform=="function"&&(o=r.hint),ta(s,{scale:e,type:n,value:ft(t,r),label:a,filter:i,hint:o})}function kf(t,e){return Object.fromEntries(Object.entries(t).map(([n,r])=>[n,be(e,r,n)]))}function Of(t,e){const n=Object.fromEntries(Object.entries(t).map(([r,{scale:i,value:o}])=>{const a=i==null?null:e[i];return[r,a==null?o:U(o,a)]}));return n.channels=t,n}function ta(t,e){const{scale:n,value:r}=e;if(n===!0||n==="auto")switch(t){case"fill":case"stroke":case"color":e.scale=n!==!0&&hn(r,en)?null:"color",e.defaultScale="color";break;case"fillOpacity":case"strokeOpacity":case"opacity":e.scale=n!==!0&&hn(r,cf)?null:"opacity",e.defaultScale="opacity";break;case"symbol":n!==!0&&hn(r,$f)?(e.scale=null,e.value=U(r,ur)):e.scale="symbol",e.defaultScale="symbol";break;default:e.scale=K.has(t)?t:null;break}else if(n===!1)e.scale=null;else if(n!=null&&!K.has(n))throw new Error(`unknown scale: ${n}`);return e}function Ff(t,e,n,r,i){const{order:o,reverse:a,reduce:s=!0,limit:u}=i;for(const f in i){if(!K.has(f))continue;let{value:l,order:c=o,reverse:d=a,reduce:h=s,limit:p=u}=tn(i[f]);const m=l?.startsWith("-");if(m&&(l=l.slice(1)),c=c===void 0?m!==(l==="width"||l==="height")?na:ea:jf(c),h==null||h===!1)continue;const w=f==="fx"||f==="fy"?Bf(e,r[f]):Rf(n,f);if(!w)throw new Error(`missing channel for scale: ${f}`);const b=w.value,[g=0,$=1/0]=Yt(p)?p:p<0?[p]:[0,p];if(l==null)w.domain=()=>{let y=Array.from(new Je(b));return d&&(y=y.reverse()),(g!==0||$!==1/0)&&(y=y.slice(g,$)),y};else{const y=l==="data"?t:l==="height"?Wr(n,"y1","y2"):l==="width"?Wr(n,"x1","x2"):Bn(n,l,l==="y"?"y2":l==="x"?"x2":void 0),M=Sf(h===!0?"max":h,y);w.domain=()=>{let E=lu(Ot(b),x=>M.reduceIndex(x,y),x=>b[x]);return c&&E.sort(c),d&&E.reverse(),(g!==0||$!==1/0)&&(E=E.slice(g,$)),E.map(Fo)}}}}function Rf(t,e){for(const n in t){const r=t[n];if(r.scale===e)return r}}function Bf(t,e){const n=t.original;if(n===t)return e;const r=e.value,i=e.value=[];for(let o=0;o<n.length;++o){const a=r[n[o][0]];for(const s of t[o])i[s]=a}return e}function Wr(t,e,n){const r=Bn(t,e),i=Bn(t,n);return U(i,(o,a)=>Math.abs(o-r[a]),Float64Array)}function Bn(t,e,n){let r=t[e];if(!r&&n!==void 0&&(r=t[n]),r)return r.value;throw new Error(`missing channel: ${e}`)}function jf(t){if(t==null||typeof t=="function")return t;switch(`${t}`.toLowerCase()){case"ascending":return ea;case"descending":return na}throw new Error(`invalid order: ${t}`)}function ea([t,e],[n,r]){return wt(e,r)||wt(t,n)}function na([t,e],[n,r]){return Ke(e,r)||wt(t,n)}function Pr(t,e){let n=t[e];if(n){for(;n.source;)n=n.source;return n.source===null?null:n}}const ra=new Map([["accent",fu],["category10",Dl],["dark2",cu],["observable10",du],["paired",hu],["pastel1",mu],["pastel2",pu],["set1",gu],["set2",yu],["set3",bu],["tableau10",wu]]);function qf(t){return t!=null&&ra.has(`${t}`.toLowerCase())}const zr=new Map([...ra,["brbg",vt(xu,Ri)],["prgn",vt($u,Bi)],["piyg",vt(vu,ji)],["puor",vt(Mu,qi)],["rdbu",vt(Ir,Ve)],["rdgy",vt(Su,Wi)],["rdylbu",vt(Er,He)],["rdylgn",vt(Au,Pi)],["spectral",vt(Tu,zi)],["burd",Vr(Ir,Ve)],["buylrd",Vr(Er,He)],["blues",X(Cu,Vi)],["greens",X(Iu,Hi)],["greys",X(Eu,_i)],["oranges",X(Lu,Ui)],["purples",X(Du,Gi)],["reds",X(Nu,Ki)],["turbo",Mt(Yi)],["viridis",Mt(Xi)],["magma",Mt(Zi)],["inferno",Mt(Ji)],["plasma",Mt(Qi)],["cividis",Mt(to)],["cubehelix",Mt(eo)],["warm",Mt(yo)],["cool",Mt(bo)],["bugn",X(ku,no)],["bupu",X(Ou,ro)],["gnbu",X(Fu,io)],["orrd",X(Ru,oo)],["pubu",X(Bu,so)],["pubugn",X(ju,ao)],["purd",X(qu,uo)],["rdpu",X(Wu,lo)],["ylgn",X(Pu,co)],["ylgnbu",X(zu,fo)],["ylorbr",X(Vu,ho)],["ylorrd",X(Hu,mo)],["rainbow",Hr(wo)],["sinebow",Hr(po)]]);function X(t,e){return({length:n})=>n===1?[t[3][1]]:n===2?[t[3][1],t[3][2]]:(n=Math.max(3,Math.floor(n)),n>9?pt(e,n):t[n])}function vt(t,e){return({length:n})=>n===2?[t[3][0],t[3][2]]:(n=Math.max(3,Math.floor(n)),n>11?pt(e,n):t[n])}function Vr(t,e){return({length:n})=>n===2?[t[3][2],t[3][0]]:(n=Math.max(3,Math.floor(n)),n>11?pt(r=>e(1-r),n):t[n].slice().reverse())}function Mt(t){return({length:e})=>pt(t,Math.max(2,Math.floor(e)))}function Hr(t){return({length:e})=>pt(t,Math.floor(e)+1).slice(0,-1)}function ia(t){const e=`${t}`.toLowerCase();if(!zr.has(e))throw new Error(`unknown ordinal scheme: ${e}`);return zr.get(e)}function rn(t,e){const n=ia(t),r=typeof n=="function"?n({length:e}):n;return r.length!==e?r.slice(0,e):r}function Wf(t,e="greys"){const n=new Set,[r,i]=rn(e,2);for(const o of t)if(o!=null)if(o===!0)n.add(i);else if(o===!1)n.add(r);else return;return[...n]}const _r=new Map([["brbg",Ri],["prgn",Bi],["piyg",ji],["puor",qi],["rdbu",Ve],["rdgy",Wi],["rdylbu",He],["rdylgn",Pi],["spectral",zi],["burd",t=>Ve(1-t)],["buylrd",t=>He(1-t)],["blues",Vi],["greens",Hi],["greys",_i],["purples",Gi],["reds",Ki],["oranges",Ui],["turbo",Yi],["viridis",Xi],["magma",Zi],["inferno",Ji],["plasma",Qi],["cividis",to],["cubehelix",eo],["warm",yo],["cool",bo],["bugn",no],["bupu",ro],["gnbu",io],["orrd",oo],["pubugn",ao],["pubu",so],["purd",uo],["rdpu",lo],["ylgnbu",fo],["ylgn",co],["ylorbr",ho],["ylorrd",mo],["rainbow",wo],["sinebow",po]]);function lr(t){const e=`${t}`.toLowerCase();if(!_r.has(e))throw new Error(`unknown quantitative scheme: ${e}`);return _r.get(e)}const Pf=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function zf(t){return t!=null&&Pf.has(`${t}`.toLowerCase())}const oa=t=>e=>t(1-e),gn=[0,1],Gr=new Map([["number",$e],["rgb",_n],["hsl",Zu],["hcl",Ju],["lab",Qu]]);function aa(t){const e=`${t}`.toLowerCase();if(!Gr.has(e))throw new Error(`unknown interpolator: ${e}`);return Gr.get(e)}function Ie(t,e,n,{type:r,nice:i,clamp:o,zero:a,domain:s=ua(t,n),unknown:u,round:f,scheme:l,interval:c,range:d=K.get(t)===Ae?Qf(n,s):K.get(t)===Te?tc(n,s):K.get(t)===Ce?gn:void 0,interpolate:h=K.get(t)===It?l==null&&d!==void 0?_n:lr(l!==void 0?l:r==="cyclical"?"rainbow":"turbo"):f?Is:$e,reverse:p}){if(s=Kr(s),c=Se(c,r),(r==="cyclical"||r==="sequential")&&(r="linear"),typeof h!="function"&&(h=aa(h)),p=!!p,d!==void 0){const m=s.length,w=(d=Kr(d)).length;if(m!==w){if(h.length===1)throw new Error("invalid piecewise interpolator");h=Kn(h,d),d=void 0}}if(h.length===1?(p&&(h=oa(h),p=!1),d===void 0&&(d=Float64Array.from(s,(m,w)=>w/(s.length-1)),d.length===2&&(d=gn)),e.interpolate((d===gn?Tt:cr)(h))):e.interpolate(h),a){const[m,w]=Nt(s);(m>0||w<0)&&(s=me(s),(re(s)||1)===Math.sign(m)?s[0]=0:s[s.length-1]=0)}return p&&(s=Ge(s)),e.domain(s).unknown(u),i&&(e.nice(Vf(i,r)),s=e.domain()),d!==void 0&&e.range(d),o&&e.clamp(o),{type:r,domain:s,range:d,scale:e,interpolate:h,interval:c}}function Kr(t){return t=Kt(t),t.length>=2?t:[t[0],t[0]]}function Vf(t,e){return t===!0?void 0:typeof t=="number"?t:rf(t,e)}function Hf(t,e,n){return Ie(t,Ai(),e,n)}function _f(t,e,n){return sa(t,e,{...n,exponent:.5})}function sa(t,e,{exponent:n=1,...r}){return Ie(t,Uu().exponent(n),e,{...r,type:"pow"})}function Gf(t,e,{base:n=10,domain:r=ec(e),...i}){return Ie(t,Ku().base(n),e,{...i,domain:r})}function Kf(t,e,{constant:n=1,...r}){return Ie(t,Gu().constant(n),e,r)}function Uf(t,e,{range:n,quantiles:r=n===void 0?5:(n=[...n]).length,n:i=r,scheme:o="rdylbu",domain:a=nc(e),unknown:s,interpolate:u,reverse:f}){return n===void 0&&(n=u!==void 0?pt(u,i):K.get(t)===It?rn(o,i):void 0),a.length>0&&(a=Yu(a,n===void 0?{length:i}:n).quantiles()),fr(t,e,{domain:a,range:n,reverse:f,unknown:s})}function Yf(t,e,{range:n,n:r=n===void 0?5:(n=[...n]).length,scheme:i="rdylbu",domain:o=ua(t,e),unknown:a,interpolate:s,reverse:u}){const[f,l]=Nt(o);let c;return n===void 0?(c=Cs(f,l,r),c[0]<=f&&c.splice(0,1),c[c.length-1]>=l&&c.pop(),r=c.length+1,n=s!==void 0?pt(s,r):K.get(t)===It?rn(i,r):void 0):(c=pt($e(f,l),r+1).slice(1,-1),f instanceof Date&&(c=c.map(d=>new Date(d)))),re(Kt(o))<0&&c.reverse(),fr(t,e,{domain:c,range:n,reverse:u,unknown:a})}function fr(t,e,{domain:n=[0],unknown:r,scheme:i="rdylbu",interpolate:o,range:a=o!==void 0?pt(o,n.length+1):K.get(t)===It?rn(i,n.length+1):void 0,reverse:s}){n=Kt(n);const u=re(n);if(!isNaN(u)&&!Xf(n,u))throw new Error(`the ${t} scale has a non-monotonic domain`);return s&&(a=Ge(a)),{type:"threshold",scale:Xu(u<0?Ge(n):n,a===void 0?[]:a).unknown(r),domain:n,range:a}}function Xf(t,e){for(let n=1,r=t.length,i=t[0];n<r;++n){const o=Xe(i,i=t[n]);if(o!==0&&o!==e)return!1}return!0}function Zf(t){return{type:"identity",scale:yf(K.get(t))?_u():e=>e}}function we(t,e=Mo){return t.length?[zt(t,({value:n})=>n===void 0?n:zt(n,e)),Ct(t,({value:n})=>n===void 0?n:Ct(n,e))]:[0,1]}function ua(t,e){const n=K.get(t);return(n===Ae||n===Ce||n===Te?Jf:we)(e)}function Jf(t){return[0,t.length?Ct(t,({value:e})=>e===void 0?e:Ct(e,Mo)):1]}function Qf(t,e){const n=t.find(({radius:a})=>a!==void 0);if(n!==void 0)return[0,n.radius];const r=Ln(t,.5,({value:a})=>a===void 0?NaN:Ln(a,.25,Jn)),i=e.map(a=>3*Math.sqrt(a/r)),o=30/Ct(i);return o<1?i.map(a=>a*o):i}function tc(t,e){const n=Dn(t,({value:o})=>o===void 0?NaN:Dn(o,Math.abs)),r=e.map(o=>12*o/n),i=60/Ct(r);return i<1?r.map(o=>o*i):r}function ec(t){for(const{value:e}of t)if(e!==void 0)for(let n of e){if(n>0)return we(t,Jn);if(n<0)return we(t,So)}return[1,10]}function nc(t){const e=[];for(const{value:n}of t)if(n!==void 0)for(const r of n)e.push(r);return e}function cr(t){return(e,n)=>r=>t(e+r*(n-e))}let jn=0,qn;function rc(){const t=jn;return jn=0,qn=void 0,t}function Wt(t){t!==qn&&(qn=t,console.warn(t),++jn)}function on(t,e,n,r,{type:i,nice:o,clamp:a,domain:s=we(r),unknown:u,pivot:f=0,scheme:l,range:c,symmetric:d=!0,interpolate:h=K.get(t)===It?l==null&&c!==void 0?_n:lr(l!==void 0?l:"rdbu"):$e,reverse:p}){f=+f,s=Kt(s);let[m,w]=s;if(s.length>2&&Wt(`Warning: the diverging ${t} scale domain contains extra elements.`),Xe(m,w)<0&&([m,w]=[w,m],p=!p),m=Math.min(m,f),w=Math.max(w,f),typeof h!="function"&&(h=aa(h)),c!==void 0&&(h=h.length===1?cr(h)(...c):Kn(h,c)),p&&(h=oa(h)),d){const b=n.apply(f),g=b-n.apply(m),$=n.apply(w)-b;g<$?m=n.invert(b-$):g>$&&(w=n.invert(b+g))}return e.domain([m,f,w]).unknown(u).interpolator(h),a&&e.clamp(a),o&&e.nice(o),{type:i,domain:[m,w],pivot:f,interpolate:h,scale:e}}function ic(t,e,n){return on(t,rl(),uc,e,n)}function oc(t,e,n){return la(t,e,{...n,exponent:.5})}function la(t,e,{exponent:n=1,...r}){return on(t,nl().exponent(n=+n),cc(n),e,{...r,type:"diverging-pow"})}function ac(t,e,{base:n=10,pivot:r=1,domain:i=we(e,r<0?So:Jn),...o}){return on(t,el().base(n=+n),lc,e,{domain:i,pivot:r,...o})}function sc(t,e,{constant:n=1,...r}){return on(t,tl().constant(n=+n),dc(n),e,r)}const uc={apply(t){return t},invert(t){return t}},lc={apply:Math.log,invert:Math.exp},fc={apply(t){return Math.sign(t)*Math.sqrt(Math.abs(t))},invert(t){return Math.sign(t)*(t*t)}};function cc(t){return t===.5?fc:{apply(e){return Math.sign(e)*Math.pow(Math.abs(e),t)},invert(e){return Math.sign(e)*Math.pow(Math.abs(e),1/t)}}}function dc(t){return{apply(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))},invert(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}}function fa(t,e,n,r){return Ie(t,e,n,r)}function hc(t,e,n){return fa(t,il(),e,n)}function mc(t,e,n){return fa(t,ol(),e,n)}const Ee=Symbol("ordinal");function ca(t,e,n,{type:r,interval:i,domain:o,range:a,reverse:s,hint:u}){return i=Se(i,r),o===void 0&&(o=ha(n,i,t)),(r==="categorical"||r===Ee)&&(r="ordinal"),s&&(o=Ge(o)),o=e.domain(o).domain(),a!==void 0&&(typeof a=="function"&&(a=a(o)),e.range(a)),{type:r,domain:o,range:a,scale:e,hint:u,interval:i}}function pc(t,e,{type:n,interval:r,domain:i,range:o,scheme:a,unknown:s,...u}){r=Se(r,n),i===void 0&&(i=ha(e,r,t));let f;if(K.get(t)===nn)f=bc(e),o=o===void 0?wc(f):U(o,ur);else if(K.get(t)===It&&(o===void 0&&(n==="ordinal"||n===Ee)&&(o=Wf(i,a),o!==void 0&&(a=void 0)),a===void 0&&o===void 0&&(a=n==="ordinal"?"turbo":"observable10"),a!==void 0))if(o!==void 0){const l=lr(a),c=o[0],d=o[1]-o[0];o=({length:h})=>pt(p=>l(c+d*p),h)}else o=ia(a);if(s===El)throw new Error(`implicit unknown on ${t} scale is not supported`);return ca(t,Ll().unknown(s),e,{...u,type:n,domain:i,range:o,hint:f})}function gc(t,e,{align:n=.5,padding:r=.5,...i}){return da(al().align(n).padding(r),e,i,t)}function yc(t,e,{align:n=.5,padding:r=.1,paddingInner:i=r,paddingOuter:o=t==="fx"||t==="fy"?0:r,...a}){return da(go().align(n).paddingInner(i).paddingOuter(o),e,a,t)}function da(t,e,n,r){let{round:i}=n;return i!==void 0&&t.round(i=!!i),t=ca(r,t,e,n),t.round=i,t}function ha(t,e,n){const r=new Je;for(const{value:i,domain:o}of t){if(o!==void 0)return o();if(i!==void 0)for(const a of i)r.add(a)}if(e!==void 0){const[i,o]=Nt(r).map(e.floor,e);return e.range(i,e.offset(o))}if(r.size>1e4&&K.get(n)===bt)throw new Error(`implicit ordinal domain of ${n} scale has more than 10,000 values`);return sl(r,wt)}function Ur(t,e){let n;for(const{hint:r}of t){const i=r?.[e];if(i!==void 0){if(n===void 0)n=i;else if(n!==i)return}}return n}function bc(t){return{fill:Ur(t,"fill"),stroke:Ur(t,"stroke")}}function wc(t){return ot(t.fill)?ul:ll}function Wn(t,{label:e,inset:n=0,insetTop:r=n,insetRight:i=n,insetBottom:o=n,insetLeft:a=n,round:s,nice:u,clamp:f,zero:l,align:c,padding:d,projection:h,facet:{label:p=e}={},...m}={}){const w={};for(const[b,g]of t){const $=m[b],y=Sc(b,g,{round:K.get(b)===bt?s:void 0,nice:u,clamp:f,zero:l,align:c,padding:d,projection:h,...$});if(y){let{label:M=b==="fx"||b==="fy"?p:e,percent:E,transform:x,inset:v,insetTop:S=v!==void 0?v:b==="y"?r:0,insetRight:C=v!==void 0?v:b==="x"?i:0,insetBottom:A=v!==void 0?v:b==="y"?o:0,insetLeft:O=v!==void 0?v:b==="x"?a:0}=$||{};if(x==null)x=void 0;else if(typeof x!="function")throw new Error("invalid scale transform; not a function");y.percent=!!E,y.label=M===void 0?$c(g,y):M,y.transform=x,b==="x"||b==="fx"?(y.insetLeft=+O,y.insetRight=+C):(b==="y"||b==="fy")&&(y.insetTop=+S,y.insetBottom=+A),w[b]=y}}return w}function Yr(t){const e={},n={scales:e};for(const[r,i]of Object.entries(t)){const{scale:o,type:a,interval:s,label:u}=i;e[r]=Ec(i),n[r]=o,o.type=a,s!=null&&(o.interval=s),u!=null&&(o.label=u)}return n}function xc(t,e){const{x:n,y:r,fx:i,fy:o}=t,a=i||o?dr(e):e;i&&Xr(i,a),o&&Zr(o,a);const s=i||o?ma(t,e):e;n&&Xr(n,s),r&&Zr(r,s)}function $c(t=[],e){let n;for(const{label:r}of t)if(r!==void 0){if(n===void 0)n=r;else if(n!==r)return}if(n!==void 0)return!Xt(e)&&e.percent&&(n=`${n} (%)`),{inferred:!0,toString:()=>n}}function vc(t){return Math.sign(re(t.domain()))*Math.sign(re(t.range()))}function dr(t){const{marginTop:e,marginRight:n,marginBottom:r,marginLeft:i,width:o,height:a,facet:{marginTop:s,marginRight:u,marginBottom:f,marginLeft:l}}=t;return{marginTop:Math.max(e,s),marginRight:Math.max(n,u),marginBottom:Math.max(r,f),marginLeft:Math.max(i,l),width:o,height:a}}function ma({fx:t,fy:e},n){const{marginTop:r,marginRight:i,marginBottom:o,marginLeft:a,width:s,height:u}=dr(n);return{marginTop:r,marginRight:i,marginBottom:o,marginLeft:a,width:t?t.scale.bandwidth()+a+i:s,height:e?e.scale.bandwidth()+r+o:u,facet:{width:s,height:u}}}function Xr(t,e){if(t.range===void 0){const{insetLeft:n,insetRight:r}=t,{width:i,marginLeft:o=0,marginRight:a=0}=e,s=o+n,u=i-a-r;t.range=[s,Math.max(s,u)],Xt(t)||(t.range=ga(t)),t.scale.range(t.range)}pa(t)}function Zr(t,e){if(t.range===void 0){const{insetTop:n,insetBottom:r}=t,{height:i,marginTop:o=0,marginBottom:a=0}=e,s=o+n,u=i-a-r;t.range=[Math.max(s,u),s],Xt(t)?t.range.reverse():t.range=ga(t),t.scale.range(t.range)}pa(t)}function pa(t){t.round===void 0&&Tc(t)&&Mc(t)<=30&&t.scale.round(!0)}function Mc({scale:t}){const e=t.domain().length,[n,r]=t.range(),i=t.paddingInner?t.paddingInner():1,o=t.paddingOuter?t.paddingOuter():t.padding(),a=e-i,s=Math.abs(r-n)/Math.max(1,a+o*2);return(s-Math.floor(s))*a}function ga(t){const e=t.scale.domain().length+ya(t);if(!(e>2))return t.range;const[n,r]=t.range;return Array.from({length:e},(i,o)=>n+o/(e-1)*(r-n))}function Sc(t,e=[],n={}){const r=Ac(t,e,n);if(n.type===void 0&&n.domain===void 0&&n.range===void 0&&n.interval==null&&t!=="fx"&&t!=="fy"&&Xt({type:r})){const i=e.map(({value:o})=>o).filter(o=>o!==void 0);i.some(ct)?Wt(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${te(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${te(r)}".`):i.some(sf)?Wt(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${te(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${te(r)}".`):i.some(uf)&&Wt(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${te(r)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${te(r)}".`)}switch(n.type=r,r){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":n=De(e,n,Fr);break;case"identity":switch(K.get(t)){case bt:n=De(e,n,Fr);break;case nn:n=De(e,n,Cc);break}break;case"utc":case"time":n=De(e,n,Ro);break}switch(r){case"diverging":return ic(t,e,n);case"diverging-sqrt":return oc(t,e,n);case"diverging-pow":return la(t,e,n);case"diverging-log":return ac(t,e,n);case"diverging-symlog":return sc(t,e,n);case"categorical":case"ordinal":case Ee:return pc(t,e,n);case"cyclical":case"sequential":case"linear":return Hf(t,e,n);case"sqrt":return _f(t,e,n);case"threshold":return fr(t,e,n);case"quantile":return Uf(t,e,n);case"quantize":return Yf(t,e,n);case"pow":return sa(t,e,n);case"log":return Gf(t,e,n);case"symlog":return Kf(t,e,n);case"utc":return mc(t,e,n);case"time":return hc(t,e,n);case"point":return gc(t,e,n);case"band":return yc(t,e,n);case"identity":return Zf(t);case void 0:return;default:throw new Error(`unknown scale type: ${r}`)}}function te(t){return typeof t=="symbol"?t.description:t}function Jr(t){return typeof t=="string"?`${t}`.toLowerCase():t}const Qr={toString:()=>"projection"};function Ac(t,e,{type:n,domain:r,range:i,scheme:o,pivot:a,projection:s}){if(n=Jr(n),t==="fx"||t==="fy")return"band";(t==="x"||t==="y")&&s!=null&&(n=Qr);for(const l of e){const c=Jr(l.type);if(c!==void 0){if(n===void 0)n=c;else if(n!==c)throw new Error(`scale incompatible with channel: ${n} !== ${c}`)}}if(n===Qr)return;if(n!==void 0)return n;if(r===void 0&&!e.some(({value:l})=>l!==void 0))return;const u=K.get(t);if(u===Ae)return"sqrt";if(u===Ce||u===Te)return"linear";if(u===nn)return"ordinal";const f=(r??i)?.length;if(f<2||f>2)return yn(u);if(r!==void 0){if(Rr(r))return yn(u);if(ct(r))return"utc"}else{const l=e.map(({value:c})=>c).filter(c=>c!==void 0);if(l.some(Rr))return yn(u);if(l.some(ct))return"utc"}if(u===It){if(a!=null||zf(o))return"diverging";if(qf(o))return"categorical"}return"linear"}function yn(t){switch(t){case bt:return"point";case It:return Ee;default:return"ordinal"}}function Xt({type:t}){return t==="ordinal"||t==="point"||t==="band"||t===Ee}function ya({type:t}){return t==="threshold"}function Tc({type:t}){return t==="point"||t==="band"}function oe(t){if(t===void 0)return!0;const e=t.domain(),n=t(e[0]);for(let r=1,i=e.length;r<i;++r)if(t(e[r])-n)return!1;return!0}function De(t,{domain:e,...n},r){for(const i of t)i.value!==void 0&&(e===void 0&&(e=i.value?.domain),i.value=r(i.value));return{domain:e===void 0?e:r(e),...n}}function Cc(t){return U(t,ur)}function Ic(t){return e=>{if(!K.has(e=`${e}`))throw new Error(`unknown scale: ${e}`);return t[e]}}function Ec({scale:t,type:e,domain:n,range:r,interpolate:i,interval:o,transform:a,percent:s,pivot:u}){if(e==="identity")return{type:"identity",apply:l=>l,invert:l=>l};const f=t.unknown?t.unknown():void 0;return{type:e,domain:me(n),...r!==void 0&&{range:me(r)},...a!==void 0&&{transform:a},...s&&{percent:s},...f!==void 0&&{unknown:f},...o!==void 0&&{interval:o},...i!==void 0&&{interpolate:i},...t.clamp&&{clamp:t.clamp()},...u!==void 0&&{pivot:u,symmetric:!1},...t.base&&{base:t.base()},...t.exponent&&{exponent:t.exponent()},...t.constant&&{constant:t.constant()},...t.align&&{align:t.align(),round:t.round()},...t.padding&&(t.paddingInner?{paddingInner:t.paddingInner(),paddingOuter:t.paddingOuter()}:{padding:t.padding()}),...t.bandwidth&&{bandwidth:t.bandwidth(),step:t.step()},apply:l=>t(l),...t.invert&&{invert:l=>t.invert(l)}}}function Lc(t,e){const{fx:n,fy:r}=Wn(t,e),i=n?.scale.domain(),o=r?.scale.domain();return i&&o?fl(i,o).map(([a,s],u)=>({x:a,y:s,i:u})):i?i.map((a,s)=>({x:a,i:s})):o?o.map((a,s)=>({y:a,i:s})):void 0}function Dc(t,{x:e,y:n}){return e&&=Pn(e),n&&=Pn(n),t.filter(e&&n?r=>e.has(r.x)&&n.has(r.y):e?r=>e.has(r.x):r=>n.has(r.y)).sort(e&&n?(r,i)=>e.get(r.x)-e.get(i.x)||n.get(r.y)-n.get(i.y):e?(r,i)=>e.get(r.x)-e.get(i.x):(r,i)=>n.get(r.y)-n.get(i.y))}function hr(t,{fx:e,fy:n}){const r=Ot(t),i=e?.value,o=n?.value;return e&&n?qe(r,a=>(a.fx=i[a[0]],a.fy=o[a[0]],a),a=>i[a],a=>o[a]):e?qe(r,a=>(a.fx=i[a[0]],a),a=>i[a]):qe(r,a=>(a.fy=o[a[0]],a),a=>o[a])}function Nc(t,e,{marginTop:n,marginLeft:r}){const i=t?({x:a})=>t(a)-r:()=>0,o=e?({y:a})=>e(a)-n:()=>0;return function(a){this.tagName==="svg"?(this.setAttribute("x",i(a)),this.setAttribute("y",o(a))):this.setAttribute("transform",`translate(${i(a)},${o(a)})`)}}function kc(t){const e=[],n=new Uint32Array(Pt(t,r=>r.length));for(const r of t){let i=0;for(const o of t)r!==o&&(n.set(o,i),i+=o.length);e.push(n.slice(0,i))}return e}const Oc=new Map([["top",bn],["right",$n],["bottom",wn],["left",xn],["top-left",Ne(bn,xn)],["top-right",Ne(bn,$n)],["bottom-left",Ne(wn,xn)],["bottom-right",Ne(wn,$n)],["top-empty",Bc],["right-empty",Wc],["bottom-empty",jc],["left-empty",qc],["empty",Pc]]);function Fc(t){if(t==null)return null;const e=Oc.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid facet anchor: ${t}`)}const ti=new WeakMap;function Pn(t){let e=ti.get(t);return e||ti.set(t,e=new Xn(U(t,(n,r)=>[n,r]))),e}function Ft(t,e){return Pn(t).get(e)}function Rc(t,e,n){return e=Le(e),n=Le(n),t.find(r=>Object.is(Le(r.x),e)&&Object.is(Le(r.y),n))}function an(t,e,n){return Rc(t,e,n)?.empty}function bn(t,{y:e},{y:n}){return e?Ft(e,n)===0:!0}function wn(t,{y:e},{y:n}){return e?Ft(e,n)===e.length-1:!0}function xn(t,{x:e},{x:n}){return e?Ft(e,n)===0:!0}function $n(t,{x:e},{x:n}){return e?Ft(e,n)===e.length-1:!0}function Bc(t,{y:e},{x:n,y:r,empty:i}){if(i)return!1;if(!e)return;const o=Ft(e,r);if(o>0)return an(t,n,e[o-1])}function jc(t,{y:e},{x:n,y:r,empty:i}){if(i)return!1;if(!e)return;const o=Ft(e,r);if(o<e.length-1)return an(t,n,e[o+1])}function qc(t,{x:e},{x:n,y:r,empty:i}){if(i)return!1;if(!e)return;const o=Ft(e,n);if(o>0)return an(t,e[o-1],r)}function Wc(t,{x:e},{x:n,y:r,empty:i}){if(i)return!1;if(!e)return;const o=Ft(e,n);if(o<e.length-1)return an(t,e[o+1],r)}function Pc(t,e,{empty:n}){return n}function Ne(t,e){return function(){return t.apply(null,arguments)&&e.apply(null,arguments)}}function vn(t,{channels:{fx:e,fy:n},groups:r}){return e&&n?t.map(({x:i,y:o})=>r.get(i)?.get(o)??[]):e?t.map(({x:i})=>r.get(i)??[]):t.map(({y:i})=>r.get(i)??[])}const ba=Math.PI,St=2*ba,Mn=.618;function zc({projection:t,inset:e=0,insetTop:n=e,insetRight:r=e,insetBottom:i=e,insetLeft:o=e}={},a){if(t==null)return;if(typeof t.stream=="function")return t;let s,u,f="frame";if(Ut(t)){let M;if({type:t,domain:u,inset:M,insetTop:n=M!==void 0?M:n,insetRight:r=M!==void 0?M:r,insetBottom:i=M!==void 0?M:i,insetLeft:o=M!==void 0?M:o,clip:f=f,...s}=t,t==null)return}typeof t!="function"&&({type:t}=zn(t));const{width:l,height:c,marginLeft:d,marginRight:h,marginTop:p,marginBottom:m}=a,w=l-d-h-o-r,b=c-p-m-n-i;if(t=t?.({width:w,height:b,clip:f,...s}),t==null)return;f=Vc(f,d,p,l-h,c-m);let g=d+o,$=p+n,y;if(u!=null){const[[M,E],[x,v]]=Un(t).bounds(u),S=Math.min(w/(x-M),b/(v-E));S>0?(g-=(S*(M+x)-w)/2,$-=(S*(E+v)-b)/2,y=_e({point(C,A){this.stream.point(C*S+g,A*S+$)}})):Wt("Warning: the projection could not be fit to the specified domain; using the default scale.")}return y??=g===0&&$===0?wa():_e({point(M,E){this.stream.point(M+g,E+$)}}),{stream:M=>t.stream(y.stream(f(M)))}}function zn(t){switch(`${t}`.toLowerCase()){case"albers-usa":return mt(Tl,.7463,.4673);case"albers":return ke(Al,.7463,.4673);case"azimuthal-equal-area":return mt(Sl,4,4);case"azimuthal-equidistant":return mt(Ml,St,St);case"conic-conformal":return ke(vl,St,St);case"conic-equal-area":return ke($l,6.1702,2.9781);case"conic-equidistant":return ke(xl,7.312,3.6282);case"equal-earth":return mt(wl,5.4133,2.6347);case"equirectangular":return mt(bl,St,ba);case"gnomonic":return mt(yl,3.4641,3.4641);case"identity":return{type:wa};case"reflect-y":return{type:Hc};case"mercator":return mt(gl,St,St);case"orthographic":return mt(pl,2,2);case"stereographic":return mt(ml,2,2);case"transverse-mercator":return mt(hl,St,St);default:throw new Error(`unknown projection type: ${t}`)}}function Vc(t,e,n,r,i){if(t===!1||t==null||typeof t=="number")return o=>o;switch(t===!0&&(t="frame"),`${t}`.toLowerCase()){case"frame":return dl(e,n,r,i);default:throw new Error(`unknown projection clip type: ${t}`)}}function mt(t,e,n){return{type:({width:r,height:i,rotate:o,precision:a=.15,clip:s})=>{const u=t();return a!=null&&u.precision?.(a),o!=null&&u.rotate?.(o),typeof s=="number"&&u.clipAngle?.(s),r!=null&&(u.scale(Math.min(r/e,i/n)),u.translate([r/2,i/2])),u},aspectRatio:n/e}}function ke(t,e,n){const{type:r,aspectRatio:i}=mt(t,e,n);return{type:o=>{const{parallels:a,domain:s,width:u,height:f}=o,l=r(o);return a!=null&&(l.parallels(a),s===void 0&&u!=null&&l.fitSize([u,f],{type:"Sphere"})),l},aspectRatio:i}}const wa=Tt({stream:t=>t}),Hc=Tt(_e({point(t,e){this.stream.point(t,-e)}}));function _c(t,e,n,r){const i=n[t],o=n[e],a=i.length,s=n[t]=new Float64Array(a).fill(NaN),u=n[e]=new Float64Array(a).fill(NaN);let f;const l=r.stream({point(c,d){s[f]=c,u[f]=d}});for(f=0;f<a;++f)l.point(i[f],o[f])}function Gc({projection:t}={}){return t==null?!1:typeof t.stream=="function"?!0:(Ut(t)&&(t=t.type),t!=null)}function Kc(t){if(typeof t?.stream=="function")return Mn;if(Ut(t)){let e,n;if({domain:e,type:t,...n}=t,e!=null&&t!=null){const r=typeof t=="string"?zn(t).type:t,[[i,o],[a,s]]=Un(r({...n,width:100,height:100})).bounds(e),u=(s-o)/(a-i);return u&&isFinite(u)?u<.2?.2:u>5?5:u:Mn}}if(t!=null){if(typeof t!="function"){const{aspectRatio:e}=zn(t);if(e)return e}return Mn}}function Uc(t){const e=[],n=[],r={scale:"x",value:e},i={scale:"y",value:n},o={point(a,s){e.push(a),n.push(s)},lineStart(){},lineEnd(){},polygonStart(){},polygonEnd(){},sphere(){}};for(const a of t.value)cl(a,o);return[r,i]}function Yc({x:t,y:e}){if(t||e)return t??=n=>n,e??=n=>n,_e({point(n,r){this.stream.point(t(n),e(r))}})}function mr(t={}){const{document:e=typeof window<"u"?window.document:void 0,clip:n}=t;return{document:e,clip:Ho(n)}}function rt(t,{document:e}){return jt(Si(t).call(e.documentElement))}const Xc=Symbol("unset");function pr(t){return(t.length===1?Zc:Jc)(t)}function Zc(t){let e,n=Xc;return r=>(Object.is(n,r)||(n=r,e=t(r)),e)}function Jc(t){let e,n;return(...r)=>((n?.length!==r.length||n.some((i,o)=>!Object.is(i,r[o])))&&(n=r,e=t(...r)),e)}const Qc=pr(t=>new Intl.NumberFormat(t));pr((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{month:e}}));pr((t,e)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...e&&{weekday:e}}));function td(t="en-US"){const e=Qc(t);return n=>n!=null&&!isNaN(n)?e.format(n):void 0}function ed(t){return Nl(t,"Invalid Date")}function nd(t="en-US"){const e=td(t);return n=>(n instanceof Date?ed:typeof n=="number"?e:et)(n)}const xe=nd(),st=(typeof window<"u"?window.devicePixelRatio>1:typeof it>"u")?0:.5;let rd=0;function xa(){return`plot-clip-${++rd}`}function id(t,{title:e,href:n,ariaLabel:r,ariaDescription:i,ariaHidden:o,target:a,fill:s,fillOpacity:u,stroke:f,strokeWidth:l,strokeOpacity:c,strokeLinejoin:d,strokeLinecap:h,strokeMiterlimit:p,strokeDasharray:m,strokeDashoffset:w,opacity:b,mixBlendMode:g,imageFilter:$,paintOrder:y,pointerEvents:M,shapeRendering:E,channels:x},{ariaLabel:v,fill:S="currentColor",fillOpacity:C,stroke:A="none",strokeOpacity:O,strokeWidth:G,strokeLinecap:B,strokeLinejoin:q,strokeMiterlimit:H,paintOrder:Z}){S===null&&(s=null,u=null),A===null&&(f=null,c=null),ot(S)?!ot(A)&&(!ot(s)||x?.fill)&&(A="none"):ot(A)&&(!ot(f)||x?.stroke)&&(S="none");const[z,T]=Ht(s,S),[L,N]=at(u,C),[k,D]=Ht(f,A),[W,V]=at(c,O),[j,I]=at(b);ye(D)||(l===void 0&&(l=G),h===void 0&&(h=B),d===void 0&&(d=q),p===void 0&&!df(d)&&(p=H),!ye(T)&&y===void 0&&(y=Z));const[P,R]=at(l);return S!==null&&(t.fill=Q(T,"currentColor"),t.fillOpacity=ce(N,1)),A!==null&&(t.stroke=Q(D,"none"),t.strokeWidth=ce(R,1),t.strokeOpacity=ce(V,1),t.strokeLinejoin=Q(d,"miter"),t.strokeLinecap=Q(h,"butt"),t.strokeMiterlimit=ce(p,4),t.strokeDasharray=Q(m,"none"),t.strokeDashoffset=Q(w,"0")),t.target=et(a),t.ariaLabel=et(v),t.ariaDescription=et(i),t.ariaHidden=et(o),t.opacity=ce(I,1),t.mixBlendMode=Q(g,"normal"),t.imageFilter=Q($,"none"),t.paintOrder=Q(y,"normal"),t.pointerEvents=Q(M,"auto"),t.shapeRendering=Q(E,"auto"),{title:{value:e,optional:!0,filter:null},href:{value:n,optional:!0,filter:null},ariaLabel:{value:r,optional:!0,filter:null},fill:{value:z,scale:"auto",optional:!0},fillOpacity:{value:L,scale:"auto",optional:!0},stroke:{value:k,scale:"auto",optional:!0},strokeOpacity:{value:W,scale:"auto",optional:!0},strokeWidth:{value:P,optional:!0},opacity:{value:j,scale:"auto",optional:!0}}}function od(t,e){e&&t.filter(n=>vo(e[n])).append("title").call(ad,e)}function ad(t,e){e&&t.text(n=>xe(e[n]))}function _t(t,{target:e,tip:n},{ariaLabel:r,title:i,fill:o,fillOpacity:a,stroke:s,strokeOpacity:u,strokeWidth:f,opacity:l,href:c}){r&&F(t,"aria-label",d=>r[d]),o&&F(t,"fill",d=>o[d]),a&&F(t,"fill-opacity",d=>a[d]),s&&F(t,"stroke",d=>s[d]),u&&F(t,"stroke-opacity",d=>u[d]),f&&F(t,"stroke-width",d=>f[d]),l&&F(t,"opacity",d=>l[d]),c&&dd(t,d=>c[d],e),n||od(t,i)}function sd(t,e,n,r){let i;const{clip:o=r.clip}=e;o==="frame"?(t=rt("svg:g",r).each(function(){this.appendChild(t.node()),t.node=()=>this}),i=ld(r,n)):o&&(i=cd(o,r)),F(t,"aria-label",e.ariaLabel),F(t,"aria-description",e.ariaDescription),F(t,"aria-hidden",e.ariaHidden),F(t,"clip-path",i)}function ud(t){const e=new WeakMap;return(n,r)=>{let i=e.get(n);if(!i){const o=xa();jt(n.ownerSVGElement).append("clipPath").attr("id",o).call(t,n,r),e.set(n,i=`url(#${o})`)}return i}}const ld=ud((t,e,n)=>{const{width:r,height:i,marginLeft:o,marginRight:a,marginTop:s,marginBottom:u}=n;t.append("rect").attr("x",o).attr("y",s).attr("width",r-a-o).attr("height",i-s-u)}),ei=new WeakMap,fd={type:"Sphere"};function cd(t,e){let n,r;if((n=ei.get(e))||ei.set(e,n=new WeakMap),t.type==="Sphere"&&(t=fd),!(r=n.get(t))){const i=xa();jt(e.ownerSVGElement).append("clipPath").attr("id",i).append("path").attr("d",e.path()(t)),n.set(t,r=`url(#${i})`)}return r}function Zt(t,e,n,r){sd(t,e,n,r),F(t,"class",e.className),F(t,"fill",e.fill),F(t,"fill-opacity",e.fillOpacity),F(t,"stroke",e.stroke),F(t,"stroke-width",e.strokeWidth),F(t,"stroke-opacity",e.strokeOpacity),F(t,"stroke-linejoin",e.strokeLinejoin),F(t,"stroke-linecap",e.strokeLinecap),F(t,"stroke-miterlimit",e.strokeMiterlimit),F(t,"stroke-dasharray",e.strokeDasharray),F(t,"stroke-dashoffset",e.strokeDashoffset),F(t,"shape-rendering",e.shapeRendering),F(t,"filter",e.imageFilter),F(t,"paint-order",e.paintOrder);const{pointerEvents:i=r.pointerSticky===!1?"none":void 0}=e;F(t,"pointer-events",i)}function kt(t,e){hd(t,"mix-blend-mode",e.mixBlendMode),F(t,"opacity",e.opacity)}function dd(t,e,n){t.each(function(r){const i=e(r);if(i!=null){const o=this.ownerDocument.createElementNS(ze.svg,"a");o.setAttribute("fill","inherit"),o.setAttributeNS(ze.xlink,"href",i),n!=null&&o.setAttribute("target",n),this.parentNode.insertBefore(o,this).appendChild(this)}})}function F(t,e,n){n!=null&&t.attr(e,n)}function hd(t,e,n){n!=null&&t.style(e,n)}function Jt(t,e,{x:n,y:r},i=st,o=st){i+=e.dx,o+=e.dy,n?.bandwidth&&(i+=n.bandwidth()/2),r?.bandwidth&&(o+=r.bandwidth()/2),(i||o)&&t.attr("transform",`translate(${i},${o})`)}function Q(t,e){if((t=et(t))!==e)return t}function ce(t,e){if((t=nt(t))!==e)return t}const md=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function gr(t){if(t===void 0)return"plot-d6a7b5";if(t=`${t}`,!md.test(t))throw new Error(`invalid class name: ${t}`);return t}function yr(t,e){if(typeof e=="string")t.property("style",e);else if(e!=null)for(const n of t)Object.assign(n.style,e)}function sn({frameAnchor:t},{width:e,height:n,marginTop:r,marginRight:i,marginBottom:o,marginLeft:a}){return[/left$/.test(t)?a:/right$/.test(t)?e-i:(a+e-i)/2,/^top/.test(t)?r:/^bottom/.test(t)?n-o:(r+n-o)/2]}class $t{constructor(e,n={},r={},i){const{facet:o="auto",facetAnchor:a,fx:s,fy:u,sort:f,dx:l=0,dy:c=0,margin:d=0,marginTop:h=d,marginRight:p=d,marginBottom:m=d,marginLeft:w=d,className:b,clip:g=i?.clip,channels:$,tip:y,render:M}=r;if(this.data=e,this.sort=pe(f)?f:null,this.initializer=Ue(r).initializer,this.transform=this.initializer?r.transform:Xo(r).transform,o===null||o===!1?this.facet=null:(this.facet=gt(o===!0?"include":o,"facet",["auto","include","exclude","super"]),this.fx=e===Pe&&typeof s=="string"?[s]:s,this.fy=e===Pe&&typeof u=="string"?[u]:u),this.facetAnchor=Fc(a),n=Vo(n),$!==void 0&&(n={...pd($),...n}),i!==void 0&&(n={...id(this,r,i),...n}),this.channels=Object.fromEntries(Object.entries(n).map(([E,x])=>{if(ir(x.value)){const{value:v,label:S=x.label,scale:C=x.scale}=x.value;x={...x,label:S,scale:C,value:v}}if(e===Pe&&typeof x.value=="string"){const{value:v}=x;x={...x,value:[v]}}return[E,x]}).filter(([E,{value:x,optional:v}])=>{if(x!=null)return!0;if(v)return!1;throw new Error(`missing channel value: ${E}`)})),this.dx=+l,this.dy=+c,this.marginTop=+h,this.marginRight=+p,this.marginBottom=+m,this.marginLeft=+w,this.clip=Ho(g),this.tip=gd(y),this.className=et(b),this.facet==="super"){if(s||u)throw new Error("super-faceting cannot use fx or fy");for(const E in this.channels){const{scale:x}=n[E];if(!(x!=="x"&&x!=="y"))throw new Error("super-faceting cannot use x or y")}}M!=null&&(this.render=va(M,this.render))}initialize(e,n,r){let i=ie(this.data);e===void 0&&i!=null&&(e=[Ot(i)]);const o=e;this.transform!=null&&({facets:e,data:i}=this.transform(i,e,r),i=ie(i)),e!==void 0&&(e.original=o);const a=kf(this.channels,i);return this.sort!=null&&Ff(i,e,a,n,this.sort),{data:i,facets:e,channels:a}}filter(e,n,r){for(const i in n){const{filter:o=Vt}=n[i];if(o!==null){const a=r[i];e=e.filter(s=>o(a[s]))}}return e}project(e,n,r){for(const i in e)if(e[i].scale==="x"&&/^x|x$/.test(i)){const o=i.replace(/^x|x$/,"y");o in e&&e[o].scale==="y"&&_c(i,o,n,r.projection)}}scale(e,n,r){const i=Of(e,n);return r.projection&&this.project(e,i,r),i}}function $a(...t){return t.plot=$t.prototype.plot,t}function va(t,e){if(t==null)return e===null?void 0:e;if(e==null)return t===null?void 0:t;if(typeof t!="function")throw new TypeError(`invalid render transform: ${t}`);if(typeof e!="function")throw new TypeError(`invalid render transform: ${e}`);return function(n,r,i,o,a,s){return t.call(this,n,r,i,o,a,(u,f,l,c,d)=>e.call(this,u,f,l,c,d,s))}}function pd(t){return Object.fromEntries(Object.entries(Vo(t)).map(([e,n])=>(n=typeof n=="string"?{value:n,label:e}:tn(n),n.filter===void 0&&n.scale==null&&(n={...n,filter:null}),[e,n])))}function gd(t){return t===!0?"xy":t===!1||t==null?null:typeof t=="string"?gt(t,"tip",["x","y","xy"]):t}function br(t,e){return t?.tip===!0?{...t,tip:e}:Ut(t?.tip)&&t.tip.pointer===void 0?{...t,tip:{...t.tip,pointer:e}}:t}function yd(t,e,n={}){let r=.5-st,i=.5+st,o=.5+st,a=.5-st;for(const{marginTop:m,marginRight:w,marginBottom:b,marginLeft:g}of e)m>r&&(r=m),w>i&&(i=w),b>o&&(o=b),g>a&&(a=g);let{margin:s,marginTop:u=s!==void 0?s:r,marginRight:f=s!==void 0?s:i,marginBottom:l=s!==void 0?s:o,marginLeft:c=s!==void 0?s:a}=n;u=+u,f=+f,l=+l,c=+c;let{width:d=640,height:h=bd(t,n,{width:d,marginTopDefault:r,marginRightDefault:i,marginBottomDefault:o,marginLeftDefault:a})+Math.max(0,u-r+l-o)}=n;d=+d,h=+h;const p={width:d,height:h,marginTop:u,marginRight:f,marginBottom:l,marginLeft:c};if(t.fx||t.fy){let{margin:m,marginTop:w=m!==void 0?m:u,marginRight:b=m!==void 0?m:f,marginBottom:g=m!==void 0?m:l,marginLeft:$=m!==void 0?m:c}=n.facet??{};w=+w,b=+b,g=+g,$=+$,p.facet={marginTop:w,marginRight:b,marginBottom:g,marginLeft:$}}return p}function bd({x:t,y:e,fy:n,fx:r},{projection:i,aspectRatio:o},{width:a,marginTopDefault:s,marginRightDefault:u,marginBottomDefault:f,marginLeftDefault:l}){const c=n&&n.scale.domain().length||1,d=Kc(i);if(d){const p=r?r.scale.domain().length:1,m=(1.1*c-.1)/(1.1*p-.1)*d,w=Math.max(.1,Math.min(10,m));return Math.round((a-l-u)*w+s+f)}const h=e?Xt(e)?e.scale.domain().length||1:Math.max(7,17/c):1;if(o!=null){if(o=+o,!(isFinite(o)&&o>0))throw new Error(`invalid aspectRatio: ${o}`);const p=ni("y",e)/(ni("x",t)*o),m=r?r.scale.bandwidth():1,w=n?n.scale.bandwidth():1,b=m*(a-l-u)-t.insetLeft-t.insetRight;return(p*b+e.insetTop+e.insetBottom)/w+s+f}return!!(e||n)*Math.max(1,Math.min(60,h*c))*20+!!r*30+60}function ni(t,e){if(!e)throw new Error(`aspectRatio requires ${t} scale`);const{type:n,domain:r}=e;let i;switch(n){case"linear":case"utc":case"time":i=Number;break;case"pow":{const s=e.scale.exponent();i=u=>Math.pow(u,s);break}case"log":i=Math.log;break;case"point":case"band":return r.length;default:throw new Error(`unsupported ${t} scale for aspectRatio: ${n}`)}const[o,a]=Nt(r);return Math.abs(i(a)-i(o))}const ri=new WeakMap;function wr(t,e,{x:n,y:r,px:i,py:o,maxRadius:a=40,channels:s,render:u,...f}={}){return a=+a,i!=null&&(n??=null,s={...s,px:{value:i,scale:"x"}}),o!=null&&(r??=null,s={...s,py:{value:o,scale:"y"}}),{x:n,y:r,channels:s,...f,render:va(function(l,c,d,h,p,m){p={...p,pointerSticky:!1};const w=p.ownerSVGElement,{data:b}=p.getMarkState(this);let g=ri.get(w);g||ri.set(w,g={sticky:!1,roots:[],renders:[]});let $=g.renders.push(D)-1;const{x:y,y:M,fx:E,fy:x}=c;let v=E?E(l.fx)-h.marginLeft:0,S=x?x(l.fy)-h.marginTop:0;y?.bandwidth&&(v+=y.bandwidth()/2),M?.bandwidth&&(S+=M.bandwidth()/2);const C=l.fi!=null;let A;if(C){let I=g.facetStates;I||(g.facetStates=I=new Map),A=I.get(this),A||I.set(this,A=new Map)}const[O,G]=sn(this,h),{px:B,py:q}=d,H=B?I=>B[I]:Ma(d,O),Z=q?I=>q[I]:Sa(d,G);let z,T,L,N;function k(I,P){if(C)if(N&&(N=cancelAnimationFrame(N)),I==null)A.delete(l.fi);else{A.set(l.fi,P),N=requestAnimationFrame(()=>{N=null;for(const[R,_]of A)if(_<P||_===P&&R<l.fi){I=null;break}D(I)});return}D(I)}function D(I){if(z===I&&L===g.sticky)return;z=I,L=p.pointerSticky=g.sticky;const P=z==null?[]:[z];C&&(P.fx=l.fx,P.fy=l.fy,P.fi=l.fi);const R=m(P,c,d,h,p);if(T){if(C){const _=T.parentNode,Y=T.getAttribute("transform"),J=R.getAttribute("transform");Y?R.setAttribute("transform",Y):R.removeAttribute("transform"),J?_.setAttribute("transform",J):_.removeAttribute("transform"),R.removeAttribute("aria-label"),R.removeAttribute("aria-description"),R.removeAttribute("aria-hidden")}T.replaceWith(R)}if(g.roots[$]=T=R,!(z==null&&A?.size>1)){const _=z==null?null:Gt(b)?b[z]:b.get(z);p.dispatchValue(_)}return R}function W(I){if(g.sticky||I.pointerType==="mouse"&&I.buttons===1)return;let[P,R]=kl(I);P-=v,R-=S;const _=P<h.marginLeft||P>h.width-h.marginRight?1:t,Y=R<h.marginTop||R>h.height-h.marginBottom?1:e;let J=null,ut=a*a;for(const tt of l){const ht=_*(H(tt)-P),Bt=Y*(Z(tt)-R),le=ht*ht+Bt*Bt;le<=ut&&(J=tt,ut=le)}if(J!=null&&(t!==1||e!==1)){const tt=H(J)-P,ht=Z(J)-R;ut=tt*tt+ht*ht}k(J,ut)}function V(I){I.pointerType==="mouse"&&z!=null&&(g.sticky&&g.roots.some(P=>P?.contains(I.target))||(g.sticky?(g.sticky=!1,g.renders.forEach(P=>P(null))):(g.sticky=!0,D(z)),I.stopImmediatePropagation()))}function j(I){I.pointerType==="mouse"&&(g.sticky||k(null))}return w.addEventListener("pointerenter",W),w.addEventListener("pointermove",W),w.addEventListener("pointerdown",V),w.addEventListener("pointerleave",j),D(null)},u)}}function wd(t){return wr(1,1,t)}function xd(t){return wr(1,.01,t)}function ii(t){return wr(.01,1,t)}function Ma({x1:t,x2:e,x:n=t},r){return t&&e?i=>(t[i]+e[i])/2:n?i=>n[i]:()=>r}function Sa({y1:t,y2:e,y:n=t},r){return t&&e?i=>(t[i]+e[i])/2:n?i=>n[i]:()=>r}function Aa(t){return Xt(t)&&t.interval===void 0?void 0:"tabular-nums"}function $d(t,e){let{label:n=t.label,tickSize:r=6,width:i=240,height:o=44+r,marginTop:a=18,marginRight:s=0,marginBottom:u=16+r,marginLeft:f=0,style:l,ticks:c=(i-f-s)/64,tickFormat:d,fontVariant:h=Aa(t),round:p=!0,opacity:m,className:w}=e;const b=mr(e);w=gr(w),m=at(m)[1],d===null&&(d=()=>null);const g=rt("svg",b).attr("class",`${w}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",i).attr("height",o).attr("viewBox",`0 0 ${i} ${o}`).call(O=>O.append("style").text(`:where(.${w}-ramp) {
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
  overflow: visible;
}
:where(.${w}-ramp text) {
  white-space: pre;
}`)).call(yr,l);let $=O=>O.selectAll(".tick line").attr("y1",a+u-o),y;const M=p?(O,G)=>O.rangeRound(G):(O,G)=>O.range(G),{type:E,domain:x,range:v,interpolate:S,scale:C,pivot:A}=t;if(S){const O=v===void 0?S:Kn(S.length===1?cr(S):S,v);y=M(C.copy(),pt($e(f,i-s),Math.min(x.length+(A!==void 0),v===void 0?1/0:v.length)));const G=256,B=b.document.createElement("canvas");B.width=G,B.height=1;const q=B.getContext("2d");for(let H=0,Z=G-1;H<G;++H)q.fillStyle=O(H/Z),q.fillRect(H,0,1,1);g.append("image").attr("opacity",m).attr("x",f).attr("y",a).attr("width",i-f-s).attr("height",o-a-u).attr("preserveAspectRatio","none").attr("xlink:href",B.toDataURL())}else if(E==="threshold"){const O=x,G=d===void 0?B=>B:typeof d=="string"?Zn(d):d;y=M(Ai().domain([-1,v.length-1]),[f,i-s]),g.append("g").attr("fill-opacity",m).selectAll().data(v).enter().append("rect").attr("x",(B,q)=>y(q-1)).attr("y",a).attr("width",(B,q)=>y(q)-y(q-1)).attr("height",o-a-u).attr("fill",B=>B),c=U(O,(B,q)=>q),d=B=>G(O[B],B)}else y=M(go().domain(x),[f,i-s]),g.append("g").attr("fill-opacity",m).selectAll().data(x).enter().append("rect").attr("x",y).attr("y",a).attr("width",Math.max(0,y.bandwidth()-1)).attr("height",o-a-u).attr("fill",C),$=()=>{};return g.append("g").attr("transform",`translate(0,${o-u})`).call(Es(y).ticks(Array.isArray(c)?null:c,typeof d=="string"?d:void 0).tickFormat(typeof d=="function"?d:void 0).tickSize(r).tickValues(Array.isArray(c)?c:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",Q(h,"normal")).call($).call(O=>O.select(".domain").remove()),n!==void 0&&g.append("text").attr("x",f).attr("y",a-6).attr("fill","currentColor").attr("font-weight","bold").text(n),g.node()}const Ta=Math.PI/180;function Ca(t,{marker:e,markerStart:n=e,markerMid:r=e,markerEnd:i=e}={}){t.markerStart=Sn(n),t.markerMid=Sn(r),t.markerEnd=Sn(i)}function Sn(t){if(t==null||t===!1)return null;if(t===!0)return ai;if(typeof t=="function")return t;switch(`${t}`.toLowerCase()){case"none":return null;case"arrow":return oi("auto");case"arrow-reverse":return oi("auto-start-reverse");case"dot":return vd;case"circle":case"circle-fill":return ai;case"circle-stroke":return Md;case"tick":return An("auto");case"tick-x":return An(90);case"tick-y":return An(0)}throw new Error(`invalid marker: ${t}`)}function oi(t){return(e,n)=>rt("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",t).attr("fill","none").attr("stroke",e).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call(r=>r.append("path").attr("d","M-1.5,-3l3,3l-3,3")).node()}function vd(t,e){return rt("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","none").call(n=>n.append("circle").attr("r",2.5)).node()}function ai(t,e){return rt("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","var(--plot-background)").attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function Md(t,e){return rt("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","var(--plot-background)").attr("stroke",t).attr("stroke-width",1.5).call(n=>n.append("circle").attr("r",3)).node()}function An(t){return(e,n)=>rt("svg:marker",n).attr("viewBox","-3 -3 6 6").attr("markerWidth",6).attr("markerHeight",6).attr("orient",t).attr("stroke",e).call(r=>r.append("path").attr("d","M0,-3v6")).node()}let Sd=0;function Ia(t,e,{stroke:n},r){return Ad(t,e,n&&(i=>n[i]),null,r)}function Ad(t,{markerStart:e,markerMid:n,markerEnd:r,stroke:i},o=()=>i,a,s){if(!e&&!n&&!r)return;const u=new Map,f=a;function l(c,d,h){return function(p){if(h&&!h(p))return;const m=o(p);let w=u.get(d);w||u.set(d,w=new Map);let b=w.get(m);if(!b){const g=this.parentNode.insertBefore(d(m,s),this),$=`plot-marker-${++Sd}`;g.setAttribute("id",$),w.set(m,b=`url(#${$})`)}this.setAttribute(c,b)}}e&&t.each(l("marker-start",e,f)),n&&t.each(l("marker-mid",n)),r&&t.each(l("marker-end",r,f))}function Ea({inset:t,insetLeft:e,insetRight:n,...r}={}){return[e,n]=Da(t,e,n),{inset:t,insetLeft:e,insetRight:n,...r}}function La({inset:t,insetTop:e,insetBottom:n,...r}={}){return[e,n]=Da(t,e,n),{inset:t,insetTop:e,insetBottom:n,...r}}function Da(t,e,n){return t===void 0&&e===void 0&&n===void 0?st?[1,0]:[.5,.5]:[e,n]}function Na(t,{interval:e}){return t={...tn(t)},t.interval=ar(t.interval===void 0?e:t.interval),t}function ka(t,e,n,r){const{[t]:i,[`${t}1`]:o,[`${t}2`]:a}=n,{value:s,interval:u}=Na(i,n);if(s==null||u==null)return n;const f=Me(i);if(u==null){let h;const p={transform:m=>h||(h=ft(m,s)),label:f};return{...n,[t]:void 0,[`${t}1`]:o===void 0?p:o,[`${t}2`]:a===void 0?p:a}}let l,c;function d(h){return c!==void 0&&h===l?c:c=U(ft(l=h,s),p=>u.floor(p))}return e({...n,[t]:void 0,[`${t}1`]:o===void 0?{transform:d,label:f}:o,[`${t}2`]:a===void 0?{transform:h=>d(h).map(p=>u.offset(p)),label:f}:a})}function Oa(t,e,n){const{[t]:r}=n,{value:i,interval:o}=Na(r,n);return i==null||o==null?n:e({...n,[t]:{label:Me(r),transform:a=>{const s=U(ft(a,i),f=>o.floor(f)),u=s.map(f=>o.offset(f));return s.map(ct(s)?(f,l)=>f==null||isNaN(f=+f)||(l=u[l],l==null)||isNaN(l=+l)?void 0:new Date((f+l)/2):(f,l)=>f==null||(l=u[l],l==null)?NaN:(+f+ +l)/2)}}})}function Fa(t={}){return ka("x",Ea,t)}function Td(t={}){return ka("y",La,t)}function Cd(t={}){return Oa("x",Ea,t)}function Id(t={}){return Oa("y",La,t)}const Ra={ariaLabel:"rule",fill:null,stroke:"currentColor"};class Ed extends $t{constructor(e,n={}){const{x:r,y1:i,y2:o,inset:a=0,insetTop:s=a,insetBottom:u=a}=n;super(e,{x:{value:r,scale:"x",optional:!0},y1:{value:i,scale:"y",optional:!0},y2:{value:o,scale:"y",optional:!0}},br(n,"x"),Ra),this.insetTop=nt(s),this.insetBottom=nt(u),Ca(this,n)}render(e,n,r,i,o){const{x:a,y:s}=n,{x:u,y1:f,y2:l}=r,{width:c,height:d,marginTop:h,marginRight:p,marginLeft:m,marginBottom:w}=i,{insetTop:b,insetBottom:g}=this;return rt("svg:g",o).call(Zt,this,i,o).call(Jt,this,{x:u&&a},st,0).call($=>$.selectAll().data(e).enter().append("line").call(kt,this).attr("x1",u?y=>u[y]:(m+c-p)/2).attr("x2",u?y=>u[y]:(m+c-p)/2).attr("y1",f&&!oe(s)?y=>f[y]+b:h+b).attr("y2",l&&!oe(s)?s.bandwidth?y=>l[y]+s.bandwidth()-g:y=>l[y]-g:d-w-g).call(_t,this,r).call(Ia,this,r,o)).node()}}class Ld extends $t{constructor(e,n={}){const{x1:r,x2:i,y:o,inset:a=0,insetRight:s=a,insetLeft:u=a}=n;super(e,{y:{value:o,scale:"y",optional:!0},x1:{value:r,scale:"x",optional:!0},x2:{value:i,scale:"x",optional:!0}},br(n,"y"),Ra),this.insetRight=nt(s),this.insetLeft=nt(u),Ca(this,n)}render(e,n,r,i,o){const{x:a,y:s}=n,{y:u,x1:f,x2:l}=r,{width:c,height:d,marginTop:h,marginRight:p,marginLeft:m,marginBottom:w}=i,{insetLeft:b,insetRight:g}=this;return rt("svg:g",o).call(Zt,this,i,o).call(Jt,this,{y:u&&s},0,st).call($=>$.selectAll().data(e).enter().append("line").call(kt,this).attr("x1",f&&!oe(a)?y=>f[y]+b:m+b).attr("x2",l&&!oe(a)?a.bandwidth?y=>l[y]+a.bandwidth()-g:y=>l[y]-g:c-p-g).attr("y1",u?y=>u[y]:(h+d-w)/2).attr("y2",u?y=>u[y]:(h+d-w)/2).call(_t,this,r).call(Ia,this,r,o)).node()}}function Ba(t,e){let{x:n=dt,y:r,y1:i,y2:o,...a}=Td(e);return[i,o]=ja(r,i,o),new Ed(t,{...a,x:n,y1:i,y2:o})}function Dd(t,e){let{y:n=dt,x:r,x1:i,x2:o,...a}=Fa(e);return[i,o]=ja(r,i,o),new Ld(t,{...a,y:n,x1:i,x2:o})}function ja(t,e,n){if(t==null){if(e===void 0){if(n!==void 0)return[0,n]}else if(n===void 0)return[0,e]}else{if(e===void 0)return n===void 0?[0,t]:[t,n];if(n===void 0)return[t,e]}return[e,n]}function qa(t,...e){let n=e.length;for(let r=0,i=!0;r<n;++r)typeof e[r]!="function"&&(i&&(t=t.slice(),i=!1),t.splice(r,2,t[r]+e[r]+t[r+1]),e.splice(r,1),--r,--n);return r=>{let i=t[0];for(let o=0;o<n;++o)i+=e[o](r)+t[o+1];return i}}const Nd={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},Wa="­";class xr extends $t{constructor(e,n={}){const{x:r,y:i,text:o=Yt(e)&&zo(e)?dt:Oo,frameAnchor:a,textAnchor:s=/right$/i.test(a)?"end":/left$/i.test(a)?"start":"middle",lineAnchor:u=/^top/i.test(a)?"top":/^bottom/i.test(a)?"bottom":"middle",lineHeight:f=1,lineWidth:l=1/0,textOverflow:c,monospace:d,fontFamily:h=d?"ui-monospace, monospace":void 0,fontSize:p,fontStyle:m,fontVariant:w,fontWeight:b,rotate:g}=n,[$,y]=at(g,0),[M,E]=jd(p);if(super(e,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},fontSize:{value:M,optional:!0},rotate:{value:af($),optional:!0},text:{value:o,filter:vo,optional:!0}},n,Nd),this.rotate=y,this.textAnchor=Q(s,"middle"),this.lineAnchor=gt(u,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+f,this.lineWidth=+l,this.textOverflow=Pa(c),this.monospace=!!d,this.fontFamily=et(h),this.fontSize=E,this.fontStyle=et(m),this.fontVariant=et(w),this.fontWeight=et(b),this.frameAnchor=sr(a),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${l}`);this.splitLines=Va(this),this.clipLine=Ha(this)}render(e,n,r,i,o){const{x:a,y:s}=n,{x:u,y:f,rotate:l,text:c,title:d,fontSize:h}=r,{rotate:p}=this,[m,w]=sn(this,i);return rt("svg:g",o).call(Zt,this,i,o).call(za,this,c,i).call(Jt,this,{x:u&&a,y:f&&s}).call(b=>b.selectAll().data(e).enter().append("text").call(kt,this).call(kd,this,c,d).attr("transform",qa`translate(${u?g=>u[g]:m},${f?g=>f[g]:w})${l?g=>` rotate(${l[g]})`:p?` rotate(${p})`:""}`).call(F,"font-size",h&&(g=>h[g])).call(_t,this,r)).node()}}function Pa(t){return t==null?null:gt(t,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function kd(t,e,n,r){if(!n)return;const{lineAnchor:i,lineHeight:o,textOverflow:a,splitLines:s,clipLine:u}=e;t.each(function(f){const l=s(xe(n[f])??"").map(u),c=l.length,d=i==="top"?.71:i==="bottom"?1-c:(164-c*100)/200;if(c>1){let h=0;for(let p=0;p<c;++p){if(++h,!l[p])continue;const m=this.ownerDocument.createElementNS(ze.svg,"tspan");m.setAttribute("x",0),p===h-1?m.setAttribute("y",`${(d+p)*o}em`):m.setAttribute("dy",`${h*o}em`),m.textContent=l[p],this.appendChild(m),h=0}}else d&&this.setAttribute("y",`${d*o}em`),this.textContent=l[0];if(a&&!r&&l[0]!==n[f]){const h=this.ownerDocument.createElementNS(ze.svg,"title");h.textContent=n[f],this.appendChild(h)}})}function $r(t,{x:e,y:n,...r}={}){return r.frameAnchor===void 0&&([e,n]=Wo(e,n)),new xr(t,{...r,x:e,y:n})}function Od(t,{x:e=dt,...n}={}){return new xr(t,Id({...n,x:e}))}function Fd(t,{y:e=dt,...n}={}){return new xr(t,Cd({...n,y:e}))}function za(t,e,n){F(t,"text-anchor",e.textAnchor),F(t,"font-family",e.fontFamily),F(t,"font-size",e.fontSize),F(t,"font-style",e.fontStyle),F(t,"font-variant",e.fontVariant===void 0?Rd(n):e.fontVariant),F(t,"font-weight",e.fontWeight)}function Rd(t){return t&&(lf(t)||ct(t))?"tabular-nums":void 0}const Bd=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function jd(t){return t==null||typeof t=="number"?[void 0,t]:typeof t!="string"?[t,void 0]:(t=t.trim().toLowerCase(),Bd.has(t)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(t)?[void 0,t]:[t,void 0])}function qd(t,e,n){const r=[];let i,o=0;for(const[a,s,u]of Wd(t)){if(i===void 0&&(i=a),o>i&&n(t,i,s)>e&&(r.push(t.slice(i,o)+(t[o-1]===Wa?"-":"")),i=a),u){r.push(t.slice(i,s)),i=void 0;continue}o=s}return r}function*Wd(t){let e=0,n=0;const r=t.length;for(;n<r;){let i=1;switch(t[n]){case Wa:case"-":++n,yield[e,n,!1],e=n;break;case" ":for(yield[e,n,!1];t[++n]===" ";);e=n;break;case"\r":t[n+1]===`
`&&++i;case`
`:yield[e,n,!0],n+=i,e=n;break;default:++n;break}}yield[e,n,!0]}const si={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"‘":31,"’":31,"“":47,"”":47,"…":82};function vr(t,e=0,n=t.length){let r=0;for(let i=e;i<n;i=se(t,i))r+=si[t[i]]??(Ga(t,i)?120:si.e);return r}function Mr(t,e=0,n=t.length){let r=0;for(let i=e;i<n;i=se(t,i))r+=Ga(t,i)?126:63;return r}function Va({monospace:t,lineWidth:e,textOverflow:n}){if(n!=null||e==1/0)return o=>o.split(/\r\n?|\n/g);const r=t?Mr:vr,i=e*100;return o=>qd(o,i,r)}function Ha({monospace:t,lineWidth:e,textOverflow:n}){if(n==null||e==1/0)return o=>o;const r=t?Mr:vr,i=e*100;switch(n){case"clip-start":return o=>li(o,i,r,"");case"clip-end":return o=>ui(o,i,r,"");case"ellipsis-start":return o=>li(o,i,r,ne);case"ellipsis-middle":return o=>Pd(o,i,r,ne);case"ellipsis-end":return o=>ui(o,i,r,ne)}}const ne="…";function ae(t,e,n,r){const i=[];let o=0;for(let a=0,s=0,u=t.length;a<u;a=s){s=se(t,a);const f=n(t,a,s);if(o+f>e){for(o+=r;o>e&&a>0;)s=a,a=i.pop(),o-=n(t,a,s);return[a,e-o]}o+=f,i.push(a)}return[-1,0]}function ui(t,e,n,r){t=t.trim();const i=n(r),[o]=ae(t,e,n,i);return o<0?t:t.slice(0,o).trimEnd()+r}function Pd(t,e,n,r){t=t.trim();const i=n(t);if(i<=e)return t;const o=n(r)/2,[a,s]=ae(t,e/2,n,o),[u]=ae(t,i-e/2-s+o,n,-o);return u<0?r:t.slice(0,a).trimEnd()+r+t.slice(se(t,u)).trimStart()}function li(t,e,n,r){t=t.trim();const i=n(t);if(i<=e)return t;const o=n(r),[a]=ae(t,i-e+o,n,-o);return a<0?r:r+t.slice(se(t,a)).trimStart()}const Vn=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,fi=/\p{Extended_Pictographic}/uy;function se(t,e){return e+=zd(t,e)?2:1,Hd(t,e)&&(e=Vn.lastIndex),Vd(t,e)?se(t,e+1):e}function _a(t,e){return t.charCodeAt(e)<128}function zd(t,e){const n=t.charCodeAt(e);if(n>=55296&&n<56320){const r=t.charCodeAt(e+1);return r>=56320&&r<57344}return!1}function Vd(t,e){return t.charCodeAt(e)===8205}function Hd(t,e){return _a(t,e)?!1:(Vn.lastIndex=e,Vn.test(t))}function Ga(t,e){return _a(t,e)?!1:(fi.lastIndex=e,fi.test(t))}const _d={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},Ka=3.5,Gd=Ka*5,Ua={draw(t,e,n){const r=e*n/Gd;t.moveTo(0,0),t.lineTo(0,-e),t.moveTo(-r,r-e),t.lineTo(0,-e),t.lineTo(r,r-e)}},Kd={draw(t,e,n){t.moveTo(-n,0),t.lineTo(0,-e),t.lineTo(n,0)}},Ud=new Map([["arrow",Ua],["spike",Kd]]);function Yd(t){return t&&typeof t.draw=="function"}function Xd(t){if(Yd(t))return t;const e=Ud.get(`${t}`.toLowerCase());if(e)return e;throw new Error(`invalid shape: ${t}`)}class Ya extends $t{constructor(e,n={}){const{x:r,y:i,r:o=Ka,length:a,rotate:s,shape:u=Ua,anchor:f="middle",frameAnchor:l}=n,[c,d]=at(a,12),[h,p]=at(s,0);super(e,{x:{value:r,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},length:{value:c,scale:"length",optional:!0},rotate:{value:h,optional:!0}},n,_d),this.r=+o,this.length=d,this.rotate=p,this.shape=Xd(u),this.anchor=gt(f,"anchor",["start","middle","end"]),this.frameAnchor=sr(l)}render(e,n,r,i,o){const{x:a,y:s}=n,{x:u,y:f,length:l,rotate:c}=r,{length:d,rotate:h,anchor:p,shape:m,r:w}=this,[b,g]=sn(this,i);return rt("svg:g",o).call(Zt,this,i,o).call(Jt,this,{x:u&&a,y:f&&s}).call($=>$.selectAll().data(e).enter().append("path").call(kt,this).attr("transform",qa`translate(${u?y=>u[y]:b},${f?y=>f[y]:g})${c?y=>` rotate(${c[y]})`:h?` rotate(${h})`:""}${p==="start"?"":p==="end"?l?y=>` translate(0,${l[y]})`:` translate(0,${d})`:l?y=>` translate(0,${l[y]/2})`:` translate(0,${d/2})`}`).attr("d",l?y=>{const M=Nn();return m.draw(M,l[y],w),M}:(()=>{const y=Nn();return m.draw(y,d,w),y})()).call(_t,this,r)).node()}}function Zd(t,e={}){const{x:n=dt,...r}=e;return new Ya(t,{...r,x:n})}function Jd(t,e={}){const{y:n=dt,...r}=e;return new Ya(t,{...r,y:n})}function Rt(t,e){return arguments.length<2&&!Yt(t)&&(e=t,t=null),e===void 0&&(e={}),[t,e]}function un({anchor:t}={},e){return t===void 0?e[0]:gt(t,"anchor",e)}function Xa(t){return un(t,["left","right"])}function Za(t){return un(t,["right","left"])}function Ja(t){return un(t,["bottom","top"])}function Qa(t){return un(t,["top","bottom"])}function ts(){const[t,e]=Rt(...arguments);return ns("y",Xa(e),t,e)}function Qd(){const[t,e]=Rt(...arguments);return ns("fy",Za(e),t,e)}function es(){const[t,e]=Rt(...arguments);return rs("x",Ja(e),t,e)}function th(){const[t,e]=Rt(...arguments);return rs("fx",Qa(e),t,e)}function ns(t,e,n,{color:r="currentColor",opacity:i=1,stroke:o=r,strokeOpacity:a=i,strokeWidth:s=1,fill:u=r,fillOpacity:f=i,textAnchor:l,textStroke:c,textStrokeOpacity:d,textStrokeWidth:h,tickSize:p=t==="y"?6:0,tickPadding:m,tickRotate:w,x:b,margin:g,marginTop:$=g===void 0?20:g,marginRight:y=g===void 0?e==="right"?40:0:g,marginBottom:M=g===void 0?20:g,marginLeft:E=g===void 0?e==="left"?40:0:g,label:x,labelAnchor:v,labelArrow:S,labelOffset:C,ariaLabel:A=`${t}-axis`,...O}){return p=nt(p),m=nt(m),w=nt(w),v!==void 0&&(v=gt(v,"labelAnchor",["center","top","bottom"])),S=cs(S),$a(p&&!ot(o)?eh(t,e,n,{stroke:o,strokeOpacity:a,strokeWidth:s,tickSize:p,tickPadding:m,tickRotate:w,x:b,ariaLabel:A,...O}):null,ot(u)?null:rh(t,e,n,{fill:u,fillOpacity:f,stroke:c,strokeOpacity:d,strokeWidth:h,textAnchor:l,tickSize:p,tickPadding:m,tickRotate:w,x:b,marginTop:$,marginRight:y,marginBottom:M,marginLeft:E,ariaLabel:A,...O}),!ot(u)&&x!==null?$r([],ss({fill:u,fillOpacity:f,...O},function(G,B,q,H,Z){const z=H[t],{marginTop:T,marginRight:L,marginBottom:N,marginLeft:k}=t==="y"&&Z.inset||Z,D=v??(z.bandwidth?"center":"top"),W=C??(e==="right"?L:k)-3;return D==="center"?(this.textAnchor=void 0,this.lineAnchor=e==="right"?"bottom":"top",this.frameAnchor=e,this.rotate=-90):(this.textAnchor=e==="right"?"end":"start",this.lineAnchor=D,this.frameAnchor=`${D}-${e}`,this.rotate=0),this.dy=D==="top"?3-T:D==="bottom"?N-3:0,this.dx=e==="right"?W:-W,this.ariaLabel=`${A} label`,{facets:[[0]],channels:{text:{value:[fs(t,z,{anchor:e,label:x,labelAnchor:D,labelArrow:S})]}}}})):null)}function rs(t,e,n,{color:r="currentColor",opacity:i=1,stroke:o=r,strokeOpacity:a=i,strokeWidth:s=1,fill:u=r,fillOpacity:f=i,textAnchor:l,textStroke:c,textStrokeOpacity:d,textStrokeWidth:h,tickSize:p=t==="x"?6:0,tickPadding:m,tickRotate:w,y:b,margin:g,marginTop:$=g===void 0?e==="top"?30:0:g,marginRight:y=g===void 0?20:g,marginBottom:M=g===void 0?e==="bottom"?30:0:g,marginLeft:E=g===void 0?20:g,label:x,labelAnchor:v,labelArrow:S,labelOffset:C,ariaLabel:A=`${t}-axis`,...O}){return p=nt(p),m=nt(m),w=nt(w),v!==void 0&&(v=gt(v,"labelAnchor",["center","left","right"])),S=cs(S),$a(p&&!ot(o)?nh(t,e,n,{stroke:o,strokeOpacity:a,strokeWidth:s,tickSize:p,tickPadding:m,tickRotate:w,y:b,ariaLabel:A,...O}):null,ot(u)?null:ih(t,e,n,{fill:u,fillOpacity:f,stroke:c,strokeOpacity:d,strokeWidth:h,textAnchor:l,tickSize:p,tickPadding:m,tickRotate:w,y:b,marginTop:$,marginRight:y,marginBottom:M,marginLeft:E,ariaLabel:A,...O}),!ot(u)&&x!==null?$r([],ss({fill:u,fillOpacity:f,...O},function(G,B,q,H,Z){const z=H[t],{marginTop:T,marginRight:L,marginBottom:N,marginLeft:k}=t==="x"&&Z.inset||Z,D=v??(z.bandwidth?"center":"right"),W=C??(e==="top"?T:N)-3;return D==="center"?(this.frameAnchor=e,this.textAnchor=void 0):(this.frameAnchor=`${e}-${D}`,this.textAnchor=D==="right"?"end":"start"),this.lineAnchor=e,this.dy=e==="top"?-W:W,this.dx=D==="right"?L-3:D==="left"?3-k:0,this.ariaLabel=`${A} label`,{facets:[[0]],channels:{text:{value:[fs(t,z,{anchor:e,label:x,labelAnchor:D,labelArrow:S})]}}}})):null)}function eh(t,e,n,{strokeWidth:r=1,strokeLinecap:i=null,strokeLinejoin:o=null,facetAnchor:a=e+(t==="y"?"-empty":""),frameAnchor:s=e,tickSize:u,inset:f=0,insetLeft:l=f,insetRight:c=f,dx:d=0,y:h=t==="y"?void 0:null,ariaLabel:p,...m}){return ue(Jd,t,n,{ariaLabel:`${p} tick`,ariaHidden:!0},{strokeWidth:r,strokeLinecap:i,strokeLinejoin:o,facetAnchor:a,frameAnchor:s,y:h,...m,dx:e==="left"?+d-st+ +l:+d+st-c,anchor:"start",length:u,shape:e==="left"?dh:hh})}function nh(t,e,n,{strokeWidth:r=1,strokeLinecap:i=null,strokeLinejoin:o=null,facetAnchor:a=e+(t==="x"?"-empty":""),frameAnchor:s=e,tickSize:u,inset:f=0,insetTop:l=f,insetBottom:c=f,dy:d=0,x:h=t==="x"?void 0:null,ariaLabel:p,...m}){return ue(Zd,t,n,{ariaLabel:`${p} tick`,ariaHidden:!0},{strokeWidth:r,strokeLinejoin:o,strokeLinecap:i,facetAnchor:a,frameAnchor:s,x:h,...m,dy:e==="bottom"?+d-st-c:+d+st+ +l,anchor:"start",length:u,shape:e==="bottom"?fh:ch})}function rh(t,e,n,{facetAnchor:r=e+(t==="y"?"-empty":""),frameAnchor:i=e,tickSize:o,tickRotate:a=0,tickPadding:s=Math.max(3,9-o)+(Math.abs(a)>60?4*Math.cos(a*Ta):0),text:u,textAnchor:f=Math.abs(a)>60?"middle":e==="left"?"end":"start",lineAnchor:l=a>60?"top":a<-60?"bottom":"middle",fontVariant:c,inset:d=0,insetLeft:h=d,insetRight:p=d,dx:m=0,ariaLabel:w,y:b=t==="y"?void 0:null,...g}){return ue(Fd,t,n,{ariaLabel:`${w} tick label`},{facetAnchor:r,frameAnchor:i,text:u,textAnchor:f,lineAnchor:l,fontVariant:c,rotate:a,y:b,...g,dx:e==="left"?+m-o-s+ +h:+m+ +o+ +s-p},function($,y,M,E,x){c===void 0&&(this.fontVariant=ls($)),u===void 0&&(x.text=us($,y,M,E,e))})}function ih(t,e,n,{facetAnchor:r=e+(t==="x"?"-empty":""),frameAnchor:i=e,tickSize:o,tickRotate:a=0,tickPadding:s=Math.max(3,9-o)+(Math.abs(a)>=10?4*Math.cos(a*Ta):0),text:u,textAnchor:f=Math.abs(a)>=10?a<0^e==="bottom"?"start":"end":"middle",lineAnchor:l=Math.abs(a)>=10?"middle":e==="bottom"?"top":"bottom",fontVariant:c,inset:d=0,insetTop:h=d,insetBottom:p=d,dy:m=0,x:w=t==="x"?void 0:null,ariaLabel:b,...g}){return ue(Od,t,n,{ariaLabel:`${b} tick label`},{facetAnchor:r,frameAnchor:i,text:u===void 0?null:u,textAnchor:f,lineAnchor:l,fontVariant:c,rotate:a,x:w,...g,dy:e==="bottom"?+m+ +o+ +s-p:+m-o-s+ +h},function($,y,M,E,x){c===void 0&&(this.fontVariant=ls($)),u===void 0&&(x.text=us($,y,M,E,e))})}function oh(){const[t,e]=Rt(...arguments);return is("y",Xa(e),t,e)}function ah(){const[t,e]=Rt(...arguments);return is("fy",Za(e),t,e)}function sh(){const[t,e]=Rt(...arguments);return os("x",Ja(e),t,e)}function uh(){const[t,e]=Rt(...arguments);return os("fx",Qa(e),t,e)}function is(t,e,n,{y:r=t==="y"?void 0:null,x:i=null,x1:o=e==="left"?i:null,x2:a=e==="right"?i:null,ariaLabel:s=`${t}-grid`,ariaHidden:u=!0,...f}){return ue(Dd,t,n,{ariaLabel:s,ariaHidden:u},{y:r,x1:o,x2:a,...as(f)})}function os(t,e,n,{x:r=t==="x"?void 0:null,y:i=null,y1:o=e==="top"?i:null,y2:a=e==="bottom"?i:null,ariaLabel:s=`${t}-grid`,ariaHidden:u=!0,...f}){return ue(Ba,t,n,{ariaLabel:s,ariaHidden:u},{x:r,y1:o,y2:a,...as(f)})}function as({color:t="currentColor",opacity:e=.1,stroke:n=t,strokeOpacity:r=e,strokeWidth:i=1,...o}){return{stroke:n,strokeOpacity:r,strokeWidth:i,...o}}function ss({fill:t,fillOpacity:e,fontFamily:n,fontSize:r,fontStyle:i,fontVariant:o,fontWeight:a,monospace:s,pointerEvents:u,shapeRendering:f,clip:l=!1},c){return[,t]=Ht(t),[,e]=at(e),{facet:"super",x:null,y:null,fill:t,fillOpacity:e,fontFamily:n,fontSize:r,fontStyle:i,fontVariant:o,fontWeight:a,monospace:s,pointerEvents:u,shapeRendering:f,clip:l,initializer:c}}function ue(t,e,n,r,i,o){let a;function s(l,c,d,h,p,m){const w=l==null&&(e==="fx"||e==="fy"),{[e]:b}=h;if(!b)throw new Error(`missing scale: ${e}`);const g=b.domain();let{interval:$,ticks:y,tickFormat:M,tickSpacing:E=e==="x"?80:35}=i;if(typeof y=="string"&&ds(b)&&($=y,y=void 0),y===void 0&&(y=Se($,b.type)??lh(b,E)),l==null){if(Yt(y))l=Kt(y);else if(of(y))l=Tn(y,...Nt(g));else if(b.interval){let v=b.interval;if(b.ticks){const[S,C]=Nt(g),A=(C-S)/v[ve];v=Dr(v,A/y)??v,l=Tn(v,S,C)}else{l=g;const S=l.length;v=Dr(v,S/y)??v,v!==b.interval&&(l=Tn(v,...Nt(l)))}if(v===b.interval){const S=Math.round(l.length/y);S>1&&(l=l.filter((C,A)=>A%S===0))}}else b.ticks?l=b.ticks(y):l=g;if(!b.ticks&&l.length&&l!==g){const v=new Je(g);l=l.filter(S=>v.has(S)),l.length||Wt(`Warning: the ${e}-axis ticks appear to not align with the scale domain, resulting in no ticks. Try different ticks?`)}e==="y"||e==="x"?c=[Ot(l)]:a[e]={scale:e,value:dt}}o?.call(this,b,l,y,M,a);const x=Object.fromEntries(Object.entries(a).map(([v,S])=>[v,{...S,value:ft(l,S.value)}]));return w&&(c=m.filterFacets(l,x)),{data:l,facets:c,channels:x}}const u=Ue(i).initializer,f=t(n,Ue({...i,initializer:s},u));return n==null?(a=f.channels,f.channels={}):a={},r!==void 0&&Object.assign(f,r),f.clip===void 0&&(f.clip=!1),f}function lh(t,e){const[n,r]=Nt(t.range());return(r-n)/e}function us(t,e,n,r,i){return{value:Sr(t,e,n,r,i)}}function Sr(t,e,n,r,i){return typeof r=="function"&&!(t.type==="log"&&t.tickFormat)?r:r===void 0&&e&&ct(e)?jl(t.type,e,i)??xe:t.tickFormat?t.tickFormat(typeof n=="number"?n:null,r):typeof r=="string"&&t.domain().length>0?(ct(t.domain())?Gn:Zn)(r):r===void 0?xe:Tt(r)}function Tn(t,e,n){return t.range(e,t.offset(t.floor(n)))}const fh={draw(t,e){t.moveTo(0,0),t.lineTo(0,e)}},ch={draw(t,e){t.moveTo(0,0),t.lineTo(0,-e)}},dh={draw(t,e){t.moveTo(0,0),t.lineTo(-e,0)}},hh={draw(t,e){t.moveTo(0,0),t.lineTo(e,0)}};function ls(t){return t.bandwidth&&!t.interval?void 0:"tabular-nums"}function fs(t,e,{anchor:n,label:r=e.label,labelAnchor:i,labelArrow:o}={}){if(!(r==null||r.inferred&&ds(e)&&/^(date|time|year)$/i.test(r))){if(r=String(r),o==="auto"&&(o=(!e.bandwidth||e.interval)&&!/[↑↓→←]/.test(r)),!o)return r;if(o===!0){const a=vc(e);a&&(o=/x$/.test(t)||i==="center"?/x$/.test(t)===a<0?"left":"right":a<0?"up":"down")}switch(o){case"left":return`← ${r}`;case"right":return`${r} →`;case"up":return n==="right"?`${r} ↑`:`↑ ${r}`;case"down":return n==="right"?`${r} ↓`:`↓ ${r}`}return r}}function cs(t="auto"){return ot(t)?!1:typeof t=="boolean"?t:gt(t,"labelArrow",["auto","up","right","down","left"])}function ds(t){return ct(t.domain())}function ci(t,e){if(e==null)return e;const n=t(e);if(!n)throw new Error(`scale not found: ${e}`);return n}function mh(t,{opacity:e,...n}={}){if(!Xt(t)&&!ya(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return hs(t,n,(r,i,o,a)=>r.append("svg").attr("width",o).attr("height",a).attr("fill",i.scale).attr("fill-opacity",at(e)[1]).append("rect").attr("width","100%").attr("height","100%"))}function ph(t,{fill:e=t.hint?.fill!==void 0?t.hint.fill:"none",fillOpacity:n=1,stroke:r=t.hint?.stroke!==void 0?t.hint.stroke:ot(e)?"currentColor":"none",strokeOpacity:i=1,strokeWidth:o=1.5,r:a=4.5,...s}={},u){const[f,l]=Ht(e),[c,d]=Ht(r),h=ci(u,f),p=ci(u,c),m=a*a*Math.PI;return n=at(n)[1],i=at(i)[1],o=at(o)[1],hs(t,s,(w,b,g,$)=>w.append("svg").attr("viewBox","-8 -8 16 16").attr("width",g).attr("height",$).attr("fill",f==="color"?y=>h.scale(y):l).attr("fill-opacity",n).attr("stroke",c==="color"?y=>p.scale(y):d).attr("stroke-opacity",i).attr("stroke-width",o).append("path").attr("d",y=>{const M=Nn();return t.scale(y).draw(M,m),M}))}function hs(t,e={},n){let{columns:r,tickFormat:i,fontVariant:o=Aa(t),swatchSize:a=15,swatchWidth:s=a,swatchHeight:u=a,marginLeft:f=0,className:l,style:c,width:d}=e;const h=mr(e);l=gr(l),i=Sr(t.scale,t.domain,void 0,i);const p=rt("div",h).attr("class",`${l}-swatches ${l}-swatches-${r!=null?"columns":"wrap"}`);let m;return r!=null?(m=`:where(.${l}-swatches-columns .${l}-swatch) {
  display: flex;
  align-items: center;
  break-inside: avoid;
  padding-bottom: 1px;
}
:where(.${l}-swatches-columns .${l}-swatch::before) {
  flex-shrink: 0;
}
:where(.${l}-swatches-columns .${l}-swatch-label) {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}`,p.style("columns",r).selectAll().data(t.domain).enter().append("div").attr("class",`${l}-swatch`).call(n,t,s,u).call(w=>w.append("div").attr("class",`${l}-swatch-label`).attr("title",i).text(i))):(m=`:where(.${l}-swatches-wrap) {
  display: flex;
  align-items: center;
  min-height: 33px;
  flex-wrap: wrap;
}
:where(.${l}-swatches-wrap .${l}-swatch) {
  display: inline-flex;
  align-items: center;
  margin-right: 1em;
}`,p.selectAll().data(t.domain).enter().append("span").attr("class",`${l}-swatch`).call(n,t,s,u).append(function(){return this.ownerDocument.createTextNode(i.apply(this,arguments))})),p.call(w=>w.insert("style","*").text(`:where(.${l}-swatches) {
  font-family: system-ui, sans-serif;
  font-size: 10px;
  margin-bottom: 0.5em;
}
:where(.${l}-swatch > svg) {
  margin-right: 0.5em;
  overflow: visible;
}
${m}`)).style("margin-left",f?`${+f}px`:null).style("width",d===void 0?null:`${+d}px`).style("font-variant",Q(o,"normal")).call(yr,c).node()}const Hn=new Map([["symbol",ph],["color",ps],["opacity",yh]]);function gh(t,e,n={}){return(r,i)=>{if(!Hn.has(r))throw new Error(`unknown legend type: ${r}`);if(r in t)return Hn.get(r)(t[r],ms(e,n[r],i),o=>t[o])}}function ms({className:t,...e},{label:n,ticks:r,tickFormat:i}={},o){return hf(o,{className:t,...e},{label:n,ticks:r,tickFormat:i})}function ps(t,{legend:e=!0,...n}){if(e===!0&&(e=t.type==="ordinal"?"swatches":"ramp"),t.domain!==void 0)switch(`${e}`.toLowerCase()){case"swatches":return mh(t,n);case"ramp":return $d(t,n);default:throw new Error(`unknown legend type: ${e}`)}}function yh({type:t,interpolate:e,...n},{legend:r=!0,color:i=En(0,0,0),...o}){if(!e)throw new Error(`${t} opacity scales are not supported`);if(r===!0&&(r="ramp"),`${r}`.toLowerCase()!=="ramp")throw new Error(`${r} opacity legends are not supported`);return ps({type:t,...n,interpolate:bh(i)},{legend:r,...o})}function bh(t){const{r:e,g:n,b:r}=En(t)||En(0,0,0);return i=>`rgba(${e},${n},${r},${i})`}function wh(t,e,n){const r=[];for(const[i,o]of Hn){const a=n[i];if(a?.legend&&i in t){const s=o(t[i],ms(e,t[i],a),u=>t[u]);s!=null&&r.push(s)}}return r}function xh(t={},e="x"){return qo(t)?t:{...t,[e]:dt}}function $h(t,e){if(e.length===1)return{data:t,facets:e};const n=ge(t),r=new Uint8Array(n);let i=0;for(const s of e)for(const u of s)r[u]&&++i,r[u]=1;if(i===0)return{data:t,facets:e};t=me(t);const o=t[No]=new Uint32Array(n+i);e=e.map(s=>me(s,Uint32Array));let a=n;r.fill(0);for(const s of e)for(let u=0,f=s.length;u<f;++u){const l=s[u];r[l]?(s[u]=a,t[a]=t[l],o[a]=l,++a):o[l]=l,r[l]=1}return{data:t,facets:e}}function vh(t={},e={}){arguments.length===1&&([t,e]=Sh(t));const{y1:n,y:r=n,x:i,...o}=e,[a,s,u,f]=Th(r,i,"y","x",t,o);return{...a,y1:n,y:s,x1:u,x2:f,x:tf(u,f)}}function Mh({x:t,x1:e,x2:n,...r}={}){return r=br(r,"y"),e===void 0&&n===void 0?vh({x:t,...r}):([e,n]=Xl(t,e,n),{...r,x1:e,x2:n})}function Sh(t){const{offset:e,order:n,reverse:r,...i}=t;return[{offset:e,order:n,reverse:r},i]}const Ah={length:!0};function Th(t,e=Vl,n,r,{offset:i,order:o,reverse:a},s){if(e===null)throw new Error(`stack requires ${r}`);const u=Zl(s),[f,l]=Ql(t),[c,d]=Fn(e),[h,p]=Fn(e);return c.hint=h.hint=Ah,i=Ch(i),o=Lh(o,i,r),[Xo(s,(m,w,b)=>{({data:m,facets:w}=$h(m,w));const g=t==null?void 0:l(ef(ft(m,t),b?.[n])),$=ft(m,e,Float64Array),y=ft(m,u),M=o&&o(m,g,$,y),E=ge(m),x=d(new Float64Array(E)),v=p(new Float64Array(E)),S=[];for(const C of w){const A=g?Array.from(Il(C,O=>g[O]).values()):[C];if(M)for(const O of A)O.sort(M);for(const O of A){let G=0,B=0;a&&O.reverse();for(const q of O){const H=$[q];H<0?G=v[q]=(x[q]=G)+H:H>0?B=v[q]=(x[q]=B)+H:v[q]=x[q]=B}}S.push(A)}return i&&i(S,x,v,y),{data:m,facets:w}}),f,c,h]}function Ch(t){if(t!=null){if(typeof t=="function")return t;switch(`${t}`.toLowerCase()){case"expand":case"normalize":return Ih;case"center":case"silhouette":return Eh;case"wiggle":return ys}throw new Error(`unknown offset: ${t}`)}}function gs(t,e){let n=0,r=0;for(const i of t){const o=e[i];o<n&&(n=o),o>r&&(r=o)}return[n,r]}function Ih(t,e,n){for(const r of t)for(const i of r){const[o,a]=gs(i,n);for(const s of i){const u=1/(a-o||1);e[s]=u*(e[s]-o),n[s]=u*(n[s]-o)}}}function Eh(t,e,n){for(const r of t){for(const i of r){const[o,a]=gs(i,n);for(const s of i){const u=(a+o)/2;e[s]-=u,n[s]-=u}}bs(r,e,n)}ws(t,e,n)}function ys(t,e,n,r){for(const i of t){const o=new Xn;let a=0;for(const s of i){let u=-1;const f=s.map(h=>Math.abs(n[h]-e[h])),l=s.map(h=>{u=r?r[h]:++u;const p=n[h]-e[h],m=o.has(u)?p-o.get(u):0;return o.set(u,p),m}),c=[0,...Cl(l)];for(const h of s)e[h]+=a,n[h]+=a;const d=Pt(f);d&&(a-=Pt(f,(h,p)=>(l[p]/2+c[p])*h)/d)}bs(i,e,n)}ws(t,e,n)}function bs(t,e,n){const r=zt(t,i=>zt(i,o=>e[o]));for(const i of t)for(const o of i)e[o]-=r,n[o]-=r}function ws(t,e,n){const r=t.length;if(r===1)return;const i=t.map(s=>s.flat()),o=i.map(s=>(zt(s,u=>e[u])+Ct(s,u=>n[u]))/2),a=zt(o);for(let s=0;s<r;s++){const u=a-o[s];for(const f of i[s])e[f]+=u,n[f]+=u}}function Lh(t,e,n){if(t===void 0&&e===ys)return di(wt);if(t!=null){if(typeof t=="string"){const r=t.startsWith("-"),i=r?Ke:wt;switch((r?t.slice(1):t).toLowerCase()){case"value":case n:return Dh(i);case"z":return Nh(i);case"sum":return kh(i);case"appearance":return Oh(i);case"inside-out":return di(i)}return hi(ko(t))}if(typeof t=="function")return(t.length===1?hi:Fh)(t);if(Gt(t))return Rh(t);throw new Error(`invalid order: ${t}`)}}function Dh(t){return(e,n,r)=>(i,o)=>t(r[i],r[o])}function Nh(t){return(e,n,r,i)=>(o,a)=>t(i[o],i[a])}function kh(t){return ln(t,(e,n,r,i)=>Yn(Ot(e),o=>Pt(o,a=>r[a]),o=>i[o]))}function Oh(t){return ln(t,(e,n,r,i)=>Yn(Ot(e),o=>n[xo(o,a=>r[a])],o=>i[o]))}function di(t){return ln(t,(e,n,r,i)=>{const o=Ot(e),a=Yn(o,c=>n[xo(c,d=>r[d])],c=>i[c]),s=qe(o,c=>Pt(c,d=>r[d]),c=>i[c]),u=[],f=[];let l=0;for(const c of a)l<0?(l+=s.get(c),u.push(c)):(l-=s.get(c),f.push(c));return f.reverse().concat(u)})}function hi(t){return e=>{const n=ft(e,t);return(r,i)=>wt(n[r],n[i])}}function Fh(t){return e=>Gt(e)?(n,r)=>t(e[n],e[r]):(n,r)=>t(e.get(n),e.get(r))}function Rh(t){return ln(wt,()=>t)}function ln(t,e){return(n,r,i,o)=>{if(!o)throw new Error("missing channel: z");const a=new Xn(e(n,r,i,o).map((s,u)=>[s,u]));return(s,u)=>t(a.get(o[s]),a.get(o[u]))}}function xs(t,{inset:e=0,insetTop:n=e,insetRight:r=e,insetBottom:i=e,insetLeft:o=e}={}){t.insetTop=nt(n),t.insetRight=nt(r),t.insetBottom=nt(i),t.insetLeft=nt(o)}function $s(t,{r:e,rx:n,ry:r,rx1:i=e,ry1:o=e,rx2:a=e,ry2:s=e,rx1y1:u=i!==void 0?+i:o!==void 0?+o:0,rx1y2:f=i!==void 0?+i:s!==void 0?+s:0,rx2y1:l=a!==void 0?+a:o!==void 0?+o:0,rx2y2:c=a!==void 0?+a:s!==void 0?+s:0}={}){u||f||l||c?(t.rx1y1=u,t.rx1y2=f,t.rx2y1=l,t.rx2y2=c):(t.rx=Q(n,"auto"),t.ry=Q(r,"auto"))}function vs(t,e,n,r,i,o){const{rx1y1:a,rx1y2:s,rx2y1:u,rx2y2:f}=o;typeof e!="function"&&(e=Tt(e)),typeof n!="function"&&(n=Tt(n)),typeof r!="function"&&(r=Tt(r)),typeof i!="function"&&(i=Tt(i));const l=Math.max(Math.abs(a+u),Math.abs(s+f)),c=Math.max(Math.abs(a+s),Math.abs(u+f));t.attr("d",d=>{const h=e(d),p=n(d),m=r(d),w=i(d),b=h>m,g=p>w,$=b?m:h,y=b?h:m,M=g?w:p,E=g?p:w,x=Math.min(1,(y-$)/l,(E-M)/c),v=x*(b?g?f:u:g?s:a),S=x*(b?g?s:a:g?f:u),C=x*(b?g?a:s:g?u:f),A=x*(b?g?u:f:g?a:s);return`M${$},${M+Fe(v,A)}A${v},${v} 0 0 ${v<0?0:1} ${$+Oe(v,A)},${M}H${y-Oe(S,C)}A${S},${S} 0 0 ${S<0?0:1} ${y},${M+Fe(S,C)}V${E-Fe(C,S)}A${C},${C} 0 0 ${C<0?0:1} ${y-Oe(C,S)},${E}H${$+Oe(A,v)}A${A},${A} 0 0 ${A<0?0:1} ${$},${E-Fe(A,v)}Z`})}function Oe(t,e){return e<0?t:Math.abs(t)}function Fe(t,e){return e<0?Math.abs(t):t}const Bh={ariaLabel:"frame",fill:"none",stroke:"currentColor",clip:!1},jh={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square",clip:!1};class qh extends $t{constructor(e={}){const{anchor:n=null}=e;super(Pe,void 0,e,n==null?Bh:jh),this.anchor=Bo(n,"anchor",["top","right","bottom","left"]),xs(this,e),n||$s(this,e)}render(e,n,r,i,o){const{marginTop:a,marginRight:s,marginBottom:u,marginLeft:f,width:l,height:c}=i,{anchor:d,insetTop:h,insetRight:p,insetBottom:m,insetLeft:w}=this,{rx:b,ry:g,rx1y1:$,rx1y2:y,rx2y1:M,rx2y2:E}=this,x=f+w,v=l-s-p,S=a+h,C=c-u-m;return rt(d?"svg:line":$||y||M||E?"svg:path":"svg:rect",o).datum(0).call(Zt,this,i,o).call(kt,this).call(_t,this,r).call(Jt,this,{}).call(d==="left"?A=>A.attr("x1",x).attr("x2",x).attr("y1",S).attr("y2",C):d==="right"?A=>A.attr("x1",v).attr("x2",v).attr("y1",S).attr("y2",C):d==="top"?A=>A.attr("x1",x).attr("x2",v).attr("y1",S).attr("y2",S):d==="bottom"?A=>A.attr("x1",x).attr("x2",v).attr("y1",C).attr("y2",C):$||y||M||E?A=>A.call(vs,x,S,v,C,this):A=>A.attr("x",x).attr("y",S).attr("width",v-x).attr("height",C-S).attr("rx",b).attr("ry",g)).node()}}function Wh(t){return new qh(t)}const Cn={ariaLabel:"tip",fill:"var(--plot-background)",stroke:"currentColor"},Ph=new Set(["geometry","href","src","ariaLabel","scales"]);class zh extends $t{constructor(e,n={}){n.tip&&(n={...n,tip:!1}),n.title===void 0&&Yt(e)&&zo(e)&&(n={...n,title:dt});const{x:r,y:i,x1:o,x2:a,y1:s,y2:u,anchor:f,preferredAnchor:l="bottom",monospace:c,fontFamily:d=c?"ui-monospace, monospace":void 0,fontSize:h,fontStyle:p,fontVariant:m,fontWeight:w,lineHeight:b=1,lineWidth:g=20,frameAnchor:$,format:y,textAnchor:M="start",textOverflow:E,textPadding:x=8,title:v,pointerSize:S=12,pathFilter:C="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=n;super(e,{x:{value:o!=null&&a!=null?null:r,scale:"x",optional:!0},y:{value:s!=null&&u!=null?null:i,scale:"y",optional:!0},x1:{value:o,scale:"x",optional:a==null},y1:{value:s,scale:"y",optional:u==null},x2:{value:a,scale:"x",optional:o==null},y2:{value:u,scale:"y",optional:s==null},title:{value:v,optional:!0}},n,Cn),this.anchor=Rn(f,"anchor"),this.preferredAnchor=Rn(l,"preferredAnchor"),this.frameAnchor=sr($),this.textAnchor=Q(M,"middle"),this.textPadding=+x,this.pointerSize=+S,this.pathFilter=et(C),this.lineHeight=+b,this.lineWidth=+g,this.textOverflow=Pa(E),this.monospace=!!c,this.fontFamily=et(d),this.fontSize=nt(h),this.fontStyle=et(p),this.fontVariant=et(m),this.fontWeight=et(w);for(const A in Cn)A in this.channels&&(this[A]=Cn[A]);this.splitLines=Va(this),this.clipLine=Ha(this),this.format=typeof y=="string"||typeof y=="function"?{title:y}:{...y}}render(e,n,r,i,o){const a=this,{x:s,y:u,fx:f,fy:l}=n,{ownerSVGElement:c,document:d}=o,{anchor:h,monospace:p,lineHeight:m,lineWidth:w}=this,{textPadding:b,pointerSize:g,pathFilter:$}=this,{marginTop:y,marginLeft:M}=i,{x1:E,y1:x,x2:v,y2:S,x:C=E??v,y:A=x??S}=r,O=f?f(e.fx)-M:0,G=l?l(e.fy)-y:0,[B,q]=sn(this,i),H=Ma(r,B),Z=Sa(r,q),z=p?Mr:vr,T=z(ne);let L,N;"title"in r?(L=mi.call(this,{title:r.channels.title},n),N=Kh):(L=mi.call(this,r.channels,n),N=Uh);const k=rt("svg:g",o).call(Zt,this,i,o).call(za,this).call(Jt,this,{x:C&&s,y:A&&u}).call(V=>V.selectAll().data(e).enter().append("g").attr("transform",j=>`translate(${Math.round(H(j))},${Math.round(Z(j))})`).call(kt,this).call(j=>j.append("path").attr("filter",$)).call(j=>j.append("text").each(function(I){const P=jt(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");const R=N.call(a,I,e,L,n,r);if(typeof R=="string")for(const _ of a.splitLines(R))D(P,{value:a.clipLine(_)});else{const _=new Set;for(const Y of R){const{label:J=""}=Y;J&&_.has(J)||(_.add(J),D(P,Y))}}})));function D(V,{label:j,value:I,color:P,opacity:R}){j??="",I??="";const _=P!=null||R!=null;let Y,J=w*100;const[ut]=ae(j,J,z,T);if(ut>=0)j=j.slice(0,ut).trimEnd()+ne,Y=I.trim(),I="";else{(j||!I&&!_)&&(I=" "+I);const[ht]=ae(I,J-z(j),z,T);ht>=0&&(Y=I.trim(),I=I.slice(0,ht).trimEnd()+ne)}const tt=V.append("tspan").attr("x",0).attr("dy",`${m}em`).text("​");j&&tt.append("tspan").attr("font-weight","bold").text(j),I&&tt.append(()=>d.createTextNode(I)),_&&tt.append("tspan").text(" ■").attr("fill",P).attr("fill-opacity",R).style("user-select","none"),Y&&tt.append("title").text(Y)}function W(){const{width:V,height:j}=i.facet??i;k.selectChildren().each(function(I){let{x:P,width:R,height:_}=this.getBBox();R=Math.round(R),_=Math.round(_);let Y=h;if(Y===void 0){const tt=H(I)+O,ht=Z(I)+G,Bt=tt+R+g+b*2<V,le=tt-R-g-b*2>0,fn=ht+_+g+b*2<j,fe=ht-_-g-b*2>0;Y=Bt&&le?fn&&fe?a.preferredAnchor:fe?"bottom":"top":fn&&fe?Bt?"left":"right":(Bt||le)&&(fn||fe)?`${fe?"bottom":"top"}-${Bt?"left":"right"}`:a.preferredAnchor}const J=this.firstChild,ut=this.lastChild;if(J.setAttribute("d",Gh(Y,g,b,R,_)),P)for(const tt of ut.childNodes)tt.setAttribute("x",-P);ut.setAttribute("y",`${+Hh(Y,ut.childNodes.length,m).toFixed(6)}em`),ut.setAttribute("transform",`translate(${_h(Y,g,b,R,_)})`)}),k.attr("visibility",null)}return e.length&&(k.attr("visibility","hidden"),c.isConnected?Promise.resolve().then(W):typeof requestAnimationFrame<"u"&&requestAnimationFrame(W)),k.node()}}function Vh(t,{x:e,y:n,...r}={}){return r.frameAnchor===void 0&&([e,n]=Wo(e,n)),new zh(t,{...r,x:e,y:n})}function Hh(t,e,n){return/^top(?:-|$)/.test(t)?.94-n:-.29-e*n}function _h(t,e,n,r,i){switch(t){case"middle":return[-r/2,i/2];case"top-left":return[n,e+n];case"top":return[-r/2,e/2+n];case"top-right":return[-r-n,e+n];case"right":return[-e/2-r-n,i/2];case"bottom-left":return[n,-e-n];case"bottom":return[-r/2,-e/2-n];case"bottom-right":return[-r-n,-e-n];case"left":return[n+e/2,i/2]}}function Gh(t,e,n,r,i){const o=r+n*2,a=i+n*2;switch(t){case"middle":return`M${-o/2},${-a/2}h${o}v${a}h${-o}z`;case"top-left":return`M0,0l${e},${e}h${o-e}v${a}h${-o}z`;case"top":return`M0,0l${e/2},${e/2}h${(o-e)/2}v${a}h${-o}v${-a}h${(o-e)/2}z`;case"top-right":return`M0,0l${-e},${e}h${e-o}v${a}h${o}z`;case"right":return`M0,0l${-e/2},${-e/2}v${e/2-a/2}h${-o}v${a}h${o}v${e/2-a/2}z`;case"bottom-left":return`M0,0l${e},${-e}h${o-e}v${-a}h${-o}z`;case"bottom":return`M0,0l${e/2},${-e/2}h${(o-e)/2}v${-a}h${-o}v${a}h${(o-e)/2}z`;case"bottom-right":return`M0,0l${-e},${-e}h${e-o}v${-a}h${o}z`;case"left":return`M0,0l${e/2},${-e/2}v${e/2-a/2}h${o}v${a}h${-o}v${e/2-a/2}z`}}function mi(t,e){const n={};let r=this.format;r=pi(r,t,"x"),r=pi(r,t,"y"),this.format=r;for(const i in r){const o=r[i];if(!(o===null||o===!1))if(i==="fx"||i==="fy")n[i]=!0;else{const a=Pr(t,i);a&&(n[i]=a)}}for(const i in t){if(i in n||i in r||Ph.has(i)||(i==="x"||i==="y")&&t.geometry)continue;const o=Pr(t,i);if(o){if(o.scale==null&&o.defaultScale==="color")continue;n[i]=o}}this.facet&&(e.fx&&!("fx"in r)&&(n.fx=!0),e.fy&&!("fy"in r)&&(n.fy=!0));for(const i in n){const o=this.format[i];if(typeof o=="string"){const a=n[i]?.value??e[i]?.domain()??[];this.format[i]=(ct(a)?Gn:Zn)(o)}else if(o===void 0||o===!0){const a=e[i];this.format[i]=a?.bandwidth?Sr(a,a.domain()):xe}}return n}function pi(t,e,n){if(!(n in t))return t;const r=`${n}1`,i=`${n}2`;if((r in t||!(r in e))&&(i in t||!(i in e)))return t;const o=Object.entries(t),a=t[n];return o.splice(o.findIndex(([s])=>s===n)+1,0,[r,a],[i,a]),Object.fromEntries(o)}function Kh(t,e,{title:n}){return this.format.title(n.value[t],t)}function*Uh(t,e,n,r,i){for(const o in n){if(o==="fx"||o==="fy"){yield{label:Ye(r,n,o),value:this.format[o](e[o],t)};continue}if(o==="x1"&&"x2"in n||o==="y1"&&"y2"in n)continue;const a=n[o];if(o==="x2"&&"x1"in n)yield{label:yi(r,n,"x"),value:gi(this.format.x2,n.x1,a,t)};else if(o==="y2"&&"y1"in n)yield{label:yi(r,n,"y"),value:gi(this.format.y2,n.y1,a,t)};else{const s=a.value[t],u=a.scale;if(!Vt(s)&&u==null)continue;yield{label:Ye(r,n,o),value:this.format[o](s,t),color:u==="color"?i[o][t]:null,opacity:u==="opacity"?i[o][t]:null}}}}function gi(t,e,n,r){return n.hint?.length?`${t(n.value[r]-e.value[r],r)}`:`${t(e.value[r],r)}–${t(n.value[r],r)}`}function yi(t,e,n){const r=Ye(t,e,`${n}1`,n),i=Ye(t,e,`${n}2`,n);return r===i?r:`${r}–${i}`}function Ye(t,e,n,r=n){const i=e[n],o=t[i?.scale??n];return String(o?.label??i?.label??r)}function Ms(t={}){const{facet:e,style:n,title:r,subtitle:i,caption:o,ariaLabel:a,ariaDescription:s}=t,u=gr(t.className),f=t.marks===void 0?[]:wi(t.marks);f.push(...em(f));const l=Qh(e,t),c=new Map;for(const T of f){const L=xi(T,l,t);L&&c.set(T,L)}const d=new Map;l&&de(d,[l],t),de(d,c,t);const h=wi(nm(f,d,t));for(const T of h){const L=xi(T,l,t);L&&c.set(T,L)}f.unshift(...h);let p=Lc(d,t);if(p!==void 0){const T=l?vn(p,l):void 0;for(const N of f){if(N.facet===null||N.facet==="super")continue;const k=c.get(N);k!==void 0&&(k.facetsIndex=N.fx!=null||N.fy!=null?vn(p,k):T)}const L=new Set;for(const{facetsIndex:N}of c.values())N?.forEach((k,D)=>{k?.length>0&&L.add(D)});p.forEach(0<L.size&&L.size<p.length?(N,k)=>N.empty=!L.has(k):N=>N.empty=!1);for(const N of f)if(N.facet==="exclude"){const k=c.get(N);k!==void 0&&(k.facetsIndex=kc(k.facetsIndex))}}for(const T of K.keys())On(t[T])&&T!=="fx"&&T!=="fy"&&d.set(T,[]);const m=new Map;for(const T of f){if(m.has(T))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:L,channels:N}=c.get(T)??{},{data:k,facets:D,channels:W}=T.initialize(L,N,t);Ar(W,t),m.set(T,{data:k,facets:D,channels:W})}const w=Wn(de(d,m,t),t),b=yd(w,f,t);xc(w,b);const g=Yr(w),{fx:$,fy:y}=g,M=$||y?ma(w,b):b,E=$||y?lm(g,b):b,x=mr(t),v=x.document,S=Si("svg").call(v.documentElement);let C=S;x.ownerSVGElement=S,x.className=u,x.projection=zc(t,M),x.path=function(){return Un(this.projection??Yc(g))},x.filterFacets=(T,L)=>vn(p,{channels:L,groups:hr(T,L)}),x.getMarkState=T=>{const L=m.get(T),N=c.get(T);return{...L,channels:{...L.channels,...N?.channels}}},x.dispatchValue=T=>{C.value!==T&&(C.value=T,C.dispatchEvent(new x.document.defaultView.Event("input",{bubbles:!0})))};const A=new Set;for(const[T,L]of m)if(T.initializer!=null){const N=T.facet==="super"?E:M,k=T.initializer(L.data,L.facets,L.channels,g,N,x);if(k.data!==void 0&&(L.data=k.data),k.facets!==void 0&&(L.facets=k.facets),k.channels!==void 0){const{fx:D,fy:W,...V}=k.channels;Jh(V),Object.assign(L.channels,V);for(const j of Object.values(V)){const{scale:I}=j;I!=null&&!gf(K.get(I))&&(Ss(j,t),A.add(I))}(D!=null||W!=null)&&c.set(T,!0)}}if(A.size){const T=new Map;de(T,m,t,D=>A.has(D)),de(d,m,t,D=>A.has(D));const L=um(Wn(T,t),w),{scales:N,...k}=Yr(L);Object.assign(w,L),Object.assign(g,k),Object.assign(g.scales,N)}let O,G;p!==void 0&&(O={x:$?.domain(),y:y?.domain()},p=Dc(p,O),G=Nc($,y,b));for(const[T,L]of m)L.values=T.scale(L.channels,g,x);const{width:B,height:q}=b;jt(S).attr("class",u).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",B).attr("height",q).attr("viewBox",`0 0 ${B} ${q}`).attr("aria-label",a).attr("aria-description",s).call(T=>T.append("style").text(`:where(.${u}) {
  --plot-background: white;
  display: block;
  height: auto;
  height: intrinsic;
  max-width: 100%;
}
:where(.${u} text),
:where(.${u} tspan) {
  white-space: pre;
}`)).call(yr,n);for(const T of f){const{channels:L,values:N,facets:k}=m.get(T);if(p===void 0||T.facet==="super"){let D=null;if(k&&(D=k[0],D=T.filter(D,L,N),D.length===0))continue;const W=T.render(D,g,N,E,x);if(W==null)continue;S.appendChild(W)}else{let D;for(const W of p){if(!(T.facetAnchor?.(p,O,W)??!W.empty))continue;let V=null;if(k){const I=c.has(T);if(V=k[I?W.i:0],V=T.filter(V,L,N),V.length===0)continue;!I&&V===k[0]&&(V=Jl(V)),V.fx=W.x,V.fy=W.y,V.fi=W.i}const j=T.render(V,g,N,M,x);if(j!=null){(D??=jt(S).append("g")).append(()=>j).datum(W);for(const I of["aria-label","aria-description","aria-hidden","transform"])j.hasAttribute(I)&&(D.attr(I,j.getAttribute(I)),j.removeAttribute(I))}}D?.selectChildren().each(G)}}const H=wh(w,x,t),{figure:Z=r!=null||i!=null||o!=null||H.length>0}=t;Z&&(C=v.createElement("figure"),C.className=`${u}-figure`,C.style.maxWidth="initial",r!=null&&C.append(bi(v,r,"h2")),i!=null&&C.append(bi(v,i,"h3")),C.append(...H,S),o!=null&&C.append(Yh(v,o)),"value"in S&&(C.value=S.value,delete S.value)),C.scale=Ic(g.scales),C.legend=gh(w,x,t);const z=rc();return z>0&&jt(S).append("text").attr("x",B).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("⚠️").append("title").text(`${z.toLocaleString("en-US")} warning${z===1?"":"s"}. Please check the console.`),C}function bi(t,e,n){if(e.ownerDocument)return e;const r=t.createElement(n);return r.append(e),r}function Yh(t,e){const n=t.createElement("figcaption");return n.append(e),n}function wi(t){return t.flat(1/0).filter(e=>e!=null).map(Xh)}function Xh(t){return typeof t.render=="function"?t:new Zh(t)}class Zh extends $t{constructor(e){if(typeof e!="function")throw new TypeError("invalid mark; missing render function");super(),this.render=e}render(){}}function Ar(t,e){for(const n in t)Ss(t[n],e);return t}function Ss(t,e){const{scale:n,transform:r=!0}=t;if(n==null||!r)return;const{type:i,percent:o,interval:a,transform:s=o?u=>u==null?NaN:u*100:Po(a,i)}=e[n]??{};s!=null&&(t.value=U(t.value,s),t.transform=!1)}function Jh(t){for(const e in t)ta(e,t[e])}function de(t,e,n,r=Hl){for(const{channels:i}of e.values())for(const o in i){const a=i[o],{scale:s}=a;if(s!=null&&r(s))if(s==="projection"){if(!Gc(n)){const u=n.x?.domain===void 0,f=n.y?.domain===void 0;if(u||f){const[l,c]=Uc(a);u&&In(t,"x",l),f&&In(t,"y",c)}}}else In(t,s,a)}return t}function In(t,e,n){const r=t.get(e);r!==void 0?r.push(n):t.set(e,[n])}function Qh(t,e){if(t==null)return;const{x:n,y:r}=t;if(n==null&&r==null)return;const i=ie(t.data);if(i==null)throw new Error("missing facet data");const o={};n!=null&&(o.fx=be(i,{value:n,scale:"fx"})),r!=null&&(o.fy=be(i,{value:r,scale:"fy"})),Ar(o,e);const a=hr(i,o);return{channels:o,groups:a,data:t.data}}function xi(t,e,n){if(t.facet===null||t.facet==="super")return;const{fx:r,fy:i}=t;if(r!=null||i!=null){const u=ie(t.data??r??i);if(u===void 0)throw new Error(`missing facet data in ${t.ariaLabel}`);if(u===null)return;const f={};return r!=null&&(f.fx=be(u,{value:r,scale:"fx"})),i!=null&&(f.fy=be(u,{value:i,scale:"fy"})),Ar(f,n),{channels:f,groups:hr(u,f)}}if(e===void 0)return;const{channels:o,groups:a,data:s}=e;if(t.facet!=="auto"||t.data===s)return{channels:o,groups:a};s.length>0&&(a.size>1||a.size===1&&o.fx&&o.fy&&[...a][0][1].size>1)&&ge(ie(t.data))===ge(s)&&Wt(`Warning: the ${t.ariaLabel} mark appears to use faceted data, but isn’t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function tm(t,e={}){return Ue({...e,x:null,y:null},(n,r,i,o,a,s)=>s.getMarkState(t))}function em(t){const e=[];for(const n of t){let r=n.tip;if(r){r===!0?r={}:typeof r=="string"&&(r={pointer:r});let{pointer:i,preferredAnchor:o}=r;i=/^x$/i.test(i)?xd:/^y$/i.test(i)?ii:wd,r=i(tm(n,r)),r.title=null,o===void 0&&(r.preferredAnchor=i===ii?"left":"bottom");const a=Vh(n.data,r);a.facet=n.facet,a.facetAnchor=n.facetAnchor,e.push(a)}}return e}function nm(t,e,n){let{projection:r,x:i={},y:o={},fx:a={},fy:s={},axis:u,grid:f,facet:l={},facet:{axis:c=u,grid:d}=l,x:{axis:h=u,grid:p=h===null?null:f}=i,y:{axis:m=u,grid:w=m===null?null:f}=o,fx:{axis:b=c,grid:g=b===null?null:d}=a,fy:{axis:$=c,grid:y=$===null?null:d}=s}=n;(r||!On(i)&&!$i("x",t))&&(h=p=null),(r||!On(o)&&!$i("y",t))&&(m=w=null),e.has("fx")||(b=g=null),e.has("fy")||($=y=null),h===void 0&&(h=!je(t,"x")),m===void 0&&(m=!je(t,"y")),b===void 0&&(b=!je(t,"fx")),$===void 0&&($=!je(t,"fy")),h===!0&&(h="bottom"),m===!0&&(m="left"),b===!0&&(b=h==="top"||h===null?"bottom":"top"),$===!0&&($=m==="right"||m===null?"left":"right");const M=[];return Be(M,y,ah,s),Re(M,$,Qd,"right","left",l,s),Be(M,g,uh,a),Re(M,b,th,"top","bottom",l,a),Be(M,w,oh,o),Re(M,m,ts,"left","right",n,o),Be(M,p,sh,i),Re(M,h,es,"bottom","top",n,i),M}function Re(t,e,n,r,i,o,a){if(!e)return;const s=rm(e);a=im(s?r:e,o,a);const{line:u}=a;(n===ts||n===es)&&u&&!ye(u)&&t.push(Wh(om(a))),t.push(n(a)),s&&t.push(n({...a,anchor:i,label:null}))}function Be(t,e,n,r){!e||ye(e)||t.push(n(am(e,r)))}function rm(t){return/^\s*both\s*$/i.test(t)}function im(t,e,{line:n=e.line,ticks:r,tickSize:i,tickSpacing:o,tickPadding:a,tickFormat:s,tickRotate:u,fontVariant:f,ariaLabel:l,ariaDescription:c,label:d=e.label,labelAnchor:h,labelArrow:p=e.labelArrow,labelOffset:m}){return{anchor:t,line:n,ticks:r,tickSize:i,tickSpacing:o,tickPadding:a,tickFormat:s,tickRotate:u,fontVariant:f,ariaLabel:l,ariaDescription:c,label:d,labelAnchor:h,labelArrow:p,labelOffset:m}}function om(t){const{anchor:e,line:n}=t;return{anchor:e,facetAnchor:e+"-empty",stroke:n===!0?void 0:n}}function am(t,{stroke:e=en(t)?t:void 0,ticks:n=sm(t)?t:void 0,tickSpacing:r,ariaLabel:i,ariaDescription:o}){return{stroke:e,ticks:n,tickSpacing:r,ariaLabel:i,ariaDescription:o}}function sm(t){switch(typeof t){case"number":return!0;case"string":return!en(t)}return Yt(t)||typeof t?.range=="function"}function je(t,e){const n=`${e}-axis `;return t.some(r=>r.ariaLabel?.startsWith(n))}function $i(t,e){for(const n of e)for(const r in n.channels){const{scale:i}=n.channels[r];if(i===t||i==="projection")return!0}return!1}function um(t,e){for(const n in t){const r=t[n],i=e[n];r.label===void 0&&i&&(r.label=i.label)}return t}function lm({fx:t,fy:e},n){const{marginTop:r,marginRight:i,marginBottom:o,marginLeft:a,width:s,height:u}=dr(n),f=t&&vi(t),l=e&&vi(e);return{marginTop:e?l[0]:r,marginRight:t?s-f[1]:i,marginBottom:e?u-l[1]:o,marginLeft:t?f[0]:a,inset:{marginTop:n.marginTop,marginRight:n.marginRight,marginBottom:n.marginBottom,marginLeft:n.marginLeft},width:s,height:u}}function vi(t){const e=t.domain();if(e.length===0)return[0,t.bandwidth()];let n=t(e[0]),r=t(e[e.length-1]);return r<n&&([n,r]=[r,n]),[n,r+t.bandwidth()]}const fm={ariaLabel:"bar"};class cm extends $t{constructor(e,n,r={},i=fm){super(e,n,r,i),xs(this,r),$s(this,r)}render(e,n,r,i,o){const{rx:a,ry:s,rx1y1:u,rx1y2:f,rx2y1:l,rx2y2:c}=this,d=this._x(n,r,i),h=this._y(n,r,i),p=this._width(n,r,i),m=this._height(n,r,i);return rt("svg:g",o).call(Zt,this,i,o).call(this._transform,this,n).call(w=>w.selectAll().data(e).enter().call(u||f||l||c?b=>b.append("path").call(kt,this).call(vs,d,h,Mi(d,p),Mi(h,m),this).call(_t,this,r):b=>b.append("rect").call(kt,this).attr("x",d).attr("width",p).attr("y",h).attr("height",m).call(F,"rx",a).call(F,"ry",s).call(_t,this,r))).node()}_x(e,{x:n},{marginLeft:r}){const{insetLeft:i}=this;return n?o=>n[o]+i:r+i}_y(e,{y:n},{marginTop:r}){const{insetTop:i}=this;return n?o=>n[o]+i:r+i}_width({x:e},{x:n},{marginRight:r,marginLeft:i,width:o}){const{insetLeft:a,insetRight:s}=this,u=n&&e?e.bandwidth():o-r-i;return Math.max(0,u-a-s)}_height({y:e},{y:n},{marginTop:r,marginBottom:i,height:o}){const{insetTop:a,insetBottom:s}=this,u=n&&e?e.bandwidth():o-r-i;return Math.max(0,u-a-s)}}function Mi(t,e){return typeof t=="function"&&typeof e=="function"?n=>t(n)+e(n):typeof t=="function"?n=>t(n)+e:typeof e=="function"?n=>t+e(n):t+e}class dm extends cm{constructor(e,n={},r){const{x1:i,x2:o,y:a}=n;super(e,{x1:{value:i,scale:"x"},x2:{value:o,scale:"x"},y:{value:a,scale:"y",type:"band",optional:!0}},n,r)}_transform(e,n,{x:r}){e.call(Jt,n,{x:r},0,0)}_x({x:e},{x1:n,x2:r},{marginLeft:i}){const{insetLeft:o}=this;return oe(e)?i+o:a=>Math.min(n[a],r[a])+o}_width({x:e},{x1:n,x2:r},{marginRight:i,marginLeft:o,width:a}){const{insetLeft:s,insetRight:u}=this;return oe(e)?a-i-o-s-u:f=>Math.max(0,Math.abs(r[f]-n[f])-s-u)}}function hm(t,e={}){return Yl(e)||(e={...e,y:Oo,x2:dt}),new dm(t,Mh(Fa(xh(e))))}$t.prototype.plot=function({marks:t=[],...e}={}){return Ms({...e,marks:[...t,this]})};const km=()=>{const t=cn.useRef(null),e=["Alaska","Ala.","Ark.","Ariz.","Calif.","Colo.","Conn.","D.C.","Del.","Fla.","Ga.","Hawaii","Iowa","Idaho","Ill.","Ind.","Kan.","Ky.","La.","Mass.","Md.","Maine","Mich.","Minn.","Mo.","Miss.","Mont.","N.C.","N.D.","Neb.","N.H.","N.J.","N.M","Nev.","N.Y.","Ohio","Okla.","Ore.","Pa.","R.I.","S.C.","S.D.","Tenn.","Texas","Utah","Va.","Vt.","Wash.","Wis.","W.Va.","Wyo."],[n,r]=cn.useState("Measles"),i=async()=>{let a=await fetch("/assets/vaccines.json");a=await a.json();let s=a.flatMap(({title:l,data:{values:{data:c}}})=>c.map(([d,h,p])=>({disease:l,date:new Date(`${d}-01-01`),state:e[h],cases:p}))),u=a.map(({title:l,data:{chart_options:{vaccine_year:c}}})=>({disease:l,date:new Date(Date.UTC(c,c%1*12,1))}));return Ms({marginBottom:30,padding:0,round:!1,label:null,x:{axis:"top"},color:{scheme:"purd",legend:!0,type:"sqrt",label:"每10万人中的病例"},marks:[hm(s.filter(l=>l.disease===n),{x:"date",y:"state",interval:"year",inset:.5,fill:"cases",title:"cases"}),Ba([u.find(l=>l.disease===n)],{x:"date"}),$r([u.find(l=>l.disease===n)],{x:"date",dy:4,lineAnchor:"top",frameAnchor:"bottom",text:l=>`${l.date.getUTCFullYear()}
Vaccine introduced`})],document})};return cn.useEffect(()=>(i().then(o=>{t.current?.appendChild(o)}),()=>{t.current.innerHTML=""})),lt.jsxs(lt.Fragment,{children:[lt.jsx("h2",{children:n}),lt.jsxs("select",{"data-te-select-init":!0,value:n,onChange:o=>{r(o.target.value)},children:[lt.jsx("option",{value:"Measles",children:"Measles"}),lt.jsx("option",{value:"Hepatitis A",children:"Hepatitis A"}),lt.jsx("option",{value:"Mumps",children:"Mumps"}),lt.jsx("option",{value:"Pertussis (Whooping Cough)",children:"Pertussis (Whooping Cough)"}),lt.jsx("option",{value:"Polio",children:"Polio"}),lt.jsx("option",{value:"Rubella",children:"Rubella"}),lt.jsx("option",{value:"Smallpox",children:"Smallpox"})]}),lt.jsx("div",{ref:t})]})};export{km as default};
//# sourceMappingURL=plot.N7HBhZVF.js.map
