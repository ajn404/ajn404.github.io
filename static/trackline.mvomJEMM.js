import{j as a}from"./jsx-runtime.DZ3s2XAB.js";import{u as y}from"./useCesium.MJG7k46j.js";import{r as n}from"./index.D4IXJ7me.js";/* empty css                         */import{Button as I}from"./button.Bu1Rz1rf.js";import"./_sentry-release-injection-file.B-UwqLso.js";import{P as E,C as f,a as m}from"./Viewer.sNypZuuW.js";import"./_commonjsHelpers.DqoTaOmB.js";import"./index.CEsCW6vM.js";import"./index.Dr6BPF-b.js";import"./utils.CQ2vwKer.js";(function(){try{var i=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},e=new i.Error().stack;e&&(i._sentryDebugIds=i._sentryDebugIds||{},i._sentryDebugIds[e]="fb4d1262-060c-4d14-bf78-6c637e57c822",i._sentryDebugIdIdentifier="sentry-dbid-fb4d1262-060c-4d14-bf78-6c637e57c822")}catch{}})();const A=()=>{const{cesiumContainerRef:i,viewer:e}=y(),[o,g]=n.useState(),[c,p]=n.useState(null),[l,b]=n.useState({latitude:39,longitude:116});n.useEffect(()=>{if(!navigator.geolocation){alert("浏览器不支持地理位置功能");return}navigator.permissions.query({name:"geolocation"}).then(r=>{r.state==="denied"&&alert("请允许地理位置权限以使用此功能")})},[]);const u=n.useCallback((r,t)=>{if(!e.current)return;o&&e.current.entities.remove(o);const s=e.current.entities.add({position:f.fromDegrees(r,t),point:new E({color:m.RED,pixelSize:10,outlineColor:m.WHITE,outlineWidth:2}),model:{uri:"/assets/models/gltf/Cesium_Man.glb",scale:2}});g(s),e.current.camera.flyTo({destination:f.fromDegrees(r,t,1e3),orientation:{heading:0,roll:0}})},[e.current,o]),h=n.useCallback(()=>{const r=navigator.geolocation.watchPosition(t=>{const{latitude:s,longitude:d}=t.coords;b({latitude:s,longitude:d}),u(d,s)},t=>{switch(t.code){case t.PERMISSION_DENIED:alert("用户拒绝了地理位置请求");break;case t.POSITION_UNAVAILABLE:alert("无法获取位置信息");break;case t.TIMEOUT:alert("请求超时");break;default:alert("未知错误")}},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0});p(r)},[u]);return n.useEffect(()=>()=>{c&&navigator.geolocation.clearWatch(c),o&&e.current&&e.current.entities.remove(o)},[c,o]),a.jsxs(a.Fragment,{children:[a.jsx("div",{ref:i,style:{width:"100%",height:"500px",userSelect:"none",position:"relative",zIndex:0}}),a.jsx(I,{onClick:h,children:"开始实时定位"}),a.jsxs("div",{className:"position-info",children:["当前坐标: ",l.latitude?.toFixed(5),","," ",l.longitude?.toFixed(5)]})]})};export{A as default};
//# sourceMappingURL=trackline.mvomJEMM.js.map
