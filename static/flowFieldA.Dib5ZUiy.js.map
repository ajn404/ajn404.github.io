{"version":3,"file":"flowFieldA.Dib5ZUiy.js","sources":["../../src/components/react/p5/art/flowFieldA.tsx"],"sourcesContent":["import type p5 from \"p5\";\nimport Basic from \"@components/react/p5/index.tsx\";\nimport { Slider } from \"@shadcn/ui/slider\";\nimport { cn } from \"@utils/utils\";\nimport { useDebounce } from \"@uidotdev/usehooks\";\nimport { useCallback, useEffect, useState } from \"react\";\n\nexport default () => {\n  const [density, setDensity] = useState(30);\n  const debounceDensity = useDebounce(density, 200);\n\n  const sketch = useCallback(\n    (p: p5) => {\n      let points: p5.Vector[];\n      let mult: number;\n\n      const setup = () => {\n        points = [];\n        mult = 0.005;\n        p.createCanvas(p.windowWidth / 2, p.windowWidth / 2);\n        p.noiseDetail(1, 0.5);\n        p.angleMode(p.DEGREES);\n        p.frameRate(120);\n        p.pixelDensity(3);\n        p.background(0);\n\n        const densityValue = debounceDensity || 30; // 使用默认值30\n        const space = p.width / densityValue;\n\n        for (let i = 0; i < p.width; i += space) {\n          for (let j = 0; j < p.height; j += space) {\n            let point = p.createVector(i, j);\n            points.push(point);\n          }\n        }\n      };\n\n      const draw = () => {\n        p.noStroke();\n        for (let i = 0; i < points.length; i++) {\n          // 预先计算颜色值\n          const r = p.map(points[i].x, 0, p.width, 50, 255);\n          const g = p.map(points[i].y, 0, p.height, 255, 50);\n          const b = p.map(points[i].x, 0, p.width, 255, 50);\n          p.fill(r, g, b);\n\n          const noiseX = points[i].x * mult;\n          const noiseY = points[i].y * mult;\n          const angle = p.map(p.noise(noiseX, noiseY), 0, 1, 0, 720);\n          const walk = p.createVector(p.cos(angle), p.sin(angle)); // 简化向量创建\n          points[i].add(walk);\n          p.ellipse(points[i].x, points[i].y, 1, 1);\n        }\n      };\n\n      const resize = setup;\n      p.setup = setup;\n      p.draw = draw;\n      p.windowResized = resize;\n    },\n    [debounceDensity]\n  );\n\n  return (\n    <>\n      密度 {density}\n      <Slider\n        defaultValue={[30]}\n        max={100}\n        min={20}\n        step={1}\n        className={cn(\"w-[100%] m-4\")}\n        onValueChange={value => {\n          setDensity(value[0]);\n        }}\n        value={[density]}\n      />\n      <Basic key={debounceDensity} sketch={sketch} /> {/* 添加key属性 */}\n    </>\n  );\n};\n"],"names":["flowFieldA","density","setDensity","useState","debounceDensity","useDebounce","sketch","useCallback","p","points","mult","setup","densityValue","space","j","point","draw","i","r","g","b","noiseX","noiseY","angle","walk","resize","jsxs","Fragment","jsx","Slider","cn","value","Basic"],"mappings":"u+BAOA,MAAAA,EAAe,IAAM,CACnB,KAAM,CAACC,EAASC,CAAU,EAAIC,EAAAA,SAAS,EAAE,EACnCC,EAAkBC,EAAYJ,EAAS,GAAG,EAE1CK,EAASC,EAAA,YACZC,GAAU,CACL,IAAAC,EACAC,EAEJ,MAAMC,EAAQ,IAAM,CAClBF,EAAS,CAAC,EACHC,EAAA,KACPF,EAAE,aAAaA,EAAE,YAAc,EAAGA,EAAE,YAAc,CAAC,EACjDA,EAAA,YAAY,EAAG,EAAG,EAClBA,EAAA,UAAUA,EAAE,OAAO,EACrBA,EAAE,UAAU,GAAG,EACfA,EAAE,aAAa,CAAC,EAChBA,EAAE,WAAW,CAAC,EAEd,MAAMI,EAAeR,GAAmB,GAClCS,EAAQL,EAAE,MAAQI,EAExB,QAAS,EAAI,EAAG,EAAIJ,EAAE,MAAO,GAAKK,EAChC,QAASC,EAAI,EAAGA,EAAIN,EAAE,OAAQM,GAAKD,EAAO,CACxC,IAAIE,EAAQP,EAAE,aAAa,EAAGM,CAAC,EAC/BL,EAAO,KAAKM,CAAK,CAAA,CAGvB,EAEMC,EAAO,IAAM,CACjBR,EAAE,SAAS,EACX,QAASS,EAAI,EAAGA,EAAIR,EAAO,OAAQQ,IAAK,CAEhC,MAAAC,EAAIV,EAAE,IAAIC,EAAOQ,CAAC,EAAE,EAAG,EAAGT,EAAE,MAAO,GAAI,GAAG,EAC1CW,EAAIX,EAAE,IAAIC,EAAOQ,CAAC,EAAE,EAAG,EAAGT,EAAE,OAAQ,IAAK,EAAE,EAC3CY,EAAIZ,EAAE,IAAIC,EAAOQ,CAAC,EAAE,EAAG,EAAGT,EAAE,MAAO,IAAK,EAAE,EAC9CA,EAAA,KAAKU,EAAGC,EAAGC,CAAC,EAEd,MAAMC,EAASZ,EAAOQ,CAAC,EAAE,EAAIP,EACvBY,EAASb,EAAOQ,CAAC,EAAE,EAAIP,EACvBa,EAAQf,EAAE,IAAIA,EAAE,MAAMa,EAAQC,CAAM,EAAG,EAAG,EAAG,EAAG,GAAG,EACnDE,EAAOhB,EAAE,aAAaA,EAAE,IAAIe,CAAK,EAAGf,EAAE,IAAIe,CAAK,CAAC,EAC/Cd,EAAAQ,CAAC,EAAE,IAAIO,CAAI,EAChBhB,EAAA,QAAQC,EAAOQ,CAAC,EAAE,EAAGR,EAAOQ,CAAC,EAAE,EAAG,EAAG,CAAC,CAAA,CAE5C,EAEMQ,EAASd,EACfH,EAAE,MAAQG,EACVH,EAAE,KAAOQ,EACTR,EAAE,cAAgBiB,CACpB,EACA,CAACrB,CAAe,CAClB,EAEA,OACIsB,EAAA,KAAAC,WAAA,CAAA,SAAA,CAAA,MACI1B,EACJ2B,EAAA,IAACC,EAAA,CACC,aAAc,CAAC,EAAE,EACjB,IAAK,IACL,IAAK,GACL,KAAM,EACN,UAAWC,EAAG,cAAc,EAC5B,cAAwBC,GAAA,CACX7B,EAAA6B,EAAM,CAAC,CAAC,CACrB,EACA,MAAO,CAAC9B,CAAO,CAAA,CACjB,EACA2B,EAAAA,IAACI,EAA4B,CAAA,OAAA1B,CAAA,EAAjBF,CAAiC,EAAE,GAAA,EACjD,CAEJ"}