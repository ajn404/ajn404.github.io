{"version":3,"mappings":";8sBAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GASA,MAAMA,EAAWC,EAAiB,WAAY,CAC5C,CAAC,OAAQ,CAAE,EAAG,4CAA6C,IAAK,QAAQ,CAAE,EAC1E,CAAC,WAAY,CAAE,OAAQ,mBAAoB,IAAK,QAAQ,CAAE,EAC1D,CAAC,OAAQ,CAAE,GAAI,KAAM,GAAI,KAAM,GAAI,KAAM,GAAI,IAAK,IAAK,QAAU,EACnE,CAAC,ECLKC,EAAyBC,GAAU,CACvC,IAAIC,EAAO,EACXD,EAAE,MAAQ,IAAM,CACZA,EAAA,aAAa,IAAK,GAAG,EACvBA,EAAE,UAAU,EAAE,CAChB,EACAA,EAAE,KAAO,IAAM,CACb,IAAIE,EAAQF,EAAE,MAAMC,CAAI,GAAKD,EAAE,MAAQ,IACvCA,EAAE,WAAW,GAAG,EAChBA,EAAE,SAAS,EACTA,EAAA,KAAK,GAAI,GAAI,EAAE,EACTC,GAAA,IACRD,EAAE,QAAQE,EAAOF,EAAE,OAAS,EAAG,GAAI,EAAE,CACvC,CACF,EASMG,EAAS,CAAC,CACd,QAAAC,EACA,SAAAC,CACF,IAIEC,EAAA,IAAC,UACC,KAAK,SACL,QAAAF,EACA,UAAU,82BAET,SAAAC,CAAA,CACH,EAGIE,EAAWC,EAAA,KACf,CAAC,CAAE,OAAAC,EAAQ,aAAAC,EAAe,GAAO,UAAAC,EAAY,GAAI,MAAAC,EAAQ,MAAgB,CACjE,MAAAC,EAAYC,SAAuB,IAAI,EACvCC,EAAgBD,SAAuB,IAAI,EAC3C,CAACd,EAAGgB,CAAI,EAAIC,WAAoB,IAAI,EACpC,CAACC,EAASC,CAAU,EAAIF,WAAS,EAAK,EACtCG,EAAYN,SAAO,EAAK,EAExBO,EAAQ,SAAY,CACxB,GAAIR,EAAU,QAAS,CACf,MAAAS,EAAW,MAAMC,EAAA,WAAO,sBAAI,OAAAC,KAAA,+BAClCR,EAAK,IAAIM,EAAS,QAAQb,GAAUV,EAAec,EAAU,OAAO,CAAC,EAEzE,EAEMY,EAAS,SAAY,CACrBzB,IACFA,EAAE,OAAO,EACTgB,EAAK,IAAI,EAEb,EAEMU,EAAO,IAAM,CACb1B,GAAKA,EAAE,UAAU,KAAK,OAAO,CACnC,EAEM2B,EAAQ,SAAY,CACpB3B,GAAK,CAACA,EAAE,UAAU,KAAK,KAAK,CAClC,EAEM4B,EAAO,SAAY,CACvBT,EAAW,EAAI,EACf,MAAME,EAAM,EACZF,EAAW,EAAK,CAClB,EACMU,EAAW,SAAY7B,EAAE,QAAQ,SAAU,EAAG,CAAE,MAAO,EAAG,EAEhE8B,mBAAU,IAAM,CACd,MAAMC,EAAM,IAAI,qBAAqB,MAAO,CAACC,CAAK,IAAM,CAClDA,EAAM,gBAEN,CAACZ,EAAU,SACXP,EAAU,SACV,CAACA,EAAU,QAAQ,YAEnB,MAAMe,EAAK,EACXR,EAAU,QAAU,IAEhBO,EAAA,GAEDD,EAAA,CACP,CACD,EAED,OAAIX,EAAc,SAAagB,EAAA,QAAQhB,EAAc,OAAO,EAErD,IAAM,CACXgB,EAAI,WAAW,EACRN,EAAA,CACT,EACD,EAEDK,YAAU,IAAM,CACTF,EAAA,GACJ,CAACnB,CAAM,CAAC,EAGTwB,EAAA,KAAC,OACC,IAAKlB,EACL,UAAW,8BAA8BJ,CAAS,GAClD,MAAAC,EAEA,UAAAN,EAAA,IAAC,OACC,IAAKO,EACL,UAAU,oEACX,EACAK,GACCZ,EAAA,IAAC,MAAI,WAAU,2EAA2E,SAE1F,gBAED,CAACY,GAAWR,GACVuB,EAAA,YAAI,UAAW,uCACd,UAAA3B,MAACH,EAAO,SAASuB,EACf,SAAApB,MAAC4B,GAAS,GACZ,QACC/B,EAAO,SAASwB,EACf,SAAArB,MAAC6B,GAAS,GACZ,QACChC,EAAO,SAAS0B,EACf,SAAAvB,EAAA,IAAC8B,IAAa,CAChB,GACF,IAEJ,EAGN","names":["Download","createLucideIcon","defaultSketch","p","xoff","noise","Button","onClick","children","jsx","P5Canvas","memo","sketch","showControls","className","style","container","useRef","trueContainer","setP","useState","loading","setLoading","doOnceRef","start","p5Module","__vitePreload","n","remove","stop","begin","init","download","useEffect","obs","entry","jsxs","StopIcon","PlayIcon","DownloadIcon"],"ignoreList":[0],"sources":["../../node_modules/.pnpm/lucide-react@0.315.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/download.js","../../src/components/react/p5/index.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.315.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Download = createLucideIcon(\"Download\", [\n  [\"path\", { d: \"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\", key: \"ih7n3h\" }],\n  [\"polyline\", { points: \"7 10 12 15 17 10\", key: \"2ggqvy\" }],\n  [\"line\", { x1: \"12\", x2: \"12\", y1: \"15\", y2: \"3\", key: \"1vk2je\" }]\n]);\n\nexport { Download as default };\n//# sourceMappingURL=download.js.map\n","import \"./index.scss\";\nimport type p5 from \"p5\";\nimport { useEffect, useRef, memo, useState } from \"react\";\nimport { PlayIcon, StopIcon } from \"@radix-ui/react-icons\";\nimport { DownloadIcon } from \"lucide-react\";\n\ntype Sketch = (p: p5) => void;\n\nconst defaultSketch: Sketch = (p: p5) => {\n  let xoff = 0.0;\n  p.setup = () => {\n    p.createCanvas(100, 100);\n    p.frameRate(60);\n  };\n  p.draw = () => {\n    let noise = p.noise(xoff) * (p.width - 50);\n    p.background(255);\n    p.noStroke();\n    p.fill(34, 39, 54);\n    xoff += 0.01;\n    p.ellipse(noise, p.height / 2, 25, 25);\n  };\n};\n\ninterface Props {\n  sketch: Sketch;\n  showControls?: Boolean; // defaults to false\n  className?: string; // Optional custom className\n  style?: React.CSSProperties; // Optional inline styles\n}\n\nconst Button = ({\n  onClick,\n  children,\n}: {\n  onClick: () => void;\n  children: React.ReactNode;\n}) => (\n  <button\n    type=\"button\"\n    onClick={onClick}\n    className=\"inline-block text-skin-inverted rounded bg-skin-inverted px-6 pb-2 pt-2.5 text-xs font-medium uppercase leading-normal shadow-[0_4px_9px_-4px_#cbcbcb] transition duration-150 ease-in-out hover:bg-neutral-100 hover:shadow-[0_8px_9px_-4px_rgba(203,203,203,0.3),0_4px_18px_0_rgba(203,203,203,0.2)] focus:bg-neutral-100 focus:shadow-[0_8px_9px_-4px_rgba(203,203,203,0.3),0_4px_18px_0_rgba(203,203,203,0.2)] focus:outline-none focus:ring-0 active:bg-neutral-200 active:shadow-[0_8px_9px_-4px_rgba(203,203,203,0.3),0_4px_18px_0_rgba(203,203,203,0.2)] dark:shadow-[0_4px_9px_-4px_rgba(251,251,251,0.3)] dark:hover:shadow-[0_8px_9px_-4px_rgba(251,251,251,0.1),0_4px_18px_0_rgba(251,251,251,0.05)] dark:focus:shadow-[0_8px_9px_-4px_rgba(251,251,251,0.1),0_4px_18px_0_rgba(251,251,251,0.05)] dark:active:shadow-[0_8px_9px_-4px_rgba(251,251,251,0.1),0_4px_18px_0_rgba(251,251,251,0.05)]\"\n  >\n    {children}\n  </button>\n);\n\nconst P5Canvas = memo(\n  ({ sketch, showControls = false, className = \"\", style = {} }: Props) => {\n    const container = useRef<HTMLDivElement>(null);\n    const trueContainer = useRef<HTMLDivElement>(null);\n    const [p, setP] = useState<p5 | null>(null);\n    const [loading, setLoading] = useState(false);\n    const doOnceRef = useRef(false); // Manage doOnce locally\n\n    const start = async () => {\n      if (container.current) {\n        const p5Module = await import(\"p5\");\n        setP(new p5Module.default(sketch || defaultSketch, container.current));\n      }\n    };\n\n    const remove = async () => {\n      if (p) {\n        p.remove();\n        setP(null);\n      }\n    };\n\n    const stop = () => {\n      if (p && p.isLooping()) p.noLoop();\n    };\n\n    const begin = async () => {\n      if (p && !p.isLooping()) p.loop();\n    };\n\n    const init = async () => {\n      setLoading(true);\n      await start();\n      setLoading(false);\n    };\n    const download = async () => p.saveGif(\"sketch\", 5, { delay: 1 });\n\n    useEffect(() => {\n      const obs = new IntersectionObserver(async ([entry]) => {\n        if (entry.isIntersecting) {\n          if (\n            !doOnceRef.current &&\n            container.current &&\n            !container.current.innerHTML\n          ) {\n            await init();\n            doOnceRef.current = true;\n          }\n          begin(); // 自动启动\n        } else {\n          stop();\n        }\n      });\n\n      if (trueContainer.current) obs.observe(trueContainer.current);\n\n      return () => {\n        obs.disconnect();\n        remove();\n      };\n    });\n\n    useEffect(() => {\n      init();\n    }, [sketch]);\n\n    return (\n      <div\n        ref={trueContainer}\n        className={`p5_container mt-4 relative ${className}`}\n        style={style}\n      >\n        <div\n          ref={container}\n          className=\"w-full max-w-full min-h-[240px]  grid items-center justify-center\"\n        ></div>\n        {loading && (\n          <div className=\"absolute inset-o w-full h-full flex justify-center items-center text-2xl\">\n            加载p5.js中...\n          </div>\n        )}\n        {!loading && showControls && (\n          <div className={\"flex pt-4 select-none justify-around\"}>\n            <Button onClick={stop}>\n              <StopIcon />\n            </Button>\n            <Button onClick={begin}>\n              <PlayIcon />\n            </Button>\n            <Button onClick={download}>\n              <DownloadIcon />\n            </Button>\n          </div>\n        )}\n      </div>\n    );\n  }\n);\n\nexport default P5Canvas;\n"],"file":"static/index.FIxribuB.js"}