{"version":3,"file":"force.rC-npv8j.js","sources":["../../src/components/react/d3/practice/force.tsx"],"sourcesContent":["import React, { useEffect, useRef } from \"react\";\nimport * as d3 from \"d3\";\nimport data from \"./force.json\";\nimport type { SimulationNodeDatum } from \"d3\";\n\ninterface Node {\n  id: string;\n  group: number;\n}\n\ninterface Link {\n  source: string;\n  target: string;\n  value: number;\n}\n\ninterface ForceGraphProps {\n  nodes: Node[];\n  links: Link[];\n}\n\nconst ForceGraph: React.FC<ForceGraphProps> = ({ nodes, links }) => {\n  const ref = useRef<SVGSVGElement | null>(null);\n\n  useEffect(() => {\n    const svgElement = d3.select(ref.current);\n    const width = 928;\n    const height = 680;\n\n    const color = d3.scaleOrdinal(d3.schemeCategory10);\n\n    const linkData = data.links.map(d => ({ ...d }));\n    const nodeData = data.nodes.map(d => ({ ...d }));\n\n    const simulation = d3\n      .forceSimulation(nodeData as SimulationNodeDatum[])\n      .force(\n        \"link\",\n        d3.forceLink(linkData).id((d: any) => d.id)\n      )\n      .force(\"charge\", d3.forceManyBody())\n      .force(\"x\", d3.forceX())\n      .force(\"y\", d3.forceY());\n\n    svgElement\n      .attr(\"width\", width)\n      .attr(\"height\", height)\n      .attr(\"viewBox\", [-width / 2, -height / 2, width, height])\n      .attr(\"style\", \"max-width: 100%; height: auto;\");\n\n    const link = svgElement\n      .append(\"g\")\n      .attr(\"stroke\", \"#999\")\n      .attr(\"stroke-opacity\", 0.6)\n      .selectAll(\"line\")\n      .data(linkData)\n      .join(\"line\")\n      .attr(\"stroke-width\", d => Math.sqrt(d.value));\n\n    const node = svgElement\n      .append(\"g\")\n      .attr(\"stroke\", \"#fff\")\n      .attr(\"stroke-width\", 1.5)\n      .selectAll(\"circle\")\n      .data(nodeData)\n      .join(\"circle\")\n      .attr(\"r\", 5)\n      .attr(\"fill\", d => color(d.group.toString()));\n\n    node.append(\"title\").text(d => d.id);\n\n    const drag = d3\n      .drag()\n      .on(\"start\", (event: any) => {\n        if (!event.active) simulation.alphaTarget(0.3).restart();\n        event.subject.fx = event.subject.x;\n        event.subject.fy = event.subject.y;\n      })\n      .on(\"drag\", (event: any) => {\n        event.subject.fx = event.x;\n        event.subject.fy = event.y;\n      })\n      .on(\"end\", (event: any) => {\n        if (!event.active) simulation.alphaTarget(0);\n        event.subject.fx = null;\n        event.subject.fy = null;\n      });\n\n    node.call(drag as any);\n    simulation.on(\"tick\", () => {\n      link\n        .attr(\"x1\", d => (d.source as any).x)\n        .attr(\"y1\", d => (d.source as any).y)\n        .attr(\"x2\", d => (d.target as any).x)\n        .attr(\"y2\", d => (d.target as any).y);\n\n      node.attr(\"cx\", d => (d as any).x).attr(\"cy\", d => (d as any).y);\n    });\n    return () => {\n      svgElement.selectAll(\"*\").remove();\n      simulation.stop();\n    };\n  }, [nodes, links]);\n\n  return <svg ref={ref}></svg>;\n};\n\nexport default ForceGraph;\n"],"names":["ForceGraph","nodes","links","ref","useRef","useEffect","svgElement","d3.select","width","height","color","d3.scaleOrdinal","d3.schemeCategory10","linkData","data","d","nodeData","simulation","d3.forceSimulation","d3.forceLink","d3.forceManyBody","d3.forceX","d3.forceY","link","node","drag","d3.drag","event","jsx"],"mappings":"2yqEAqBMA,EAAwC,CAAC,CAAE,MAAAC,EAAO,MAAAC,KAAY,CAC5D,MAAAC,EAAMC,SAA6B,IAAI,EAE7CC,OAAAA,EAAAA,UAAU,IAAM,CACd,MAAMC,EAAaC,EAAUJ,EAAI,OAAO,EAClCK,EAAQ,IACRC,EAAS,IAETC,EAAQC,EAAgBC,CAAmB,EAE3CC,EAAWC,EAAK,MAAM,QAAU,CAAE,GAAGC,GAAI,EACzCC,EAAWF,EAAK,MAAM,QAAU,CAAE,GAAGC,GAAI,EAEzCE,EAAaC,EACAF,CAAiC,EACjD,MACC,OACAG,EAAaN,CAAQ,EAAE,GAAIE,GAAWA,EAAE,EAAE,GAE3C,MAAM,SAAUK,EAAG,CAAe,EAClC,MAAM,IAAKC,EAAW,CAAA,EACtB,MAAM,IAAKC,GAAW,EAGtBhB,EAAA,KAAK,QAASE,CAAK,EACnB,KAAK,SAAUC,CAAM,EACrB,KAAK,UAAW,CAAC,KAAS,EAAG,KAAU,EAAGD,EAAOC,CAAM,CAAC,EACxD,KAAK,QAAS,gCAAgC,EAEjD,MAAMc,EAAOjB,EACV,OAAO,GAAG,EACV,KAAK,SAAU,MAAM,EACrB,KAAK,iBAAkB,EAAG,EAC1B,UAAU,MAAM,EAChB,KAAKO,CAAQ,EACb,KAAK,MAAM,EACX,KAAK,eAAqBE,GAAA,KAAK,KAAKA,EAAE,KAAK,CAAC,EAEzCS,EAAOlB,EACV,OAAO,GAAG,EACV,KAAK,SAAU,MAAM,EACrB,KAAK,eAAgB,GAAG,EACxB,UAAU,QAAQ,EAClB,KAAKU,CAAQ,EACb,KAAK,QAAQ,EACb,KAAK,IAAK,CAAC,EACX,KAAK,UAAaN,EAAMK,EAAE,MAAM,SAAA,CAAU,CAAC,EAE9CS,EAAK,OAAO,OAAO,EAAE,KAAKT,GAAKA,EAAE,EAAE,EAEnC,MAAMU,EAAOC,IAEV,GAAG,QAAUC,GAAe,CACtBA,EAAM,UAAmB,YAAY,EAAG,EAAE,QAAQ,EACjDA,EAAA,QAAQ,GAAKA,EAAM,QAAQ,EAC3BA,EAAA,QAAQ,GAAKA,EAAM,QAAQ,CAClC,CAAA,EACA,GAAG,OAASA,GAAe,CACpBA,EAAA,QAAQ,GAAKA,EAAM,EACnBA,EAAA,QAAQ,GAAKA,EAAM,CAC1B,CAAA,EACA,GAAG,MAAQA,GAAe,CACpBA,EAAM,QAAQV,EAAW,YAAY,CAAC,EAC3CU,EAAM,QAAQ,GAAK,KACnBA,EAAM,QAAQ,GAAK,IAAA,CACpB,EAEH,OAAAH,EAAK,KAAKC,CAAW,EACVR,EAAA,GAAG,OAAQ,IAAM,CAEvBM,EAAA,KAAK,KAAMR,GAAMA,EAAE,OAAe,CAAC,EACnC,KAAK,KAAYA,GAAAA,EAAE,OAAe,CAAC,EACnC,KAAK,KAAYA,GAAAA,EAAE,OAAe,CAAC,EACnC,KAAK,KAAMA,GAAMA,EAAE,OAAe,CAAC,EAEjCS,EAAA,KAAK,KAAMT,GAAMA,EAAU,CAAC,EAAE,KAAK,KAAYA,GAAAA,EAAU,CAAC,CAAA,CAChE,EACM,IAAM,CACAT,EAAA,UAAU,GAAG,EAAE,OAAO,EACjCW,EAAW,KAAK,CAClB,CAAA,EACC,CAAChB,EAAOC,CAAK,CAAC,EAEV0B,MAAC,OAAI,IAAAzB,EAAU,CACxB"}