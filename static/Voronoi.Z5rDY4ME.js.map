{"version":3,"file":"Voronoi.Z5rDY4ME.js","sources":["../../src/components/react/d3/practice/Voronoi.tsx"],"sourcesContent":["import * as d3 from \"d3\";\nimport { useEffect, useRef } from \"react\";\n\nconst Template = () => {\n  const ref = useRef<SVGSVGElement | null>(null);\n  useEffect(() => {\n    const width = 600;\n    const height = 200;\n    const radius = 32;\n    const svgElement = d3\n      .select(ref.current)\n      .attr(\"viewBox\", [0, 0, width, height])\n      .attr(\"stroke-width\", 2);\n\n    const circles = d3.range(20).map(i => ({\n      x: Math.random() * (width - radius * 2) + radius,\n      y: Math.random() * (height - radius * 2) + radius,\n    }));\n\n    let voronoi = d3.Delaunay.from(\n      circles,\n      d => d.x,\n      d => d.y\n    ).voronoi([0, 0, width, height]);\n\n    const circle = svgElement\n      .append(\"g\")\n      .selectAll(\"circle\")\n      .data(circles)\n      .join(\"circle\")\n      .attr(\"cx\", d => d.x)\n      .attr(\"cy\", d => d.y)\n      .attr(\"r\", radius)\n      .attr(\"fill\", (d, i) => d3.schemeCategory10[i % 10]);\n\n    const mesh = svgElement\n      .append(\"path\")\n      .attr(\"fill\", \"none\")\n      .attr(\"stroke\", \"#ccc\")\n      .attr(\"stroke-width\", 1)\n      .attr(\"d\", voronoi.render());\n\n    const cell = svgElement\n      .append(\"g\")\n      .attr(\"fill\", \"none\")\n      .attr(\"pointer-events\", \"all\")\n      .selectAll(\"path\")\n      .data(circles)\n      .join(\"path\")\n      .attr(\"d\", (d, i) => voronoi.renderCell(i))\n      .call(\n        d3\n          .drag()\n          .on(\"start\", (event, d) =>\n            circle\n              .filter(p => p === d)\n              .raise()\n              .attr(\"stroke\", \"black\")\n          )\n          .on(\n            \"drag\",\n            (event, d) => (((d as any).x = event.x), ((d as any).y = event.y))\n          )\n          .on(\"end\", (event, d) =>\n            circle.filter(p => p === d).attr(\"stroke\", null)\n          )\n          .on(\"start.update drag.update end.update\", update) as any\n      );\n\n    function update() {\n      voronoi = d3.Delaunay.from(\n        circles,\n        d => d.x,\n        d => d.y\n      ).voronoi([0, 0, width, height]);\n      circle.attr(\"cx\", d => d.x).attr(\"cy\", d => d.y);\n      cell.attr(\"d\", (d, i) => voronoi.renderCell(i));\n      mesh.attr(\"d\", voronoi.render());\n    }\n\n    return () => {\n      svgElement.selectAll(\"*\").remove();\n    };\n  });\n\n  return <svg ref={ref}></svg>;\n};\n\nexport default Template;\n"],"names":["Template","ref","useRef","useEffect","svgElement","d3.select","circles","d3.range","i","voronoi","d3.Delaunay","d","circle","d3.schemeCategory10","mesh","cell","d3.drag","event","p","update","jsx"],"mappings":"0xBAGA,MAAMA,EAAW,IAAM,CACf,MAAAC,EAAMC,SAA6B,IAAI,EAC7CC,OAAAA,EAAAA,UAAU,IAAM,CAId,MAAMC,EAAaC,EACTJ,EAAI,OAAO,EAClB,KAAK,UAAW,CAAC,EAAG,EAAG,IAAO,GAAM,CAAC,EACrC,KAAK,eAAgB,CAAC,EAEnBK,EAAUC,EAAS,EAAE,EAAE,IAAUC,IAAA,CACrC,EAAG,KAAK,OAAY,GAAA,IAAQ,GAAS,GAAK,GAC1C,EAAG,KAAK,OAAA,GAAY,IAAS,GAAS,GAAK,EAAA,EAC3C,EAEE,IAAAC,EAAUC,EAAY,KACxBJ,KACKK,EAAE,KACFA,EAAE,CAAA,EACP,QAAQ,CAAC,EAAG,EAAG,IAAO,GAAM,CAAC,EAE/B,MAAMC,EAASR,EACZ,OAAO,GAAG,EACV,UAAU,QAAQ,EAClB,KAAKE,CAAO,EACZ,KAAK,QAAQ,EACb,KAAK,QAAWK,EAAE,CAAC,EACnB,KAAK,KAAWA,GAAAA,EAAE,CAAC,EACnB,KAAK,IAAK,EAAM,EAChB,KAAK,OAAQ,CAACA,EAAGH,IAAMK,EAAoBL,EAAI,EAAE,CAAC,EAE/CM,EAAOV,EACV,OAAO,MAAM,EACb,KAAK,OAAQ,MAAM,EACnB,KAAK,SAAU,MAAM,EACrB,KAAK,eAAgB,CAAC,EACtB,KAAK,IAAKK,EAAQ,QAAQ,EAEvBM,EAAOX,EACV,OAAO,GAAG,EACV,KAAK,OAAQ,MAAM,EACnB,KAAK,iBAAkB,KAAK,EAC5B,UAAU,MAAM,EAChB,KAAKE,CAAO,EACZ,KAAK,MAAM,EACX,KAAK,IAAK,CAACK,EAAGH,IAAMC,EAAQ,WAAWD,CAAC,CAAC,EACzC,KACCQ,EAEG,EAAA,GAAG,QAAS,CAACC,EAAON,IACnBC,EACG,OAAOM,GAAKA,IAAMP,CAAC,EACnB,MAAA,EACA,KAAK,SAAU,OAAO,CAAA,EAE1B,GACC,OACA,CAACM,EAAON,KAASA,EAAU,EAAIM,EAAM,EAAMN,EAAU,EAAIM,EAAM,EAAA,EAEhE,GAAG,MAAO,CAACA,EAAON,IACjBC,EAAO,OAAYM,GAAAA,IAAMP,CAAC,EAAE,KAAK,SAAU,IAAI,CAAA,EAEhD,GAAG,sCAAuCQ,CAAM,CACrD,EAEF,SAASA,GAAS,CAChBV,EAAUC,EAAY,KACpBJ,KACKK,EAAE,KACFA,EAAE,CAAA,EACP,QAAQ,CAAC,EAAG,EAAG,IAAO,GAAM,CAAC,EACxBC,EAAA,KAAK,KAAMD,GAAKA,EAAE,CAAC,EAAE,KAAK,KAAWA,GAAAA,EAAE,CAAC,EAC1CI,EAAA,KAAK,IAAK,CAACJ,EAAGH,IAAMC,EAAQ,WAAWD,CAAC,CAAC,EAC9CM,EAAK,KAAK,IAAKL,EAAQ,OAAA,CAAQ,CAAA,CAGjC,MAAO,IAAM,CACAL,EAAA,UAAU,GAAG,EAAE,OAAO,CACnC,CAAA,CACD,EAEMgB,MAAC,OAAI,IAAAnB,EAAU,CACxB"}