import{j as c}from"./jsx-runtime.DZ3s2XAB.js";import{u as k}from"./useCesium.MJG7k46j.js";import{r as d}from"./index.D4IXJ7me.js";/* empty css                         */import"./_sentry-release-injection-file.B-UwqLso.js";import{J as u,p as P,q as C,C as w,r as v,P as D,T as E,a as p,s as I,f as S,g as x}from"./Viewer.sNypZuuW.js";import{V as j,P as M}from"./VelocityOrientationProperty.DpDyGcjk.js";import"./_commonjsHelpers.DqoTaOmB.js";(function(){try{var r=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},e=new r.Error().stack;e&&(r._sentryDebugIds=r._sentryDebugIds||{},r._sentryDebugIds[e]="6ad5ae0d-5b2a-42eb-b5b8-15e7345f22b0",r._sentryDebugIdIdentifier="sentry-dbid-6ad5ae0d-5b2a-42eb-b5b8-15e7345f22b0")}catch{}})();const A=(r=-117.16,e=32.71)=>{const i=[],m=new Date("2024-01-01T00:00:00Z").getTime();for(let o=0;o<200;o++){const a=o*.1,n=5e-4*a,f=r+n*(1+.3*Math.sin(5*a))*Math.cos(a)+(Math.random()-.5)*1e-4,g=e+n*(1+.3*Math.sin(5*a))*Math.sin(a)+(Math.random()-.5)*1e-4,t=m+o*5e3;i.push({time:t,lng:Number(f.toFixed(6)),lat:Number(g.toFixed(6))})}return i},W=()=>{const{cesiumContainerRef:r,viewer:e}=k(),[i,m]=d.useState(!1),[o,a]=d.useState(),n=A(116.5389,39.8209),f=d.useCallback(()=>{if(!e.current)return;const t=e.current.clock;t.startTime=u.fromDate(new Date(n[0].time)),t.stopTime=u.fromDate(new Date(n[n.length-1].time)),t.currentTime=u.clone(t.startTime),t.clockRange=P.LOOP_STOP,t.multiplier=1;const s=new C;n.forEach(l=>{const h=u.fromDate(new Date(l.time)),b=w.fromDegrees(l.lng,l.lat);s.addSample(h,b)});const y=e.current.entities.add({availability:new E([new I({start:t.startTime,stop:t.stopTime})]),model:{uri:"/assets/models/gltf/Cesium_Man.glb",scale:2,minimumPixelSize:64,maximumScale:200,clampAnimations:!1},position:s,orientation:new j(s),point:new D({color:p.RED,pixelSize:12,outlineColor:p.WHITE,outlineWidth:2}),path:new v({resolution:1,material:new M({glowPower:.3,color:p.YELLOW}),width:3})});return e.current.trackedEntity=y,e.current.scene.screenSpaceCameraController.enableCollisionDetection=!1,e.current.clock.onTick.addEventListener(l=>{const h=l.currentTime,b=s.getValue(h),T=S.fromCartesian(b);a({lng:x.toDegrees(T.longitude),lat:x.toDegrees(T.latitude)})}),()=>{e.current?.entities.remove(y),e.current?.clock.onTick.removeEventListener()}},[e.current,n]);d.useEffect(()=>{if(!e.current)return;const t=e.current.entities.add({polyline:{positions:w.fromDegreesArray(n.flatMap(s=>[s.lng,s.lat])),width:1,material:p.GRAY.withAlpha(.5)}});return f(),()=>{e.current?.entities.remove(t)}},[]);const g=()=>{e.current&&(i?e.current.clock.shouldAnimate=!1:(u.compare(e.current.clock.currentTime,e.current.clock.stopTime)===0&&(e.current.clock.currentTime=e.current.clock.startTime),e.current.clock.shouldAnimate=!0),m(!i))};return c.jsxs("div",{style:{position:"relative"},children:[c.jsx("div",{ref:r,style:{width:"100%",height:"70vh",userSelect:"none",position:"relative",zIndex:0}}),c.jsxs("div",{style:{position:"absolute",top:"20px",left:"20px",zIndex:1,background:"rgba(40,40,40,0.7)",color:"white",padding:"10px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.3)"},children:[c.jsx("button",{onClick:g,children:i?"⏸️ 暂停":"▶️ 播放"}),c.jsx("button",{onClick:()=>{e.current.clock.currentTime=e.current.clock.startTime,e.current.clock.shouldAnimate=!1,m(!1)},children:"⏹️ 重置"}),c.jsx("div",{style:{marginTop:10},children:o&&`经度: ${o.lng.toFixed(6)}  纬度: ${o.lat.toFixed(6)}`})]})]})};export{W as default};
//# sourceMappingURL=historyLine.QiO2I8tP.js.map
