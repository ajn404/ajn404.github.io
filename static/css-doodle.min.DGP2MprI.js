/*! css-doodle@0.38.4 */(function(){try{var Y=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},$=new Y.Error().stack;$&&(Y._sentryDebugIds=Y._sentryDebugIds||{},Y._sentryDebugIds[$]="8ff1025f-9acb-4193-a342-bf0f1fa71887",Y._sentryDebugIdIdentifier="sentry-dbid-8ff1025f-9acb-4193-a342-bf0f1fa71887")}catch{}})();(function(){const Y=[":",";",",","(",")","[","]","{","}","π","±","+","-","*","/","%",'"',"'","`","@","=","^"],$={escape:e=>e=="\\",space:e=>/[\r\n\t\s]/.test(e),digit:e=>/^[0-9]$/.test(e),sign:e=>/^[+-]$/.test(e),dot:e=>e==".",quote:e=>/^["'`]$/.test(e),symbol:e=>Y.includes(e),hexNum:e=>/^[0-9a-f]$/i.test(e),hex:(e,t,r)=>e=="0"&&$.letter(t,"x")&&$.hexNum(r),expWithSign:(e,t,r)=>$.letter(e,"e")&&$.sign(t)&&$.digit(r),exp:(e,t)=>$.letter(e,"e")&&$.digit(t),dots:(e,t)=>$.dot(e)&&$.dot(t),letter:(e,t)=>String(e).toLowerCase()==String(t).toLowerCase(),comment:(e,t)=>e=="/"&&t=="*",inlineComment:(e,t)=>e=="/"&&t==="/",selfClosedTag:(e,t)=>e=="/"&&t==">",closedTag:(e,t)=>e=="<"&&t=="/"};class U{constructor({type:t,value:r,pos:n,status:i}){this.type=t,this.value=r,this.pos=n,i&&(this.status=i)}isSymbol(...t){let r=this.type=="Symbol";return t.length?t.some(n=>n===this.value):r}isSpace(){return this.type=="Space"}isNumber(){return this.type=="Number"}isWord(){return this.type=="Word"}}function P(e){let t=-1,r=e.length,n=-1,i=0;return{curr:(s=0)=>e[t+s],next(s=1){let a=e[t+=s];return a===`
`?(i++,n=0):n+=s,a},end:()=>t>=r,get:()=>({prev:e[t-1],curr:e[t+0],next:e[t+1],next2:e[t+2],next3:e[t+3],pos:[n,i]})}}function Nr(e){for(;e.next();){let{curr:t,prev:r}=e.get();if($.comment(t,r))break}}function Er(e){for(;e.next()&&e.curr()!==`
`;);}function xt(e){return[":",";",",","{","}","(",")","[","]"].includes(e)}function _t(e){let t="";for(;!e.end();){let{curr:r,next:n}=e.get();t+=r;let i=$.symbol(n)||$.space(n)||$.digit(n);if(t.length&&i&&!$.closedTag(r,n))break;e.next()}return t.trim()}function Tr(e){let t="";for(;!e.end();){let{curr:r,next:n}=e.get();if(t+=r,!$.space(n))break;e.next()}return t}function $t(e){let t="",r=!1;for(;!e.end();){let{curr:n,next:i,next2:s,next3:a}=e.get();if(t+=n,r&&$.dot(i)||($.dot(n)&&(r=!0),$.dots(i,s)))break;if($.expWithSign(i,s,a))t+=e.next()+e.next();else if($.exp(i,s))t+=e.next();else if(!$.digit(i)&&!$.dot(i))break;e.next()}return t}function Rr(e){let t="0x";for(e.next(2);!e.end();){let{curr:r,next:n}=e.get();if(t+=r,!$.hexNum(n))break;e.next()}return t}function ye(e){return e[e.length-1]}function W(e,t={}){let r=P(String(e).trim()),n=[],i=[];for(;r.next();){let{prev:a,curr:l,next:o,next2:u,pos:c}=r.get();if($.comment(l,o))Nr(r);else if(t.ignoreInlineComment&&$.inlineComment(l,o))Er(r);else if($.hex(l,o,u)){let h=Rr(r);n.push(new U({type:"Number",value:h,pos:c}))}else if($.digit(l)||$.digit(o)&&$.dot(l)&&!$.dots(a,l)){let h=$t(r);n.push(new U({type:"Number",value:h,pos:c}))}else if($.symbol(l)&&!$.selfClosedTag(l,o)){let h=ye(n),f=$.digit(o)||$.dot(o)&&$.digit(u);if(l==="-"&&f&&(!h||!h.isNumber())){let d=$t(r);n.push(new U({type:"Number",value:d,pos:c}));continue}let p={type:"Symbol",value:l,pos:c};if(i.length&&$.escape(h.value)){n.pop();let d=_t(r);d.length&&n.push(new U({type:"Word",value:d,pos:c}))}else $.quote(l)&&(ye(i)==l?(i.pop(),p.status="close"):(i.push(l),p.status="open")),n.push(new U(p))}else if($.space(l)){let h=Tr(r),f=ye(n),{next:p}=r.get();if(!i.length&&f){let d=f.value,g=xt(d)&&d!==")",v=xt(p)&&p!=="(";if(g||v)continue;h=t.preserveLineBreak?l:" "}n.length&&p&&p.trim()&&n.push(new U({type:"Space",value:h,pos:c}))}else{let h=_t(r);h.length&&n.push(new U({type:"Word",value:h,pos:c}))}}let s=ye(n);return s&&s.isSpace()&&(n.length=n.length-1),n}function wt(e){let t=[];for(;e.next();){let{curr:r,next:n}=e.get();if(r.value==="var"){if(n&&n.isSymbol("(")){e.next();let i=zr(e);Cr(i.name)&&t.push(i)}}else if(t.length&&!r.isSymbol(","))break}return t}function zr(e){let t={},r=[];for(;e.next();){let{curr:n,next:i}=e.get();if(n.isSymbol(")",";")&&!t.name){t.name=kt(r);break}n.isSymbol(",")?(t.name===void 0&&(t.name=kt(r),r=[]),t.name&&(t.fallback=wt(e))):r.push(n)}return t}function kt(e){return e.map(t=>t.value).join("")}function Cr(e){return e!==void 0&&!(e.length<=2)&&!e.substr(2).startsWith("-")&&!!e.startsWith("--")}function O(e,t,r){return e=Number(e)||0,Math.max(t,Math.min(r,e))}function De(e,t){for(let[r,n]of Object.entries(t))e[r]=e[n];return e}function Be(e){return/^[a-zA-Z]$/.test(e)}function j(e){return e==null}function ee(e){return j(e)||Number.isNaN(e)}function L(e){return j(e)||e===""}function Z(e){let t=r=>(...n)=>e(r,...n);return t.lazy=!0,t}function te(e,t,r){return"c-"+e+"-"+t+"-"+r}function E(e){let t=e;for(;t&&!j(t.value);)t=t.value;return j(t)?"":t}function St(e,t,r=0){let n=new Image;n.crossOrigin="anonymous",n.src=e,n.onload=function(){setTimeout(t,r)}}function Ue(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)}function jt(e){let t=document.createElement("textarea");return t.innerHTML=e,t.value}function At(e,t=0){let r=3735928559^t,n=1103547991^t;for(let i,s=0;s<e.length;s++)i=e.charCodeAt(s),r=Math.imul(r^i,2654435761),n=Math.imul(n^i,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),n=Math.imul(n^n>>>16,2246822507)^Math.imul(r^r>>>13,3266489909),4294967296*(2097151&n)+(r>>>0)}function F(e,t,r){return t+e*(r-t)}function be(e=""){return e+Math.random().toString(32).substr(2)}function xe(e){return j(e)?[]:Array.isArray(e)?e:[e]}function _e(e,t=`
`){return(e||[]).join(t)}function A(e,t=1){return j(e)?"":e[e.length-t]}function Nt(e){return e[0]}function R(e,t={symbol:",",noSpace:!1,verbose:!1}){let r=[],n=[],i=[],s=[],a="";if(L(e))return r;let l=P(W(e));function o(c){let h=t.symbol||[","];return Array.isArray(h)||(h=[h]),t.noSpace?c.isSymbol(...h):c.isSymbol(...h)||c.isSpace()}function u(c){let h=function(f){return f.map(p=>p.value).join("")}(c);t.verbose?(a.length||h.length)&&r.push({group:a,value:h}):r.push(h)}for(;l.next();){let{prev:c,curr:h,next:f}=l.get();h.isSymbol("(")&&i.push(h.value),h.isSymbol(")")&&i.pop(),h.status==="open"&&s.push(h.value),h.status==="close"&&s.pop();let p=!i.length&&!s.length;if(p){let d=t.noSpace&&h.isSpace()&&o(f),g=t.noSpace&&h.isSpace()&&o(c);if(d||g)continue}p&&o(h)?(u(n),a=h.value,n=[]):n.push(h)}return n.length&&u(n),r}function Mr(e,t){let r,n=[],i=[],s=[],a=!1;for(;e.next();){let{curr:l,next:o}=e.get();l.isSymbol("(")&&!i.length?s.push(l):l.isSymbol(")")&&!i.length&&s.pop(),l.isSymbol("'",'"')&&(l.status==="open"?i.push(l):i.pop());let u=!i.length&&!s.length&&(!o||l.isSymbol(";")||o.isSymbol("}"));if(l.isSymbol("'",'"')&&o&&o.isSymbol("}")&&!i.length&&(u=!0),!s.length&&!i.length&&l.isSymbol("{")){let c=Et(n);if(!c.length)continue;let h=c.pop(),f=qe(...c,h);for(r=$e(Fe(e,we(h,{type:"block",name:h,value:[]})),f);h=c.pop();)r=$e(we(h,{type:"block",name:h,value:[r]}),f);a=!0;break}if(n.push(l),u)break}return n.length&&!r?(t._valueTokens=n,t.value=re(n)):r&&(t.value=r),a&&(t.value.inline=!0),t.origin&&(t.origin.value=t.value),t}function Pr(e){let t=[],r=[];for(;e.next();){let{curr:n}=e.get();if(n.isSymbol("{"))t.push(n.value);else if(n.isSymbol("}")){if(!t.length)break;t.pop()}r.push(n.value)}return r.join("")}function Fe(e,t){let r=[],n=[],i=t&&t.type||"",s=[];for(;e.next();){let{prev:a,curr:l,next:o}=e.get();l.isSymbol("(")&&s.push(l.value),l.isSymbol(")")&&s.pop();let u=!o||l.isSymbol("}");if(Xe(i)&&u){!o&&r.length&&!l.isSymbol("}")&&typeof r[r.length-1].value=="string"&&(r[r.length-1].value+=";"+l.value),t.value=r;break}if(l.isSymbol("{")){let c=Et(n);if(!c.length)continue;qe(t.name)&&(c=[re(n)]);let h=c.pop(),f=qe(...c,t.name,h);if(h==="style")r.push({type:"block",name:h,value:Pr(e)});else{let p=$e(Fe(e,we(h,{type:"block",name:h,value:[]})),f);for(;h=c.pop();)p=$e(we(h,{type:"block",name:h,value:[p]}),f);r.push(p)}n=[]}else if(l.isSymbol(":")&&!s.length&&!Ir(a,o)&&n.length){let c=Or(n,g=>g.isSymbol(",")),h={type:"statement",name:"unkown",value:""};c.length>1&&(h.origin={name:c});let f=Mr(e,h),p=R(f.value),d=c.length>1&&p.length===c.length;c.forEach((g,v)=>{let m=Object.assign({},f,{name:g});/^\-\-/.test(g)&&(m.variable=!0),d&&(m.value=p[v]),/viewBox/i.test(g)&&(m.detail=Wr(m.value,m._valueTokens)),delete m._valueTokens,r.push(m)}),Xe(i)&&(t.value=r),n=[]}else l.isSymbol(";")?r.length&&n.length&&(r[r.length-1].value+=";"+re(n),n=[]):n.push(l)}return r.length&&Xe(i)&&(t.value=r),i?t:r}function Ir(e,t){let r=e&&e.value,n=t&&t.value;return["xlink:actuate","xlink:arcrole","xlink:href","xlink:role","xlink:show","xlink:title","xlink:type","xml:base","xml:lang","xml:space"].includes(r+":"+n)}function re(e){return e.filter((t,r)=>!t.isSymbol(";","}")||r!==e.length-1).map(t=>t.value).join("")}function $e(e,t){let r=e.name||"",[n,...i]=r.split(/#/),s=i[i.length-1];return n&&s&&!t&&(e.name=n,e.value.push({type:"statement",name:"id",value:s})),e}function Or(e,t){let r=[],n=[];return e.forEach(i=>{t(i)?(r.push(re(n)),n=[]):n.push(i)}),n.length&&r.push(re(n)),r}function Et(e){let t,r=[],n=P(e);for(;n.next();){let{prev:i,curr:s,next:a}=n.get(),l=i&&a&&s.value==="x"&&i.isNumber()&&a.isNumber();!s.isWord()||t||l?r[r.length-1]=(r[r.length-1]+s.value).trim():r.push(s.value.trim()),s.isSymbol()?t=!0:s.isSpace()||(t=!1)}return r}function Wr(e,t){const r={value:[]};let n;if(!Array.isArray(t))return r;for(let i of t)i.isSpace()||i.isSymbol(",",";")||(r.value.length<4&&i.isNumber()?r.value.push(Number(i.value)):i.isNumber()&&n?(r[n]=Number(i.value),n=null):i.isWord()&&(n=i.value));return r}function we(e,t){let r=Object.assign({},t);if(/\*\s*[0-9]/.test(e)){let[n,i]=e.split("*");i&&(r.times=i.trim(),r.pureName=n.trim())}return r}function qe(...e){return e.some(t=>t==="style")}function Xe(e){return e==="block"}function ne(e,t){return function(r){let n,i=[];for(let s of r.value)s.name==="svg"&&(n=s),s.variable&&i.push(s);if(n&&Array.isArray(n.value)){for(let s of i)n.value.find(a=>a.name==s.name)||n.value.unshift(s);return n}return r}(Fe(P(W(e)),t||{type:"block",name:"svg",value:[]}))}function He(e,t){let r="";if(e.type==="block"){let n=Array.isArray(e.value)&&e.value[0]&&e.value[0].inline;if(e.times?r+="@M"+e.times+"("+e.pureName+"{":r+=e.name+"{",e.name==="style")r+=e.value;else if(Array.isArray(e.value)&&e.value.length){let i="";for(let s of e.value)r+=He(s,i),s.origin&&(i=s.origin.name.join(","))}e.times?r+="})":n||(r+="}")}else if(e.type==="statement"){let n=e.origin&&t===e.origin.name.join(","),i=e.origin?e.origin.name.join(","):e.name,s=e.origin?e.origin.value:e.value;n||(r+=s&&s.type?i+":"+He(s):i+":"+s+";")}return r}function Lr(e){return He(e).trim()}const I={func:(e="")=>({type:"func",name:e,arguments:[]}),argument:()=>({type:"argument",value:[]}),text:(e="")=>({type:"text",value:e}),pseudo:(e="")=>({type:"pseudo",selector:e,styles:[]}),cond:(e="")=>({type:"cond",name:e,styles:[],arguments:[]}),rule:(e="")=>({type:"rule",property:e,value:[]}),keyframes:(e="")=>({type:"keyframes",name:e,steps:[]}),step:(e="")=>({type:"step",name:e,styles:[]})},M={white_space:e=>/[\s\n\t]/.test(e),line_break:e=>/\n/.test(e),number:e=>!isNaN(e),pair:e=>['"',"(",")","'"].includes(e),pair_of:(e,t)=>({'"':'"',"'":"'","(":")"})[e]==t},ke={π:Math.PI,"∏":Math.PI};function Tt(e){return/^@(canvas|shaders|doodle)/.test(e)}function Rt(e=""){let t=0,r=1,n=1;return{curr:(i=0)=>e[t+i],end:()=>e.length<=t,info:()=>({index:t,col:r,line:n}),index:i=>i===void 0?t:t=i,range:(i,s)=>e.substring(i,s),next(){let i=e[t++];return i==`
`?(n++,r=0):r++,i}}}function Dr(e,{col:t,line:r}){console.warn(`(at line ${r}, column ${t}) ${e}`)}function Ye(e){return function(t,r){let n=t.index(),i="";for(;!t.end();){let s=t.next();if(e(s))break;i+=s}return r&&t.index(n),i}}function zt(e,t){return Ye(r=>/[^\w@]/.test(r))(e,t)}function Br(e){return Ye(t=>/[\s\{]/.test(t))(e)}function Ct(e,t){return Ye(r=>M.line_break(r)||r=="{")(e,t)}function Ur(e,t){let r,n=I.step();for(;!e.end()&&(r=e.curr())!="}";)if(M.white_space(r))e.next();else{if(n.name.length){if(n.styles.push(je(e,t)),e.curr()=="}")break}else n.name=Ze(e,i=>i==="{");e.next()}return n}function Fr(e,t){const r=[];let n;for(;!e.end()&&(n=e.curr())!="}";)M.white_space(n)||r.push(Ur(e,t)),e.next();return r}function qr(e,t){let r,n=I.keyframes();for(;!e.end()&&(r=e.curr())!="}";)if(n.name.length){if(r=="{"||e.curr(-1)=="{"){e.next(),n.steps=Fr(e,t);break}e.next()}else if(zt(e),n.name=Br(e),!n.name.length){Dr("missing keyframes name",e.info());break}return n}function Se(e,t={}){for(e.next();!e.end();){let r=e.curr();if(t.inline){if(r==`
`)break}else if((r=e.curr())=="*"&&e.curr(1)=="/")break;e.next()}t.inline||(e.next(),e.next())}function Xr(e){for(e.next();!e.end()&&e.curr()!=">";)e.next()}function Hr(e){let t,r="";for(;!e.end()&&(t=e.curr())!=":";)M.white_space(t)||(r+=t),e.next();return r}function Ge(e,t,r,n={}){let i,s=[],a=[],l=[],o="",u="";for(;!e.end();){i=e.curr();let h=e.curr(-1),f=e.index();if(/[\('"`]/.test(i)&&h!=="\\")l.length&&i!=="("&&i===A(l)?l.pop():l.push(i),o+=i;else if(!r&&(i=="@"||i==="$"||h==="."&&t))a.length||(o=o.trimLeft()),o.length&&(a.push(I.text(o)),o=""),a.push(Mt(e,n));else if(r&&/[)]/.test(i)||!r&&/[,)]/.test(i))if(l.length)i==")"&&A(l)==="("&&l.pop(),o+=i;else{if(o.length&&(a.length?/\S/.test(o)&&a.push(I.text(o)):a.push(I.text((c=o).trim().length?M.number(+c)?+c:c.trim():c)),o.startsWith("±")&&!r)){let p=o.substr(1),d=structuredClone(a);A(d).value="-"+p,s.push(Ve(d)),A(a).value=p}if(s.push(Ve(a)),[a,o]=[[],""],i==")")break}else ke[i]&&!/[0-9]/.test(e.curr(-1))&&(i=ke[i]),o+=i;if(!(!t||e.curr(1)!=")"&&e.curr(1)!=";"&&/[0-9a-zA-Z_\-.]/.test(e.curr())||l.length)){a.length&&s.push(Ve(a));break}u+=e.range(f,e.index()+1),e.next()}var c;return[Yr(s),u]}function Yr(e){let t=A(e[0]);return t&&t.type==="text"&&!String(t.value).trim().length&&(e[0]=e[0].slice(0,-1)),e}function Ve(e){let t=e.map(i=>{if(i.type=="text"&&typeof i.value=="string"){let s=String(i.value);s.includes("`")&&(i.value=s=s.replace(/`/g,'"')),i.value=s}return i}),r=Nt(t)||{},n=A(t)||{};if(r.type=="text"&&n.type=="text"){let i=Nt(r.value),s=A(n.value);typeof r.value=="string"&&typeof n.value=="string"&&M.pair_of(i,s)&&(r.value=r.value.slice(1),n.value=n.value.slice(0,n.value.length-1),t.cluster=!0)}return t}function Gr(e){let t=JSON.stringify(e);return t.includes("pureName")&&t.includes("times")}function Vr(e){return/^@svg$/i.test(e)}function Mt(e,t={}){let r,n=I.func(),i=e.curr(),s=!1,a=i==="$";for(i==="@"?e.next():i="@";!e.end();){r=e.curr();let u=e.curr(1),c=r=="."&&/[a-zA-Z@$]/.test(u);if(r=="("||c){s=!0,e.next();let[h,f]=Ge(e,c,Tt(i),t);if(Vr(i)){let p=ne(f),d=0;for(let g of p.value)g.variable&&(t[g.name]=K(`${`
`.repeat(d++)} ${g.name}:${g.value}`)[0].value);if(/\d\s*{/.test(f)&&Gr(p)){let g=Lr(p);g+=")",h=Ge(Rt(g),c,Tt(i),t)[0]}}n.arguments=h,n.variables=t;break}if(/[0-9a-zA-Z_\-.%]/.test(r)&&(i+=r),!s&&u!=="("&&!/[0-9a-zA-Z_\-.%]/.test(u))break;e.next()}let{fname:l,extra:o}=function(u){let c="",h="";if(/\D$/.test(u)&&!/\d+[x-]\d+/.test(u)||Math[u.substr(1)])return{fname:u,extra:h};for(let f=u.length-1;f>=0;f--){let p=u[f],d=u[f-1],g=u[f+1];if(!(/[\d.]/.test(p)||(p=="x"||p=="-")&&/\d/.test(d)&&/\d/.test(g))){c=u.substring(0,f+1);break}h=p+h}return{fname:c,extra:h}}(i);if(n.name=a?"@$"+i.substr(1):l,o.length&&n.arguments.unshift([{type:"text",value:o}]),a&&n.name.length>2){if(!n.arguments.length){let u=n.name.substring(0,2),c=n.name.substring(2);n.name=u,n.arguments.push([{type:"text",value:c}])}if(/\d$/.test(n.name)){let u=n.name.substring(0,2),c=n.name.substring(2);n.name=u,n.arguments[0][0].value=c}}return n.position=e.info().index,n}function Ze(e,t=()=>{}){let r,n=I.text(),i=0,s=!0;const a=[];a[i]=[];let l=[],o=[];for(;!e.end();){if(r=e.curr(),s&&M.white_space(r)){e.next();continue}if(s=!1,r!=`
`||M.white_space(e.curr(-1)))if(r!=","||l.length){if((/[;}<]/.test(r)||t(r))&&!o.length){n.value.length&&(a[i].push(n),n=I.text());break}r!=="@"&&r!=="$"||!/[\w-\(%]/.test(e.curr(1))?r==='"'||r==="'"?(r===A(o)?o.pop():o.length||o.push(r),n.value+=r):M.white_space(r)&&M.white_space(e.curr(-1))||(r=="("&&l.push(r),r==")"&&l.pop(),ke[r]&&!/[0-9]/.test(e.curr(-1))&&(r=ke[r]),n.value+=r):(n.value.length&&(a[i].push(n),n=I.text()),a[i].push(Mt(e)))}else n.value.length&&(a[i].push(n),n=I.text()),a[++i]=[],s=!0;else n.value+=" ";let u=e.curr();if((u===";"||u=="}"||t(u))&&!o.length)break;e.next()}return n.value.length&&a[i].push(n),a}function Zr(e){let t,r="";for(;!e.end()&&(t=e.curr())!="{";)r+=t,e.next();return r=r.trim(),r}function Kr(e){let t,r={name:"",arguments:[]};for(;!e.end();){if((t=e.curr())=="(")e.next(),r.arguments=Ge(e)[0];else{if(/[){]/.test(t))break;r.name+=t}e.next()}let[n,...i]=r.name.trim().split(/\s+/);return r.name=n,r.addition=i,r}function Pt(e,t){let r,n=I.pseudo();for(;!e.end();){if(r=e.curr(),r=="/"&&e.curr(1)=="*")Se(e);else{if(r=="}")break;if(M.white_space(r)){e.next();continue}if(n.selector){let i=je(e,t);if(i.property=="@use"?n.styles=n.styles.concat(i.value):i.property&&n.styles.push(i),e.curr()=="}")break}else n.selector=Zr(e)}e.next()}return n}function je(e,t){let r,n=I.rule(),i=e.index();for(;!e.end();){if(r=e.curr(),r=="/"&&e.curr(1)=="*")Se(e);else{if(r==";")break;if(n.property.length){n.value=Ze(e);break}if(n.property=Hr(e),n.property=="@use"){n.value=Jr(e,t);break}}e.next()}let s=e.index();return n.raw=()=>e.range(i,s).trim(),n}function It(e,t){let r,n=I.cond();for(;!e.end();){if(r=e.curr(),r=="/"&&e.curr(1)=="*")Se(e);else{if(r=="}")break;if(n.name.length)if(r==":"){let i=Pt(e);i.selector&&n.styles.push(i)}else if(r!="@"||Ct(e,!0).includes(":")){if(!M.white_space(r)){let i=je(e,t);if(i.property&&n.styles.push(i),e.curr()=="}")break}}else n.styles.push(It(e));else Object.assign(n,Kr(e))}e.next()}return n}function Ot(e,t){let r="";return e&&e.get_variable&&(r=e.get_variable(t)),r}function Wt(e,t){e.forEach&&e.forEach(r=>{if(r.type=="text"&&r.value){let n=wt(P(W(r.value)));r.value=n.reduce((i,s)=>{let a,l="",o="";l=Ot(t,s.name),!l&&s.fallback&&s.fallback.every(u=>{if(o=Ot(t,u.name),o)return l=o,!1});try{a=K(l,t)}catch{}return a&&i.push.apply(i,a),i},[])}r.type=="func"&&r.arguments&&r.arguments.forEach(n=>{Wt(n,t)})})}function Jr(e,t){return e.next(),(Ze(e)||[]).reduce((r,n)=>{Wt(n,t);let[i]=n;return i.value&&i.value.length&&r.push(...i.value),r},[])}function K(e,t){const r=Rt(e),n=[];for(;!r.end();){let i=r.curr();if(M.white_space(i))r.next();else{if(i=="/"&&r.curr(1)=="*")Se(r);else if(i==":"){let s=Pt(r,t);s.selector&&n.push(s)}else if(i=="@"&&zt(r,!0)==="@keyframes"){let s=qr(r,t);n.push(s)}else if(i!="@"||Ct(r,!0).includes(":")){if(i=="<")Xr(r);else if(!M.white_space(i)){let s=je(r,t);s.property&&n.push(s)}}else{let s=It(r,t);s.name.length&&n.push(s)}r.next()}}return n}function ie(e,t=64){const[r,n,i]=[1,t,t*t];let[s,a,l]=(e+"").replace(/\s+/g,"").replace(/[,\uff0cxX]+/g,"x").split("x").map(h=>parseInt(h));const o=s==1||a==1?i:n,u=s==1&&a==1?i:r,c={x:O(s||r,1,o),y:O(a||s||r,1,o),z:O(l||r,1,u)};return Object.assign({},c,{count:c.x*c.y*c.z,ratio:c.x/c.y})}function Qr(e){return/^texture\w*$|^(fragment|vertex)$/.test(e)}function Lt(){return new U({type:"LineBreak",value:`
`})}function Dt(e){let t=e[0],r=e[e.length-1];for(;t&&t.isSymbol("(")&&r&&r.isSymbol(")");)t=(e=e.slice(1,e.length-1))[0],r=e[e.length-1];return e}function Ke(e){return Dt(e).map(t=>t.value).join("")}const se='xmlns="http://www.w3.org/2000/svg"',Bt='xmlns="http://www.w3.org/1999/xhtml"',Je='xmlns:xlink="http://www.w3.org/1999/xlink"';function Ae(e,t){return`url("data:image/svg+xml;utf8,${encodeURIComponent(e)+(t?`#${t}`:"")}")`}function Ut(e){return e.includes("<svg")||(e=`<svg ${se} ${Je}>${e}</svg>`),e.includes("xmlns")||(e=e.replace(/<svg([\s>])/,`<svg ${se} ${Je}$1`)),e}function le(e){let t=P(W(e)),r={},n=!1;for(;t.next();){let{prev:i,curr:s,next:a}=t.get(),l=n&&(s.isWord()||s.isSymbol())&&i&&i.isNumber()&&!a;if(s.isNumber())r.value=Number(s.value),n=!0;else{if(!l)break;r.unit=s.value}}return r}function Ft(e){return(...t)=>{let r=[],n=[];for(let a of t){let{unit:l,value:o}=le(a);l!==void 0&&r.push(l),o!==void 0&&n.push(o)}let i=e(...n),s=r.find(a=>a!==void 0);return s===void 0?i:Array.isArray(i)?i.map(a=>a+s):i+s}}function Qe(e){return(...t)=>{let r=t.map(i=>String(i).charCodeAt(0)),n=e(...r);return Array.isArray(n)?n.map(i=>String.fromCharCode(i)):String.fromCharCode(n)}}var J=new class{constructor(){this.cache={}}clear(){this.cache={}}set(e,t){if(j(e))return"";let r=this.getKey(e);return this.cache[r]=t}get(e){let t=this.getKey(e);return this.cache[t]}getKey(e){return At(typeof e=="string"?e:JSON.stringify(e))}};function et(e,t){return(...r)=>{let n=e+r.join("-");return J.get(n)||J.set(n,t(...r))}}function Ne(e,t){return{type:e,value:t}}function en(e,t,r){let n=0,i=e,s=o=>o>0&&o<1?.1:1,a=arguments.length;a==1&&([e,t]=[s(e),e]),a<3&&(r=s(e));let l=[];for(;(r>=0&&e<=t||r<0&&e>t)&&(l.push(e),e+=r,!(n++>=65535)););return l.length||l.push(i),l}const tn=et("build_range",e=>function(r){let n=String(r),i=[],s=[];if(!n.startsWith("[")||!n.endsWith("]"))return i;for(let a=1;a<n.length-1;++a){let l=n[a];if(l!="-"||n[a-1]!="-")if(l!="-")if(A(s)!="-")s.length&&i.push(Ne("char",s.pop())),s.push(l);else{s.pop();let o=s.pop();i.push(o?Ne("range",[o,l]):Ne("char",l))}else s.push(l)}return s.length&&i.push(Ne("char",s.pop())),i}(e).flatMap(({type:r,value:n})=>{if(r=="char")return n;let[i,s]=n,a=!1;i>s&&([i,s]=[s,i],a=!0);let l=Qe(en)(i,s);return a&&l.reverse(),l}));function ae(e){return(...t)=>e(...t.flatMap(r=>String(r).startsWith("[")?tn(r):r))}class rn{constructor(t){this.prev=this.next=null,this.data=t}}class nn{constructor(t=20){this._limit=t,this._size=0}push(t){this._size>=this._limit&&(this.root=this.root.next,this.root.prev=null);let r=new rn(t);this.root?(r.prev=this.tail,this.tail.next=r,this.tail=r):this.root=this.tail=r,this._size++}last(t=1){let r=this.tail;for(;--t&&r.prev;)r=r.prev;return r.data}}const qt=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180];class sn{constructor(){this.p=[].concat(qt,qt)}grad(t,r,n,i){let s=15&t,a=s<8?r:n,l=s<4?n:s==12||s==14?r:i;return(1&s?-a:a)+(2&s?-l:l)}noise(t,r,n){let{p:i,grad:s}=this,[a,l,o]=[t,r,n].map(b=>255&Math.floor(b));[t,r,n]=[t,r,n].map(b=>b-Math.floor(b));let[u,c,h]=[t,r,n].map(b=>b*b*b*(b*(6*b-15)+10)),f=i[a]+l,p=i[f]+o,d=i[f+1]+o,g=i[a+1]+l,v=i[g]+o,m=i[g+1]+o;return F(h,F(c,F(u,s(i[p],t,r,n),s(i[v],t-1,r,n)),F(u,s(i[d],t,r-1,n),s(i[m],t-1,r-1,n))),F(c,F(u,s(i[p+1],t,r,n-1),s(i[v+1],t-1,r,n-1)),F(u,s(i[d+1],t,r-1,n-1),s(i[m+1],t-1,r-1,n-1))))}}function Xt(e,t){let r={},n=!0;for(let i=0;i<e.length;++i){let s=e[i],a=t[i];if(/=/.test(s)){let[l,o]=R(s,{symbol:"=",noSpace:!0});o!==void 0?(t.includes(l)&&(r[l]=o),n=!1):r[a]=s}else n&&(r[a]=s)}return r}const tt=new Map,ln={π:Math.PI,gcd:(e,t)=>{for(;t;)[e,t]=[t,e%t];return e}},rt={"^":7,"*":6,"/":6,"÷":6,"%":6,"&":5,"|":5,"+":4,"-":4,"<":3,"<<":3,">":3,">>":3,"=":3,"==":3,"≤":3,"<=":3,"≥":3,">=":3,"≠":3,"!=":3,"∧":2,"&&":2,"∨":2,"||":2,"(":1,")":1};function Ee(e,t,r=[]){let n=[];for(;e.length;){let{name:i,value:s,type:a}=e.shift();if(a==="variable"){let l=t[s];ee(l)&&(l=Math[s]),ee(l)&&(l=Ht(s,t,r)),ee(l)&&/^\-\D/.test(s)&&(l=Ht("-1"+s.substr(1),t,r)),l===void 0&&(l=0),typeof l!="number"&&(r.push(l),Yt(r)?(l=0,r=[]):l=Ee(oe(l),t,r)),n.push(l)}else if(a==="function"){let l=!1;/^\-/.test(i)&&(l=!0,i=i.substr(1));let o,u=s.map(h=>Ee(h,t,r)),c=i.split(".");for(;o=c.pop();){if(!o)continue;let h=t[o]||Math[o];u=typeof h=="function"?Array.isArray(u)?h(...u):h(u):0}l&&(u*=-1),n.push(u)}else if(/\d+/.test(s))n.push(s);else{let l=n.pop(),o=n.pop();n.push(an(s,Number(o),Number(l)))}}return Number(n[0])||0}function oe(e){let t=function(i){if(tt.has(i))return tt.get(i);let s=String(i),a=[],l="";for(let o=0;o<s.length;++o){let u=s[o];if(rt[u]){let c=A(a);if(u=="="&&c&&/^[!<>=]$/.test(c.value))c.value+=u;else if(/^[|&<>]$/.test(u)&&c&&c.value==u)c.value+=u;else if(u=="-"&&s[o-1]=="e")l+=u;else if(a.length||l.length||!/[+-]/.test(u)){let{type:h,value:f}=c||{};h=="operator"&&!l.length&&/[^()]/.test(u)&&/[^()]/.test(f)?l+=u:(l.length&&(a.push({type:"number",value:l}),l=""),a.push({type:"operator",value:u}))}else l+=u}else/\S/.test(u)&&(u==","?(a.push({type:"number",value:l}),l="",a.push({type:"comma",value:u})):u=="!"?(a.push({type:"number",value:l}),a.push({type:"operator",value:u}),l=""):l+=u)}return l.length&&a.push({type:"number",value:l}),tt.set(i,a),a}(e);const r=[],n=[];for(let i=0;i<t.length;++i){let{type:s,value:a}=t[i],l=t[i+1]||{};if(s=="number")if(l.value=="("&&/[^\d.\-]/.test(a)){let o="",u=[],c=[];for(i+=1;t[i++]!==void 0;){let h=t[i];if(h===void 0)break;let f=h.value;if(f==")"){if(!u.length)break;u.pop(),o+=f}else if(f=="("&&u.push(f),f!=","||u.length)o+=f;else{let p=oe(o);p.length&&c.push(p),o=""}}o.length&&c.push(oe(o)),n.push({type:"function",name:a,value:c})}else/[^\d.\-]/.test(a)?n.push({type:"variable",value:a}):n.push({type:"number",value:a});else if(s=="operator")if(a=="(")r.push(a);else if(a==")"){for(;r.length&&A(r)!="(";)n.push({type:"operator",value:r.pop()});r.pop()}else{for(;r.length&&rt[A(r)]>=rt[a];){let o=r.pop();/[()]/.test(o)||n.push({type:"operator",value:o})}r.push(a)}}for(;r.length;)n.push({type:"operator",value:r.pop()});return n}function an(e,t,r){switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"%":return t%r;case"|":return t|r;case"&":return t&r;case"<":return t<r;case">":return t>r;case"^":return Math.pow(t,r);case"÷":case"/":return t/r;case"=":case"==":return t==r;case"≤":case"<=":return t<=r;case"≥":case">=":return t>=r;case"≠":case"!=":return t!=r;case"∧":case"&&":return t&&r;case"∨":case"||":return t||r;case"<<":return t<<r;case">>":return t>>r}}function Ht(e,t,r){let[n,i,s]=e.match(/([\d.\-]+)(.*)/)||[],a=t[s];return a===void 0?a:typeof a=="number"?Number(i)*a:(r.push(a),Yt(r)?(r=[],0):i*Ee(oe(a),t,r))}function Yt(e){if(e.length>50)return!0;let t=A(e);for(let r=2;r<=4;++r){let n=e[e.length-r];if(n===void 0||t!==n)return!1}return!0}function q(e,t){return Ee(oe(e),Object.assign({},ln,t))}const z={name:"cssd-utime","animation-name":"cssd-utime-animation","animation-duration":31536e6,"animation-iteration-count":"infinite","animation-delay":"0s","animation-direction":"normal","animation-fill-mode":"none","animation-play-state":"running","animation-timing-function":"linear"};z.animation=`
 ${z["animation-duration"]}ms
 ${z["animation-timing-function"]} ${z["animation-delay"]} ${z["animation-iteration-count"]} ${z["animation-name"]}`;const nt="cssd-umousex",it="cssd-umousey",st="cssd-uwidth",lt="cssd-uheight";function Te(e){let t=P(W(e)),r={},n={commands:[],valid:!0};for(;t.next();){let{curr:i}=t.get();if(!i.isSpace()&&!i.isSymbol(","))if(i.isWord())r.name&&(n.commands.push(r),r={}),r.name=i.value,r.value=[],"MmLlHhVvCcSsQqTtAaZz".includes(i.value)?"mlhvcsqtaz".includes(i.value)?r.type="relative":r.type="absolute":(r.type="unknown",n.valid=!1);else if(r.value){let s=i.value;i.isNumber()&&(s=Number(i.value)),r.value.push(s)}else r.name||(n.valid=!1)}return r.name&&n.commands.push(r),n}const on=function(){let e=0;return(t="")=>`${t}-${++e}`}();class ue{constructor(t,r=""){if(!t)throw new Error("Tag name is required");this.id=Symbol(),this.name=t,this.body=[],this.attrs={},this.isTextNode()&&(this.body=r)}isTextNode(){return this.name==="text-node"}find(t){let r=t.attrs.id,n=t.name;if(Array.isArray(this.body)&&r!==void 0)return this.body.find(i=>i.attrs.id===r&&i.name===n)}findSpareDefs(){return this.body.find(t=>t.name==="defs"&&!t.attrs.id)}append(t){Array.isArray(t)||(t=[t]);for(let r of t)this.isTextNode()||this.body.push(r)}merge(t){for(let[r,n]of Object.entries(t.attrs))this.attrs[r]=n;Array.isArray(t.body)&&this.body.push(...t.body)}attr(t,r){if(!this.isTextNode())return r===void 0?this.attrs[t]:this.attrs[t]=r}toString(){if(this.isTextNode())return Gt(this.body);let t=[""],r=[];for(let[n,i]of Object.entries(this.attrs))i=Gt(i),t.push(`${n}="${i}"`);for(let n of this.body)r.push(n.toString());return r.join("").length||/svg/i.test(this.name)?`<${this.name}${t.join(" ")}>${r.join("")}</${this.name}>`:`<${this.name}${t.join(" ")}/>`}}function Gt(e){let t=(e=String(e)).startsWith('"')&&e.endsWith('"'),r=e.startsWith("'")&&e.endsWith("'");return t||r?e.substring(1,e.length-1):e}function at(e,t,r,n){let i;if(t||(t=new ue("root")),e.type==="block")if(e.name==="style"){let a=new ue("style");a.append(e.value),t.append(a)}else{let a=new ue(e.name);if(n||(n=a).attr("xmlns",se.split("=")[1]),e.name==="defs"){let h=n.findSpareDefs();h&&(a=h)}for(let h of e.value){e.parent=r;let f=at(h,a,e,n);f&&(i=f)}let l=e&&e.inline&&e.name!=="defs",o=r&&r.inline&&r.name==="defs",u=o&&r.value.length==1;if(l||o){let h=e.value.find(f=>f.type==="statement"&&f.name==="id");h?i=h.value:(u||l)&&(i=on(e.name),a.attr("id",i))}let c=t.find(a);if(c)c.merge(a);else if(e.name==="defs"){let h=n.findSpareDefs();h&&!a.attrs.id?a.id!==h.id&&h.append(a.body):n.append(a)}else t.append(a)}if(e.type==="statement"&&!e.variable)if(e.name==="content"){let a=new ue("text-node",e.value);t.append(a)}else if(e.name.startsWith("style ")){let a=(e.name.split("style ")[1]||"").trim();if(a.length){let l=t.attr("style")||"";t.attr("style",l+function(o,u){return`${o}:${u};`}(a,e.value))}}else{let a=e.value;if(a&&a.type==="block"){let l=at(e.value,n,e,n);j(l)?a="":(a=`url(#${l})`,e.name!=="xlink:href"&&e.name!=="href"||(a=`#${l}`))}if(/viewBox/i.test(e.name))a=function(l){let o=l.detail.value,u=l.detail.padding||l.detail.p||l.detail.expand;if(!o.length)return"";let[c,h,f,p]=o;return u&&([c,h,f,p]=[c-u,h-u,f+2*u,p+2*u]),`${c} ${h} ${f} ${p}`}(e),a&&t.attr(e.name,a);else if(e.name!=="draw"&&e.name!=="animate"||(s=r&&r.name)!=="path"&&s!=="line"&&s!=="circle"&&s!=="ellipse"&&s!=="rect"&&s!=="polygon"&&s!=="polyline")t.attr(e.name,a);else{let[l,o]=String(a).split(/\s+/);(l==="indefinite"||l==="infinite"||/\d$/.test(l))&&([l,o]=[o,l]),o==="infinite"&&(o="indefinite"),t.attr("stroke-dasharray",10),t.attr("pathLength",10);let u=new ue("animate");u.attr("attributeName","stroke-dashoffset"),u.attr("from",10),u.attr("to",0),u.attr("dur",l),o&&u.attr("repeatCount",o),t.append(u)}e.name.includes("xlink:")&&n.attr("xmlns:xlink",Je.split("=")[1])}var s;return r?i:n.toString()}function Re(e){return at(e)}const un=["auto","reverse"],cn=["deg","rad","grad","turn"];function hn(e){let t=P(W(e)),r=!1,n="",i={direction:"",angle:""};for(;t.next();){let{prev:s,curr:a,next:l}=t.get();if(a.isWord()&&un.includes(a.value))i.direction=a.value,r=!0;else if(a.isNumber())i.angle=Number(a.value),r=!0;else if(a.isWord()&&s&&s.isNumber()&&cn.includes(a.value))n=a.value;else if(a.isSpace()&&i.direction!==""&&i.angle!=="")break}return r||(i.direction="auto"),function(s,a){let{angle:l}=s;return l===""&&(l=0),a==="rad"&&(l/=Math.PI/180),a==="grad"&&(l*=.9),a==="turn"&&(l*=360),Object.assign({},s,{angle:l})}(i,n)}function Vt(e,t,r){return["fill-rule","fill"].includes(e)?t:r?`-1 * (${t})`:t}function ot(e){return e.map(t=>t.value).join("")}const{cos:ce,sin:he,abs:fn,atan2:Zt,PI:ut}=Math,ct={circle:`
 split:180;scale:.99
 `,triangle:`
 rotate:30;scale:1.1;move:0 .2
 `,pentagon:`
 split:5;rotate:54
 `,hexagon:`
 split:6;rotate:30;scale:.98
 `,octagon:`
 split:8;rotat:22.5;scale:.99
 `,star:`
 split:10;r:cos(5t);rotate:-18;scale:.99
 `,infinity:`
 split:180;scale:.99;x:cos(t)*.99 / (sin(t)^2 + 1);y:x * sin(t)
 `,heart:`
 split:180;rotate:180;a:cos(t)*13/18 - cos(2t)*5/18;b:cos(3t)/18 + cos(4t)/18;x:(.75 * sin(t)^3) * 1.2;y:(a - b + .2) * -1.1
 `,bean:`
 split:180;r:sin(t)^3 + cos(t)^3;move:-.35 .35;`,bicorn:`
 split:180;x:cos(t);y:sin(t)^2 / (2 + sin(t)) - .5
 `,drop:`
 split:180;rotate:90;scale:.95;x:sin(t);y:(1 + sin(t)) * cos(t) / 1.6
 `,fish:`
 split:240;x:cos(t) - sin(t)^2 / sqrt(2) - .04;y:sin(2t)/2
 `,whale:`
 split:240;rotate:180;R:3.4 * (sin(t)^2 - .5) * cos(t);x:cos(t) * R + .75;y:sin(t) * R * 1.2
 `,windmill:`
 split:18;R:seq(.618, 1, 0);T:seq(t-.55, t, t);x:R * cos(T);y:R * sin(T)
 `,vase:`
 split:240;scale:.3;x:sin(4t) + sin(t) * 1.4;y:cos(t) + cos(t) * 4.8 + .3
 `,clover:(e=3)=>((e=O(e,3,5))==4&&(e=2),`
 split:240;r:cos(${e}t);scale:.98
`),hypocycloid:(e=3)=>`
 split:240;scale:${[.34,.25,.19][(e=O(e,3,5))-3]};k:${e};x:(k-1)*cos(t) + cos((k-1)*t);y:(k-1)*sin(t) - sin((k-1)*t)
`,bud:(e=3)=>`
 split:240;scale:.8;r:1 + .2 * cos(${e=O(e,3,10)}t)
`};class Kt{constructor(t,r,n){this.x=t,this.y=r,this.extra=n}valueOf(){return this.x+" "+this.y}toString(){return this.valueOf()}}function pn(e,t){t||(t=d=>[ce(d),he(d)]);let r,n,i=e.split||180,s=e.turn||1,a=e.frame,l=e.fill||e["fill-rule"],o=hn(e.direction||e.dir||""),u=e.unit,c=2*ut*s/i,h=[],f=e.scale===void 0?1:e.scale,p=([d,g,v=0,m=0])=>{if(d=="evenodd"||d=="nonzero")return h.push(new Kt(d,"",""));let[b,x]=Jt(d,-g,f),[_,y]=Jt(v,-m,f),w=function(k,S,N,D,C){let B=180*Zt(S+D,k-N)/ut;return C.direction==="reverse"&&(B-=180),C.direction||(B=90),C.angle&&(B+=C.angle),B}(b,x,_,y,o);u!==void 0&&u!=="%"?u!=="none"&&(b+=u,x+=u):(b=50*(b+1)+"%",x=50*(x+1)+"%"),h.push(new Kt(b,x,w))};l!="nonzero"&&l!="evenodd"||p([l,"",""]);for(let d=0;d<i;++d){let g=t(c*d,d);d||(r=g),p(g)}if(a!==void 0){p(r);let d=a/100;s>1&&(d*=2),d==0&&(d=.002);for(let g=0;g<i;++g){let v=-c*g,[m,b,x=0,_=0]=t(v,g),y=Zt(b+_,m-x),w=[m-d*ce(y),b-d*he(y)];g||(n=w),p(w)}p(n),p(r)}return h}function Jt(e,t,r){let[n,i=n]=R(r).map(Number);return[e*n,t*i]}function dn(e,{min:t,max:r}){let n=O(parseInt(e.vertices||e.points||e.split)||0,t,r),i=L(e.x)?"cos(t)":e.x,s=L(e.y)?"sin(t)":e.y,a=L(e.r)?"":e.r,l=L(e.t)?"":e.t,{unit:o,value:u}=le(a);return o&&!e[o]&&o!=="t"&&(L(e.unit)&&(e.unit=o),a=e.r=u),e.degree&&(e.rotate=e.degree),e.origin&&(e.move=e.origin),e.split=n,pn(e,(c,h)=>{let f=Object.assign({},e,{t:l||c,θ:l||c,i:h+1,seq:(...m)=>m.length?m[h%m.length]:"",range:(m,b=0)=>((m=Number(m)||0)>(b=Number(b)||0)&&([m,b]=[b,m]),m+fn(b-m)/(n-1)*h)}),p=q(i,f),d=q(s,f),g=0,v=0;if(a){let m=q(a,f);m==0&&(m=1e-5),l&&(c=q(l,f)),p=m*ce(c),d=m*he(c)}return e.rotate&&([p,d]=function(m,b,x){let _=-ut/180*x;return[m*ce(_)-b*he(_),b*ce(_)+m*he(_)]}(p,d,Number(e.rotate)||0)),e.move&&([p,d,g,v]=function(m,b,x){let[_,y=_]=R(x).map(Number);return[m+(_||0),b-(y||0),_,y]}(p,d,e.move)),[p,d,g,v]})}function fe(e,t=3,r=3600,n){let i="",[s,...a]=R(e),l=!1;switch(typeof ct[s]){case"function":i=ct[s](...a),l=!0;break;case"string":i=ct[s],l=!0;break;default:i=e}let o=function(u){let c,h=P(W(u)),f={},p=[],d=!1;for(;h.next();){let{prev:g,curr:v,next:m}=h.get();if(v.isSymbol(":")&&!c)c=ot(p),p=[];else if(v.isSymbol(";")&&c)f[c]=Vt(c,ot(p),d),p=[],c=null,d=!1;else if(!v.isSymbol(";")){let b=g&&g.isSymbol("-"),x=m&&m.isSymbol("-"),_=v.isSymbol("-");c||p.length||!_||b||x||m&&m.isSymbol(":")?p.push(v):d=!0}}return p.length&&c&&(f[c]=Vt(c,ot(p),d)),f}(i);return typeof n=="function"&&(o=n(o)),{rules:o,points:dn(o,{min:t,max:r}),preset:l}}function ht(e){return Z((t,r,...n)=>{if(!n||!r)return"";let i=E(r()),s=i;/\D/.test(i)&&!/\d+[x-]\d+/.test(i)&&(s=q(i),s===0&&(s=i));let a=Math.random();return function(l,o){let[u,c=1]=String(l).split(/[x-]/),[h,f]=[Math.ceil(u),Math.ceil(c)];ee(h)&&(h=1),ee(f)&&(f=1),u=O(h,0,65536),c=O(f,0,65536);let p=u*c,d=[],g=1;if(/x/.test(l))for(let v=1;v<=c;++v)for(let m=1;m<=u;++m)d.push(o(g,m,v,p,u,c,g)),g++;else if(/-/.test(l))if(p=Math.abs(u-c)+1,u<=c)for(let v=u;v<=c;++v)d.push(o(v,v,1,p,p,1,g++));else for(let v=u;v>=c;--v)d.push(o(v,v,1,p,p,1,g++));else for(let v=1;v<=u;++v)d.push(o(v,v,1,u,u,1,g++));return d}(s,(...l)=>n.map(o=>E(o(...l,a))).join(",")).join(e)})}function G(e,t,r){return e[t]||(e[t]=new nn(1024)),e[t].push(r),r}function Qt(e){return-1*e}function er(e,t,r){switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":return t/r;case"%":return t%r;default:return 0}}function T(e){return t=>{if(L(t)||L(e))return e;if(/^[\+\*\-\/%][\-\.\d\s]/.test(t)){let r=t[0],{unit:n="",value:i}=le(t.substr(1).trim()||0);return/^var/.test(e)?`calc((${e} ${r} ${i}) * 1${n})`:er(r,e,i)+n}if(/[\+\*\-\/%]$/.test(t)){let r=t.substr(-1),{unit:n="",value:i}=le(t.substr(0,t.length-1).trim()||0);return/^var/.test(e)?`calc((${i} ${r} ${e}) * 1${n})`:er(r,i,e)+n}{let{unit:r="",value:n}=le(t||0);return e+n+r}}}const ze=De({i:({count:e})=>T(e),y:({y:e})=>T(e),x:({x:e})=>T(e),z:({z:e})=>T(e),I:({grid:e})=>T(e.count),Y:({grid:e})=>T(e.y),X:({grid:e})=>T(e.x),Z:({grid:e})=>T(e.z),iI:({count:e,grid:t})=>T(e/t.count),id:({x:e,y:t,z:r})=>n=>te(e,t,r),dx:({x:e,grid:t})=>r=>(r=Number(r)||0,e-.5-r-t.x/2),dy:({y:e,grid:t})=>r=>(r=Number(r)||0,e-.5-r-t.y/2),n({extra:e}){let t=A(e);return t?T(t[0]):"@n"},nx({extra:e}){let t=A(e);return t?T(t[1]):"@nx"},ny({extra:e}){let t=A(e);return t?T(t[2]):"@ny"},N({extra:e}){let t=A(e);return t?T(t[3]):"@N"},nN({extra:e}){let t=A(e);return t?T(t[0]/t[3]):"@nN"},m:ht(","),M:ht(" "),µ:ht(""),p:({context:e,pick:t})=>ae((...r)=>{r.length||(r=e.last_pick_args||[]);let n=t(r);return e.last_pick_args=r,G(e,"last_pick",n)}),P({context:e,pick:t,position:r}){let n="P-counter"+r;return ae((...i)=>{let s=!0;i.length||(i=e.last_pick_args||[],s=!1);let a=e.last_pick,l=a?a.last(1):"";if(s&&(e[n]||(e[n]={}),l=e[n].last_pick),i.length>1){let u=i.findIndex(c=>c===l);u!==-1&&i.splice(u,1)}let o=t(i);return e.last_pick_args=i,s&&(e[n].last_pick=o),G(e,"last_pick",o)})},pl({context:e,extra:t,position:r}){let n=A(t),i="pl-counter"+r+(n?A(n):"");return ae((...s)=>{e[i]||(e[i]=0),e[i]+=1;let a=s.length,l=n&&n[6];j(l)&&(l=e[i]);let o=s[(l-1)%a];return G(e,"last_pick",o)})},pr({context:e,extra:t,position:r}){let n=A(t),i="pr-counter"+r+(n?A(n):"");return ae((...s)=>{e[i]||(e[i]=0),e[i]+=1;let a=s.length,l=n&&n[6];j(l)&&(l=e[i]);let o=s[a-(l-1)%a-1];return G(e,"last_pick",o)})},pd({context:e,extra:t,position:r,shuffle:n}){let i=A(t),s=i?A(i):"",a="pd-counter"+r+s,l="pd-values"+r+s;return ae((...o)=>{e[a]||(e[a]=0),e[a]+=1,e[l]||(e[l]=n(o||[]));let u=o.length,c=i&&i[6];j(c)&&(c=e[a]);let h=(c-1)%u,f=e[l][h];return G(e,"last_pick",f)})},lp:({context:e})=>(t=1)=>{let r=e.last_pick;return r?r.last(t):""},r:({context:e,rand:t})=>(...r)=>{let n=(r.every(Be)?Qe:Ft)(t)(...r);return G(e,"last_rand",n)},rn({x:e,y:t,context:r,position:n,grid:i,extra:s,random:a}){let l="noise-2d"+n,o=l+"offset-x",u=l+"offset-y",[c,h,f,p,d,g]=A(s)||[],v=c&&p;return(...m)=>{let{from:b=0,to:x=b,frequency:_=1,scale:y=1,octave:w=1}=Xt(m,["from","to","frequency","scale","octave"]);_=O(_,0,1/0),y=O(y,0,1/0),w=O(w,1,100),m.length==1&&([b,x]=[0,b]),r[l]||(r[l]=new sn),r[o]||(r[o]=a()),r[u]||(r[u]=a());let k=Be(b)&&Be(x)?Qe:Ft,S=r[l],N=r[o],D=r[u],C=(v?(h-1)/d:(e-1)/i.x)+N,B=(v?(f-1)/g:(t-1)/i.y)+D;(d<=1||i.x<=1)&&(C=0),(g<=1||i.y<=1)&&(B=0),C==0&&B==0&&(C=N,B=D);let Sr=S.noise(C*_,B*_,0)*y;for(let ge=1;ge<w;++ge){let ve=2*ge;Sr+=S.noise(C*_*ve,B*_*ve,0)*(y/ve)}let zn=k((ge,ve)=>function(Cn,Mn,Pn,bt=1){let jr=Math.sqrt(.5)*bt,[Ar,In]=[-jr,jr];return F((Cn-Ar)/(In-Ar),Mn*bt,Pn*bt)}(Sr,ge,ve,y));return G(r,"last_rand",zn(b,x))}},lr:({context:e})=>(t=1)=>{let r=e.last_rand;return r?r.last(t):""},stripe:()=>(...e)=>{let t,r=e.map(E),n=r.length,i=0,s=[];if(!n)return"";r.forEach(l=>{let[o,u]=R(l);u!==void 0?s.push(u):i+=1});let a=s.length?`(100% - ${s.join(" - ")}) / ${i}`:`100% / ${n}`;return r.map((l,o)=>{if(s.length){let[u,c]=R(l);return t=(t?t+" + ":"")+(c!==void 0?c:a),`${u} 0 calc(${t})`}return`${l} 0 ${100/n*(o+1)}%`}).join(",")},calc:()=>(e,t)=>q(E(e),t),hex:()=>e=>parseInt(E(e)).toString(16),svg:Z((e,...t)=>{let r=t.map(n=>E(n())).join(",");return r.startsWith("<")||(r=Re(ne(r))),Ae(Ut(r))}),"svg-filter":Z((e,...t)=>{let r=t.map(s=>E(s())),n=r.join(","),i=be("filter-");if(r.every(s=>/^[\-\d.]/.test(s)||/^(\w+)/.test(s)&&!/[{}<>]/.test(s))){let{frequency:s,scale:a,octave:l,seed:o=e.seed,blur:u,erode:c,dilate:h}=Xt(r,["frequency","scale","octave","seed","blur","erode","dilate"]);if(n=`
 x:-20%;y:-20%;width:140%;height:140%;`,j(h)||(n+=`
 feMorphology{operator:dilate;radius:${h};}`),j(c)||(n+=`
 feMorphology{operator:erode;radius:${c};}`),j(u)||(n+=`
 feGaussianBlur{stdDeviation:${u};}`),!j(s)){let[f,p=f]=R(s);l=l?`numOctaves:${l};`:"",n+=`
 feTurbulence{type:fractalNoise;baseFrequency:${f} ${p};seed:${o};${l}}`,a&&(n+=`
 feDisplacementMap{in:SourceGraphic;scale:${a};}`)}}return n.startsWith("<")||(n=Re(ne(n,{type:"block",name:"filter"}))),Ae(Ut(n).replace(/<filter([\s>])/,`<filter id="${i}"$1`),i)}),"svg-pattern":Z((e,...t)=>Ae(Re(ne(`
 viewBox:0 0 1 1;preserveAspectRatio:xMidYMid slice;rect{width, height:100%;fill:defs pattern{${t.map(r=>E(r())).join(",")}}}`)))),"svg-polygon":Z((e,...t)=>{let r=t.map(l=>E(l())).join(","),{rules:n,points:i}=fe(r,3,65536,l=>(delete l.frame,l.unit="none",l["stroke-width"]??=.01,l.stroke??="currentColor",l.fill??="none",l)),s=`points:${i};`,a="";for(let l of Object.keys(n))/^(stroke|fill|clip|marker|mask|animate|draw)/.test(l)&&(a+=`${l}:${n[l]};`);return Ae(Re(ne(`
 viewBox:-1 -1 2 2 p ${Number(n["stroke-width"])/2};polygon{${a} ${s}}`)))}),var:()=>e=>`var(${E(e)})`,ut:()=>T(`var(--${z.name})`),uw:()=>T(`var(--${st})`),uh:()=>T(`var(--${lt})`),ux:()=>T(`var(--${nt})`),uy:()=>T(`var(--${it})`),plot({count:e,context:t,extra:r,position:n,grid:i}){let s="offset-points"+n,a=A(r);return(...l)=>{let o=l.join(","),[u=e,c,h,f=i.count]=a||[];if(!t[s]){let{points:p}=fe(o,1,65536,d=>(delete d.fill,delete d["fill-rule"],delete d.frame,d.points=f,d));t[s]=p}return t[s][u-1]}},Plot({count:e,context:t,extra:r,position:n,grid:i}){let s="Offset-points"+n,a=A(r);return(...l)=>{let o=l.join(","),[u=e,c,h,f=i.count]=a||[];if(!t[s]){let{points:p}=fe(o,1,65536,d=>(delete d.fill,delete d["fill-rule"],delete d.frame,d.points=f,d.unit=d.unit||"none",d));t[s]=p}return t[s][u-1]}},shape:()=>et("shape-function",(...e)=>{let t=e.join(","),{points:r}=fe(t);return`polygon(${r.join(",")})`}),doodle:()=>e=>e,shaders:()=>e=>e,pattern:()=>e=>e,invert:()=>e=>{let t=Te(e);return t.valid?t.commands.map(({name:r,value:n})=>{switch(r){case"v":return"h"+n.join(" ");case"V":return"H"+n.join(" ");case"h":return"v"+n.join(" ");case"H":return"V"+n.join(" ");default:return r+n.join(" ")}}).join(" "):e},flipH:()=>e=>{let t=Te(e);return t.valid?t.commands.map(({name:r,value:n})=>{switch(r){case"h":case"H":return r+n.map(Qt).join(" ");default:return r+n.join(" ")}}).join(" "):e},flipV:()=>e=>{let t=Te(e);return t.valid?t.commands.map(({name:r,value:n})=>{switch(r){case"v":case"V":return r+n.map(Qt).join(" ");default:return r+n.join(" ")}}).join(" "):e},flip(...e){let t=ze.flipH(...e),r=ze.flipV(...e);return n=>r(t(n))},reverse:()=>(...e)=>{let t=e.map(E),r=Te(t.join(","));if(r.valid){let n=[];for(let i=r.commands.length-1;i>=0;--i){let{name:s,value:a}=r.commands[i];n.push(s+a.join(" "))}return n.join(" ")}return t.reverse()},cycle:()=>(...e)=>{let t,r=[];(e=e.map(s=>"<"+s+">")).length==1?(t=" ",r=R(e[0],{symbol:t})):(t=",",r=R(e.map(E).join(t),{symbol:t})),r=r.map(s=>s.replace(/^\<|>$/g,""));let n=r.length-1,i=[r.join(t)];for(let s=0;s<n;++s){let a=r.shift();r.push(a),i.push(r.join(t))}return i},mirror:()=>(...e)=>{for(let t=e.length-1;t>=0;--t)e.push(e[t]);return e},Mirror:()=>(...e)=>{for(let t=e.length-2;t>=0;--t)e.push(e[t]);return e},code:()=>(...e)=>e.map(t=>String.fromCharCode(t)),once:Z(({context:e,extra:t,position:r},...n)=>{let i="once-counter"+r;return j(e[i])?e[i]=n.map(s=>E(s())).join(","):e[i]}),raw:({rules:e})=>(t="")=>{try{let r=t.substring(t.indexOf(",")+1,t.lastIndexOf('")'));if(t.startsWith("${doodle")&&t.endsWith("}")){let n=t.substring(2,t.length-1),i=e.doodles;if(i&&i[n])return`<css-doodle>${i[n].doodle}</css-doodle>`}if(t.startsWith('url("data:image/svg+xml;utf8'))return decodeURIComponent(r);if(t.startsWith('url("data:image/svg+xml;base64'))return atob(r);if(t.startsWith('url("data:image/png;base64'))return`<img src="${t}" alt="" />`}catch{}return t}},{index:"i",col:"x",row:"y",depth:"z",rand:"r",pick:"p",pn:"pl",pnr:"pr",stripes:"stripe",strip:"stripe",patern:"pattern",flipv:"flipV",fliph:"flipH",t:"ut",filter:"svg-filter","last-rand":"lr","last-pick":"lp",multiple:"m",multi:"m",rep:"µ",repeat:"µ",ms:"M",s:"I",size:"I",sx:"X","size-x":"X","size-col":"X","max-col":"X",sy:"Y","size-y":"Y","size-row":"Y","max-row":"Y",sz:"Z","size-z":"Z","size-depth":"Z",Svg:"svg","pick-by-turn":"pl","pick-n":"pl","pick-d":"pd",offset:"plot",Offset:"Plot",point:"plot",Point:"Plot",unicode:"code"}),tr={a0:[841,1189],a1:[594,841],a2:[420,594],a3:[297,420],a4:[210,297],a5:[148,210],a6:[105,148],b0:[1e3,1414],b1:[707,1e3],b2:[500,707],b3:[353,500],b4:[250,353],b5:[176,250],b6:[125,176],c0:[917,1297],c1:[648,917],c2:[458,648],c3:[324,458],c4:[229,324],c5:[162,229],d0:[764,1064],d1:[532,760],d2:[380,528],d3:[264,376],d4:[188,260],d5:[130,184],d6:[92,126],letter:[216,279],postcard:[100,148],poster:[390,540]},mn={portrait:"p",pt:"p",p:"p",landscape:"l",ls:"l",l:"l"};let Ce=[];function rr(e){let t=new RegExp(`\\-?${e}\\-?`);return function(r){if(!Ce.length){let n=new Set;if(typeof document<"u")for(let i in document.head.style)i.startsWith("-")||n.add(i.replace(/[A-Z]/g,"-$&").toLowerCase());n.has("grid-gap")||n.add("grid-gap"),Ce=Array.from(n)}return r instanceof RegExp?Ce.filter(n=>r.test(n)):Ce}(t).map(r=>r.replace(t,"")).reduce((r,n)=>(r[n]=n,r),{})}const gn=rr("webkit"),vn=rr("moz");function nr(e,t){return gn[e]?`-webkit-${t} ${t}`:vn[e]?`-moz-${t} ${t}`:t}const ir="--_cell-width",sr="--_cell-height",yn={center:"50%",left:"0%",right:"100%",top:"50%",bottom:"50%"},bn={center:"50%",top:"0%",bottom:"100%",left:"50%",right:"50%"};var Me=De({size(e,{is_special_selector:t,grid:r}){let[n,i=n,s]=R(e);tr[n]&&([n,i]=function(l,o){l=String(l).toLowerCase();let[u,c]=tr[l]||[];return mn[o]=="p"&&([c,u]=[u,c]),[c,u].map(h=>h+"mm")}(n,i));let a=`width:${n};height:${i};`;return n!=="auto"&&i!=="auto"||(s&&(/^\(.+\)$/.test(s)?s=s.substring(1,s.length-1):/^calc/.test(s)||(s=`calc(${s})`),t||(a+=`aspect-ratio:${s};`)),t&&(a+=`aspect-ratio:${s||r.ratio};`)),t||(a+=`${ir}:${n};${sr}:${i};`),a},place(e,{extra:t}){let[r,n="50%"]=R(e);r=yn[r]||r,n=bn[n]||n;let i=`var(${ir}, 25%)`,s=`var(${sr}, 25%)`;return`
 position:absolute;left:${r};top:${n};width:${i};height:${s};margin-left:calc(${i} / -2);margin-top:calc(${s} / -2);grid-area:unset;--plot-angle:${t||0};rotate:${t||0}deg;`},grid(e,t){let r={clip:!0,p3d:!1},n=[];for(let s of R(e,{symbol:" "}))/^no\-*clip$/i.test(s)?r.clip=!1:/^p3d$/i.test(s)?r.p3d=!0:n.push(s);let i=R(n.join(" "),{symbol:["/","+","^","*","|","-","~","∆"],noSpace:!0,verbose:!0});for(let{group:s,value:a}of i)s==="+"&&(r.scale=a),s==="^"&&(r.enlarge=a),s==="*"&&(r.rotate=a),s==="~"&&(r.translate=a),s==="∆"&&(r.persp=R(a,{symbol:" "})),s==="/"&&(r.size===void 0?r.size=this.size(a,t):r.fill=a),s!=="|"&&s!="-"&&s!=""||r.grid||(r.grid=ie(a,t.max_grid),s==="|"&&(r.flexCol=!0),s==="-"&&(r.flexRow=!0));return r},gap:e=>e,seed:e=>e,shape:et("shape-property",e=>{let{points:t,preset:r}=fe(e);if(!r)return"";let n="clip-path";return nr(n,`${n}:polygon(${t.join(",")});`)}),use(e){if(e.length>2)return e},content:e=>e},{"place-cell":"place",offset:"place",position:"place"});function lr(e,t){return t==="+"?e:t==="-"?-1*e:e}function ar(e){return e.reduce((t,r)=>t+r,0)}function ft(e){return e%2}function or(e){return!ft(e)}function pt(e){let t="";return t=e==0?"$:hover":e>0?`$:hover ${"+*".repeat(e)}`:`:has(+ ${"*+".repeat(Math.abs(e+1))} $:hover)`,t}function dt(e,t){if(e==="even")return or(t);if(e==="odd")return ft(t);if(e=="n")return!0;let{a:r,b:n,error:i}=function(s){let a,l,o=P(W(s)),u=[],c=[];for(;o.next();){let{prev:h,curr:f,next:p}=o.get(),d=f.value;if(f.isSymbol()){if(d!=="+"&&d!=="-"){l="Unexpected "+f.value;break}a=d}else if(f.isNumber()){if((u.length||c.length)&&!a){l="Syntax error";break}if(d=lr(Number(d),a),a=null,p&&p.value==="n"){u.push(d),o.next();continue}c.push(d)}else if(d==="n"){if((u.length||c.length)&&!a){l="Syntax error";break}u.push(lr(1,a)),a=null}else if(!f.isSpace()){l="Unexpected "+d;break}}return l?{a:0,b:0,error:l}:{a:ar(u),b:ar(c)}}(e);if(i)return!1;if(r===0)return t===n;{let s=(t-n)/r;return s>=0&&Number.isInteger(s)}}var ur,xn=De({at:({x:e,y:t})=>(r,n)=>e==r&&t==n,nth:({count:e,grid:t})=>(...r)=>{for(let n of r)if(dt(n,e))return!0},y:({y:e,grid:t})=>(...r)=>{for(let n of r)if(dt(n,e))return!0},x:({x:e,grid:t})=>(...r)=>{for(let n of r)if(dt(n,e))return!0},even:({x:e,y:t})=>r=>ft(e+t),odd:({x:e,y:t})=>r=>or(e+t),random:({random:e,count:t,x:r,y:n,grid:i})=>(s=.5)=>/\D/.test(s)?e()<q("("+s+")",{x:r,X:i.x,y:n,Y:i.y,i:t,I:i.count,random:e}):e()<s,match:({count:e,grid:t,x:r,y:n,random:i})=>s=>!!q("("+s+")",{x:r,X:t.x,y:n,Y:t.y,i:e,I:t.count,random:i}),hover:({count:e,x:t,y:r,grid:n,random:i})=>(...s)=>{let a=[];s.length||a.push(pt(0));for(let l of s){let[o,u]=String(l).split(/\s+/);if(o=Number(o),u=Number(u),Number.isNaN(u)&&!Number.isNaN(o)&&a.push(pt(o)),!Number.isNaN(o)&&!Number.isNaN(u)){let c=o+t,h=u+r;if(c>=1&&c<=n.x&&h>=1&&h<=n.y){let f=u*n.y+o;a.push(pt(f))}}}return!!a.length&&{selector:a.join(",")}}},{col:"x",row:"y"}),pe=globalThis,de=Math,Pe=[],X=256,cr=6,_n="random",$n=de.pow(X,cr),hr=de.pow(2,52),wn=2*hr,V=X-1;function Ie(e,t,r){var n=[],i=mt(pr((t=t==1?{entropy:!0}:t||{}).entropy?[e,me(Pe)]:e??function(){try{var l;return ur&&(l=ur.randomBytes)||(l=new Uint8Array(X),(pe.crypto||pe.msCrypto).getRandomValues(l)),me(l)}catch{var o=pe.navigator,u=o&&o.plugins;return[+new Date,pe,u,pe.screen,me(Pe)]}}(),3),n),s=new kn(n),a=function(){for(var l=s.g(cr),o=$n,u=0;l<hr;)l=(l+u)*X,o*=X,u=s.g(1);for(;l>=wn;)l/=2,o/=2,u>>>=1;return(l+u)/o};return a.int32=function(){return 0|s.g(4)},a.quick=function(){return s.g(4)/4294967296},a.double=a,mt(me(s.S),Pe),(t.pass||r||function(l,o,u,c){return c&&(c.S&&fr(c,s),l.state=function(){return fr(s,{})}),u?(de[_n]=l,o):l})(a,i,"global"in t?t.global:this==de,t.state)}function kn(e){var t,r=e.length,n=this,i=0,s=n.i=n.j=0,a=n.S=[];for(r||(e=[r++]);i<X;)a[i]=i++;for(i=0;i<X;i++)a[i]=a[s=V&s+e[i%r]+(t=a[i])],a[s]=t;(n.g=function(l){for(var o,u=0,c=n.i,h=n.j,f=n.S;l--;)o=f[c=V&c+1],u=u*X+f[V&(f[c]=f[h=V&h+o])+(f[h]=o)];return n.i=c,n.j=h,u})(X)}function fr(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function pr(e,t){var r,n=[],i=typeof e;if(t&&i=="object")for(r in e)try{n.push(pr(e[r],t-1))}catch{}return n.length?n:i=="string"?e:e+"\0"}function mt(e,t){for(var r,n=e+"",i=0;i<n.length;)t[V&i]=V&(r^=19*t[V&i])+n.charCodeAt(i++);return me(t)}function me(e){return String.fromCharCode.apply(0,e)}function H(e){return/^\:(host|doodle)/.test(e)}function Oe(e){return/^\:(container|parent)/.test(e)}function gt(e){return H(e)||Oe(e)}mt(de.random(),Pe);const dr={};for(let e of Object.getOwnPropertyNames(Math))dr[e]=()=>(...t)=>typeof Math[e]=="number"?Math[e]:(t=t.map(r=>q(E(r))),Math[e](...t));class Sn{constructor(t){this.tokens=t,this.rules={},this.props={},this.keyframes={},this.grid=null,this.seed=null,this.is_grid_set=!1,this.is_gap_set=!1,this.coords=[],this.doodles={},this.pattern={},this.shaders={},this.vars={},this.uniforms={},this.content={},this.reset()}reset(){this.styles={host:"",container:"",cells:"",keyframes:""},this.coords=[],this.doodles={},this.pattern={},this.shaders={},this.content={};for(let t in this.rules)t.startsWith("#c")&&delete this.rules[t]}add_rule(t,r){let n=this.rules[t];n||(n=this.rules[t]=[]),n.push.apply(n,xe(r))}pick_func(t){return t.startsWith("$")&&(t="calc"),ze[t]||dr[t]}apply_func(t,r,n,i,s={}){let a=t(...xe(r)),l=[];if(n.forEach(o=>{let u=typeof o.value;if(o.cluster||u!=="number"&&u!=="string"){if(typeof o=="function")l.push(o);else if(!j(o.value)){let c=E(o.value);l.push(c)}}else l.push(...R(o.value,{noSpace:!0}))}),l=xe(l.filter(o=>!j(o)&&String(o).trim().length)),typeof a=="function"){if(i.startsWith("$")){let o=Object.assign({},this.vars.host,this.vars.container,this.vars[r.count],s),u={},c="";for(let[h,f]of Object.entries(o))u[h.substr(2)]=f;return i.length>1&&(c=i.split("$")[1]??""),a(l,u)+c}return a(...l)}return a}compose_aname(...t){return t.join("-")}compose_selector({x:t,y:r,z:n},i=""){return`#${te(t,r,n)}${i}`}is_composable(t){return["doodle","shaders","pattern"].includes(t)}read_var(t,r,n){let i=r.count,s=Object.assign({},this.vars.host,this.vars.container,this.vars[i],n);if(s[t]!==void 0){let a=String(s[t]).trim();return a[0]=="("&&a[a.length-1]===")"&&(a=a.substring(1,a.length-1)),a.replace(/;+$/g,"")}return t}compose_argument(t,r,n=[],i,s){r.extra||(r.extra=[]),r.extra.push(n);let a=t.map(l=>{if(l.type==="text")return/^\-\-\w/.test(l.value)?i&&i.name==="@var"?l.value:this.read_var(l.value,r,s):l.value;if(l.type==="func"){let o=l.name.substr(1),u=this.pick_func(o);if(typeof u=="function"){if(this.check_uniforms(o),this.is_composable(o)){let h,f=E((l.arguments[0]||[])[0]);if(o==="doodle"&&/^\d/.test(f)&&(h=f,f=E((l.arguments[1]||[])[0])),!j(f))switch(o){case"doodle":return this.compose_doodle(this.inject_variables(f,r.count),h);case"shaders":return this.compose_shaders(f,r);case"pattern":return this.compose_pattern(f,r)}}r.position=l.position;let c=l.arguments.map(h=>u.lazy?(...f)=>this.compose_argument(h,r,f,l,s):this.compose_argument(h,r,n,l,s));return this.apply_func(u,r,c,o,s)}return l.name}});return r.extra.pop(),{cluster:t.cluster,value:a.length>=2?{value:a.join("")}:a[0]}}compose_doodle(t,r){let n=be("doodle");return this.doodles[n]={doodle:t,arg:r},"${"+n+"}"}compose_shaders(t,{x:r,y:n,z:i}){let s=be("shader");return this.shaders[s]={shader:t,id:"--"+s,cell:te(r,n,i)},"${"+s+"}"}compose_pattern(t,{x:r,y:n,z:i}){let s=be("pattern");return this.pattern[s]={code:t,id:"--"+s,cell:te(r,n,i)},"${"+s+"}"}check_uniforms(t){switch(t){case"ut":case"t":this.uniforms.time=!0;break;case"ux":this.uniforms.mousex=!0;break;case"uy":this.uniforms.mousey=!0;break;case"uw":this.uniforms.width=!0;break;case"uh":this.uniforms.height=!0}}inject_variables(t,r){let n=Object.assign({},this.vars.host,this.vars.container,this.vars[r]),i=[];for(let[s,a]of Object.entries(n))i.push(`${s}:${a};`);return i=i.join(""),i.length?`:doodle{${i}}`+t:t}compose_variables(t,r,n={}){for(let[i,s]of Object.entries(t))n[i]=this.get_composed_value(s,r,n).value;return n}compose_value(t,r,n={}){if(!Array.isArray(t))return{value:"",extra:""};let i="";return{value:t.reduce((a,l)=>{switch(l.type){case"text":a+=l.value;break;case"func":{let o=l.name.substr(1),u=this.pick_func(o);if(typeof u=="function")if(this.check_uniforms(o),this.is_composable(o)){let c,h=E((l.arguments[0]||[])[0]);if(o==="doodle"&&/^\d/.test(h)&&(c=h,h=E((l.arguments[1]||[])[0])),!j(h))switch(o){case"doodle":a+=this.compose_doodle(this.inject_variables(h,r.count),c);break;case"shaders":a+=this.compose_shaders(h,r);break;case"pattern":a+=this.compose_pattern(h,r)}}else{r.position=l.position,l.variables&&this.compose_variables(l.variables,r,n);let c=l.arguments.map(f=>u.lazy?(...p)=>this.compose_argument(f,r,p,l,n):this.compose_argument(f,r,[],l,n)),h=this.apply_func(u,r,c,o,n);j(h)||(a+=h,h.extra&&(i=h.extra))}else a+=l.name}}return a},""),extra:i}}get_composed_value(t,r,n){let i,s=[];return Array.isArray(t)&&(s=t.reduce((a,l)=>{let o=this.compose_value(l,r,n||{});return o&&(o.value&&a.push(o.value),o.extra&&(i=o.extra)),a},[])),{extra:i,group:s,value:s.join(",")}}add_grid_style({fill:t,clip:r,rotate:n,scale:i,translate:s,enlarge:a,skew:l,persp:o,flexRow:u,flexCol:c,p3d:h}){if(t&&this.add_rule(":host",`background-color:${t};`),r||this.add_rule(":host","contain:none;"),n&&this.add_rule(":container",`rotate:${n};`),i&&this.add_rule(":container",`scale:${i};`),s&&this.add_rule(":container",`translate:${s};`),o){let[f,...p]=o;this.add_rule(":container",`perspective:${f};`),p.length&&this.add_rule(":container",`perspective-origin:${p.join(" ")};`)}if(a&&this.add_rule(":container",`
 width:calc(${a} * 100%);height:calc(${a} * 100%);left:50%;top:50%;transform-origin:0 0;transform:translate(-50%, -50%);`),u&&(this.add_rule(":container","display:flex;"),this.add_rule("cell","flex:1;")),c&&(this.add_rule(":container","display:flex;flex-direction:column;"),this.add_rule("cell","flex:1;")),h){let f="transform-style:preserve-3d;";this.add_rule(":host",f),this.add_rule(":container",f)}}compose_rule(t,r,n){let i=Object.assign({},r),s=t.property;if(s==="@seed")return"";let a=this.get_composed_value(t.value,i),l=a.extra,o=a.value;if(/^animation(\-name)?$/.test(s)){if(this.props.has_animation=!0,H(n)){let c=z[s];c&&o&&(o=c+","+o)}if(i.count>1){let{count:c}=i;switch(s){case"animation-name":o=a.group.map(h=>this.compose_aname(h,c)).join(",");break;case"animation":o=a.group.map(h=>{let f=(h||"").split(/\s+/);return f[0]=this.compose_aname(f[0],c),f.join(" ")}).join(",")}}}s==="content"&&(/["']|^none\s?$|^(var|counter|counters|attr|url)\(/.test(o)||(o=`'${o}'`)),s==="transition"&&(this.props.has_transition=!0);let u=`${s}:${o};`;if(u=nr(s,u),s!=="width"&&s!=="height"||gt(n)||(u+=`--_cell-${s}:${o};`),/^(background|background\-image)$/.test(s)&&/\$\{(shader|pattern)/.test(o)&&(u+="background-size:100% 100%;"),/^\-\-/.test(s)&&this.compose_vars(r,n,s,o),/^@/.test(s)&&Me[s.substr(1)]){let c=s.substr(1),h=Me[c](o,{is_special_selector:gt(n),grid:i.grid,max_grid:i.max_grid,extra:l});switch(c){case"grid":H(n)?(u=h.size||"",this.add_grid_style(h)):(u="",this.is_grid_set||(h=Me[c](o,{is_special_selector:!0,grid:i.grid,max_grid:i.max_grid}),this.add_rule(":host",h.size||""),this.add_grid_style(h))),this.grid=i.grid,this.is_grid_set=!0;break;case"gap":u="",this.is_gap_set||(this.add_rule(":container",`gap:${h};`),this.is_gap_set=!0);break;case"content":{u="";let f=this.compose_selector(i);h===void 0||/\:before|\:after/.test(n)||Oe(n)||(this.content[f]=function(p){return p.startsWith('"')&&p.endsWith('"')||p.startsWith("'")&&p.endsWith("'")?p.substring(1,p.length-1):p}(String(h))),this.content[f]=ze.raw({rules:{doodles:this.doodles}})(this.content[f]||"")}case"seed":u="";break;case"place-cell":case"place":case"position":case"offset":H(n)||(u=h);break;case"use":t.value.length&&this.compose(i,t.value),u="";break;default:u=h}}return/^grid/.test(s)&&H(n)&&(this.add_rule(":container",`${s}:${o};`),u=""),u}get_raw_value(t){let r=t.raw();j(r)&&(r="");let[n,...i]=r.split(t.property);return i=i.join(t.property).replace(/^\s*:\s*/,"").replace(/[;}<]$/,"").trim().replace(/[;}<]$/,""),i}compose_vars(t,r,n,i){let s=t.count;Oe(r)&&(s="container"),H(r)&&(s="host"),this.vars[s]||(this.vars[s]={}),this.vars[s][n]=i}pre_compose_rule(t,r,n){let i=Object.assign({},r),s=t.property,a=Object.assign({},this.vars.host,this.vars.container,this.vars[i.count]);if(/^\-\-/.test(s)){let l=this.get_composed_value(t.value,i,a).value;this.compose_vars(r,n,s,l)}switch(s){case"@grid":{let l=this.get_composed_value(t.value,i,a).value,o=s.substr(1),u=Me[o](l,{max_grid:r.max_grid});this.grid=u.grid;break}case"@use":t.value.length&&this.pre_compose(i,t.value)}}pre_compose(t,r){j(this.seed)&&((r||this.tokens).forEach(n=>{if(n.type==="rule"&&n.property==="@seed"&&(this.seed=this.get_raw_value(n)),n.type==="pseudo"&&H(n.selector))for(let i of xe(n.styles))i.type==="rule"&&i.property==="@seed"&&(this.seed=this.get_raw_value(i))}),j(this.seed)||t.update_random(this.seed)),(r||this.tokens).forEach(n=>{switch(n.type){case"rule":this.pre_compose_rule(n,t);break;case"pseudo":H(n.selector)&&(n.styles||[]).forEach(i=>{this.pre_compose_rule(i,t,i.selector)})}})}compose(t,r,n){this.coords.push(t),(r||this.tokens).forEach((i,s)=>{if(i.skip||n&&this.grid)return!1;switch(i.type){case"rule":this.add_rule(this.compose_selector(t),this.compose_rule(i,t));break;case"pseudo":{i.selector.startsWith(":doodle")&&(i.selector=i.selector.replace(/^\:+doodle/,":host"));let a=gt(i.selector);a&&(i.skip=!0),R(i.selector).forEach(l=>{let o=i.styles.map(c=>this.compose_rule(c,t,l)),u=a?l:this.compose_selector(t,l);this.add_rule(u,o)});break}case"cond":{let a=i.name.substr(1),l=xn[a];if(l){let o=i.arguments.map(c=>this.compose_argument(c,t)),u=this.apply_func(l,t,o,a);if(Array.isArray(i.addition))for(let c of i.addition)c==="not"&&(u=!u);u&&(u.selector?i.styles.forEach(c=>{c.type==="rule"&&this.add_rule(u.selector.replaceAll("$",this.compose_selector(t)),this.compose_rule(c,t)),c.type==="pseudo"&&c.selector.split(",").forEach(h=>{let f=c.styles.map(p=>this.compose_rule(p,t,h));this.add_rule((u.selector+h).replaceAll("$",this.compose_selector(t)),f)})}):this.compose(t,i.styles))}break}case"keyframes":this.keyframes[i.name]||(this.keyframes[i.name]=a=>`
 ${_e(i.steps.map(l=>`
 ${this.get_composed_value(l.name,a).value}{${_e(l.styles.map(o=>this.compose_rule(o,a)))}}`))}`)}})}output(){for(let[a,l]of Object.entries(this.rules))if(Oe(a))this.styles.container+=`grid{${_e(l)}}`;else{let o=H(a)?"host":"cells",u=_e(l).trim();if(u.length){let c=o==="host"?`${a},.host`:a;this.styles[o]+=`${c}{${u}}`}}this.uniforms.time&&(this.styles.container+=`
:host,.host{animation:${z.animation};}`,this.styles.keyframes+=`
 @keyframes ${z["animation-name"]}{from{--${z.name}:0} to{--${z.name}:${z["animation-duration"]/10}}}`),this.coords.forEach((a,l)=>{for(let[o,u]of Object.entries(this.keyframes)){let c=this.compose_aname(o,a.count);this.styles.keyframes+=`
 ${l===0?`@keyframes ${o}{${u(a)}}`:""} @keyframes ${c}{${u(a)}}`}});let{keyframes:t,host:r,container:n,cells:i}=this.styles,s=t+r+n;return{props:this.props,styles:{main:s,cells:i,all:s+i},grid:this.grid,seed:this.seed,random:this.random,doodles:this.doodles,shaders:this.shaders,pattern:this.pattern,uniforms:this.uniforms,content:this.content}}}function mr(e,t,r,n,i){let s=new Sn(e),a=i||Ie(String(r)),l={};function o(p=0,d){return arguments.length==1&&([p,d]=[0,p]),F(a(),p,d)}function u(...p){let d=p.reduce((g,v)=>g.concat(v),[]);return d[~~(a()*d.length)]}function c(p){let d=[...p],g=p.length;for(;g;){let v=~~(a()*g--),m=d[g];d[g]=d[v],d[v]=m}return d}s.pre_compose({x:1,y:1,z:1,count:1,context:{},grid:{x:1,y:1,z:1,count:1},random:a,rand:o,pick:u,shuffle:c,max_grid:n,update_random:function(p){a=Ie(String(p))},seed_value:r,rules:s});let{grid:h,seed:f}=s.output();if(h&&(t=h),f?(f=String(f),a=Ie(f)):f=r,j(f)&&(f=Date.now(),a=Ie(f)),f=String(f),s.seed=f,s.random=a,s.reset(),t.z==1)for(let p=1,d=0;p<=t.y;++p)for(let g=1;g<=t.x;++g)s.compose({x:g,y:p,z:1,count:++d,grid:t,context:l,rand:o,pick:u,shuffle:c,random:a,seed:f,max_grid:n,rules:s});else for(let p=1,d=0;p<=t.z;++p)s.compose({x:1,y:1,z:p,count:++d,grid:t,context:l,rand:o,pick:u,shuffle:c,random:a,seed:f,max_grid:n,rules:s});return s.output()}function gr(e,t,r){let n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}function Q(e,t){return e.includes(t)?e:t+`
`+e}function vr(e,t){let r=J.get(e);if(r)return Promise.resolve(r);let n=document.createElement("canvas"),i=devicePixelRatio||1,s=n.width=e.width*i,a=n.height=e.height*i,l=[],o=n.getContext("webgl2",{preserveDrawingBuffer:!0});if(!o)return Promise.resolve("");let u=Q(e.fragment||"","uniform vec2 u_resolution;");u=Q(u,"uniform float u_time;"),u=Q(u,"uniform float u_timeDelta;"),u=Q(u,"uniform int u_frameIndex;"),u=Q(u,"uniform vec2 u_seed;"),e.textures.forEach(x=>{let _=`uniform sampler2D ${x.name};`;u=Q(u,_)}),/(^|[^\w\_])void\s+mainImage\(\s*out\s+vec4\s+fragColor,\s*in\s+vec2\s+fragCoord\s*\)/gm.test(u)&&(u=`
#define iResolution vec3(u_resolution, 0)
#define iTime u_time
#define iTimeDelta u_timeDelta
#define iFrame u_frameIndex

${e.textures.map((x,_)=>`#define iChannel${_} ${x.name}`).join(`
`)}
${u}
void main(){mainImage(FragColor, gl_FragCoord.xy);}`);let c=function(x,_,y){let w=gr(x,x.VERTEX_SHADER,_),k=gr(x,x.FRAGMENT_SHADER,y),S=x.createProgram();return x.attachShader(S,w),x.attachShader(S,k),x.linkProgram(S),x.getProgramParameter(S,x.LINK_STATUS)||(console.warn("Link failed:"+x.getProgramInfoLog(S)),console.warn("vs info-log:"+x.getShaderInfoLog(w)),console.warn("fs info-log:"+x.getShaderInfoLog(k))),S}(o,e.vertex||`#version 300 es
 in vec4 position;void main(){gl_Position = position;}`,`#version 300 es
 precision highp float;out vec4 FragColor;`+u),h=o.getAttribLocation(c,"position"),f=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,f),o.bufferData(o.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,-1,1,1,-1,1,1,-1]),o.STATIC_DRAW),o.enableVertexAttribArray(h),o.vertexAttribPointer(h,2,o.FLOAT,!1,0,0),o.viewport(0,0,o.drawingBufferWidth,o.drawingBufferHeight),o.clearColor(0,0,0,0),o.clear(o.COLOR_BUFFER_BIT),o.useProgram(c);const p=x=>o.getUniformLocation(c,x),d=p("u_resolution");o.uniform2fv(d,[s,a]),e.textures.forEach((x,_)=>{l.push(function(y,w,k){const S=y.createTexture();return y.activeTexture(y["TEXTURE"+k]),y.pixelStorei(y.UNPACK_FLIP_Y_WEBGL,!0),y.bindTexture(y.TEXTURE_2D,S),y.texImage2D(y.TEXTURE_2D,0,y.RGBA,y.RGBA,y.UNSIGNED_BYTE,w),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_S,y.REPEAT),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_WRAP_T,y.REPEAT),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MIN_FILTER,y.LINEAR),y.texParameteri(y.TEXTURE_2D,y.TEXTURE_MAG_FILTER,y.LINEAR),S}(o,x.value,_)),o.uniform1i(o.getUniformLocation(c,x.name),_)});const g=p("u_seed");g&&o.uniform2f(g,At(t)/1e16,Math.random());const v=p("u_time"),m=p("u_frameIndex"),b=p("u_timeDelta");if(v||b||m){let x=0,_=0;return Promise.resolve(J.set(e,(y,w,k,S)=>(o.clear(o.COLOR_BUFFER_BIT),e.width===w&&e.height===k||(S.forEach((N,D)=>{o.bindTexture(o.TEXTURE_2D,l[D]),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,N.value)}),e.width=w,e.height=k,n.width=w*i,n.height=k*i,o.viewport(0,0,n.width,n.height),o.uniform2fv(d,[n.width,n.height])),v&&o.uniform1f(v,y/1e3),m&&o.uniform1i(m,x++),b&&(o.uniform1f(b,(_-y)/1e3),_=y),o.drawArrays(o.TRIANGLES,0,6),n.toDataURL())))}return o.drawArrays(o.TRIANGLES,0,6),Promise.resolve(J.set(e,n.toDataURL()))}function jn(e,t){let r=[];for(;e.next();){let{curr:n,next:i}=e.get(),s=!i||n.isSymbol(";")||i.isSymbol("}");if(r.push(n),s)break}return r.length&&(t.value=vt(r)),t}function yr(e,t){let r=[],n=[],i=t&&t.type||"",s=[];for(;e.next();){let{prev:a,curr:l,next:o}=e.get(),u=!o||l.isSymbol("}");if(i==="block"&&u){o||!r.length||l.isSymbol("}")||(r[r.length-1].value+=";"+l.value),t.value=r;break}if(l.isSymbol("{")&&n.length&&!s.length){let c=An(n);if(!c.length)continue;let h=yr(e,{type:"block",name:"unkown",value:[]});c.forEach(f=>{let p=Object.assign({},h,{name:f.name,args:f.args});r.push(p)}),n=[]}else if(l.isSymbol(":")&&n.length&&!s.length){let c=vt(n);r.push(jn(e,{type:"statement",name:c,value:""})),i=="block"&&(t.value=r),n=[]}else l.isSymbol(";")?r.length&&n.length&&(r[r.length-1].value+=";"+vt(n),n=[]):(l.isSymbol("(")&&s.push(l),l.isSymbol(")")&&s.pop(),n.push(l))}return r.length&&i=="block"&&(t.value=r),i?t:r}function vt(e){return e.filter((t,r)=>!t.isSymbol(";")||r!==e.length-1).map(t=>t.value).join("")}function An(e){let t=P(e),r=[],n="",i=[],s=[],a=[];for(;t.next();){let{curr:l,next:o}=t.get();!n.length&&l.isWord()?n=l.value:l.isSymbol("(")?(a.length&&s.push(l.value),a.push(l)):l.isSymbol(")")?(a.pop(),a.length?s.push(l.value):s.length&&(i.push(s.join("")),s=[])):l.isSymbol(",")?a.length?(i.push(s.join("")),s=[]):(s.length&&(i.push(s.join("")),s=[]),n&&(r.push({name:n,args:i}),n="",i=[],s=[])):s.push(l.value)}return n&&r.push({name:n,args:i}),r.filter((l,o,u)=>u.findIndex(c=>c.name===l.name&&l.args.join("")==c.args.join(""))===o)}function Nn(e){return yr(P(W(e)))}function br(e,t){if(e.name==="fill"){let{r,g:n,b:i,a:s}=t.get_rgba_color(e.value);return{type:"statement",value:`
color = vec4(${We(r/255)}, ${We(n/255)}, ${We(i/255)}, ${We(s)});`}}return e.name=="grid"?{type:"grid",value:e.value}:{type:"statement",value:""}}function We(e){return String(e).includes(".")?e:e+".0"}function En(e,t){let r=Nn(e),n=[],i={x:1,y:1};return r.forEach(s=>{if(s.type==="statement"){let a=br(s,t);a.type=="statement"&&n.push(a.value),a.type==="grid"&&(i=ie(a.value,1/0))}else s.type==="block"&&n.push(function(a,l){if(a.name==="match"){let o=a.args[0],u=[];return a.value.forEach(c=>{let h=br(c,l);h.type=="statement"&&u.push(h.value)}),`
 if (${o}){${u.join("")}}`}return""}(s,t))}),function(s,{x:a,y:l}){return`
 vec3 mapping(vec2 uv, vec2 grid){vec2 _grid = 1.0/grid;float x = ceil(uv.x/_grid.x);float y = ceil(grid.y - uv.y/_grid.y);float i = x + (y - 1.0) * y;return vec3(x, y, i);} vec4 getColor(float x, float y, float i, float I, float X, float Y, float t){vec4 color = vec4(0, 0, 0, 0);${s} return color;} void main(){vec2 uv = gl_FragCoord.xy/u_resolution.xy;vec2 v = vec2(${a}, ${l});vec3 p = mapping(uv, v);FragColor = getColor(p.x, p.y, p.z, v.x * v.y, v.x, v.y, u_time);}`}(n.join(""),i)}function Tn(e){if(typeof getComputedStyle>"u")return"";let t={};if(e.computedStyleMap)for(let[r,n]of e.computedStyleMap())r.startsWith("--")&&(t[r]=n[0][0]);else{let r=getComputedStyle(e);for(let n of r)n.startsWith("--")&&(t[n]=r.getPropertyValue(n))}return function(r){let n=[];for(let[i,s]of Object.entries(r))n.push(i+":"+s);return n.join(";")}(t)}const xr=1e3/60;class Rn extends HTMLElement{constructor(){super(),this.doodle=this.attachShadow({mode:"open"}),this.animations=[],this.extra={get_variable:t=>function(r,n){return typeof getComputedStyle>"u"?"":getComputedStyle(r).getPropertyValue(n).trim().replace(/^\(|\)$/g,"")}(this,t),get_rgba_color:t=>function(r,n){let i=r.querySelector("style");return i?(i.style.color=n,function(s){let[a,l,o,u=1]=s.replace(/rgba?\((.+)\)/,(c,h)=>h).split(/,\s*/);return{r:a,g:l,b:o,a:u}}(getComputedStyle(i).color)):{r:0,g:0,b:0,a:1}}(this.shadowRoot,t)}}connectedCallback(t){this.innerHTML?this.load(t):setTimeout(()=>this.load(t))}disconnectedCallback(){this.cleanup()}cleanup(){if(J.clear(),this.compiled){for(let n of this.animations)n.cancel();this.animations=[];let{pattern:t,shaders:r}=this.compiled;if(Object.keys(t).length||Object.keys(r).length)for(let n of this.shadowRoot.querySelectorAll("cell"))n.style.cssText=""}}update(t){this.cleanup(),t||(t=jt(this._innerHTML)),this._innerHTML!==t&&(this._innerHTML=t),this.grid_size||(this.grid_size=this.get_grid());const{x:r,y:n,z:i}=this.grid_size,s=this.get_use();let a="",l="";this.compiled&&(a=this.compiled.content,l=this.compiled.styles.all);const o=this.generate(K(s+t,this.extra));let u=o.grid||this.get_grid(),{x:c,y:h,z:f}=u,p=!this.shadowRoot.innerHTML||this.shadowRoot.querySelector("css-doodle")||r!==c||n!==h||i!==f||JSON.stringify(a)!==JSON.stringify(o.content);if(Object.assign(this.grid_size,u),p)return o.grid?this.build_grid(o,u):this.build_grid(this.generate(K(s+t,this.extra)),u);let d=this.replace(o);o.props.has_animation&&(this.set_style(l.replace(/animation/g,"x")),this.reflow()),this.set_style(d(Le(this.grid_size)+o.styles.all))}get grid(){return Object.assign({},this.grid_size)}set grid(t){this.attr("grid",t),this.connectedCallback(!0)}get seed(){return this._seed_value}set seed(t){this.attr("seed",t),this.connectedCallback(!0)}get use(){return this.attr("use")}set use(t){this.attr("use",t),this.connectedCallback(!0)}get_max_grid(){return this.hasAttribute("experimental")?256:64}get_grid(){return ie(this.attr("grid"),this.get_max_grid())}get_use(){let t=String(this.attr("use")||"").trim();return/^var\(/.test(t)&&(t=`@use:${t};`),t}attr(t,r){let n=arguments.length;return n===1?this.getAttribute(t):n===2?(this.setAttribute(t,r),r):void 0}generate(t){let r=this.get_grid(),n=this.attr("seed")||this.attr("data-seed");j(n)&&(n=Date.now());let i=this.compiled=mr(t,r,n,this.get_max_grid());return this._seed_value=i.seed,this._seed_random=i.random,i}doodle_to_image(t,r,n){typeof r=="function"&&(n=r,r=null);let i=K(t=":doodle{width:100%;height:100%}"+t,this.extra),s=ie(""),a=mr(i,s,this._seed_value,this.get_max_grid(),this._seed_random),l=a.grid?a.grid:s,o="";if(r&&r.arg){let h=ie(r.arg,1/0);h.x&&h.y&&(r.width=h.x+"px",r.height=h.y+"px",o=`viewBox="0 0 ${h.x} ${h.y}"`)}let u=this.replace(a),c=wr(l,a.content);u(`
<svg ${r&&r.width&&r.height?`width="${r.width}" height="${r.height}"`:""} ${se} preserveAspectRatio="none" ${o}><foreignObject width="100%" height="100%"><div class="host" width="100%" height="100%" ${Bt}><style>${Le(l)} ${a.styles.all}</style>${c}</div></foreignObject></svg>`).then(h=>{let f=`data:image/svg+xml;base64,${btoa(unescape(encodeURIComponent(h)))}`;Ue()&&St(f),n(f)})}pattern_to_image({code:t,cell:r,id:n},i){let s=En(t,this.extra);this.shader_to_image({shader:s,cell:r,id:n},i)}pause(){this.setAttribute("cssd-paused",!0);for(let t of this.animations)t.pause()}resume(){this.removeAttribute("cssd-paused");for(let t of this.animations)t.resume()}shader_to_image({shader:t,cell:r,id:n},i){const s=this.doodle.getElementById(r);if(!s)return!1;let{width:a,height:l}=s.getBoundingClientRect(),o=devicePixelRatio||1,u=this.seed,c=typeof t=="string"?function(v){let m,b,x=P(Dt(W(v,{preserveLineBreak:!0,ignoreInlineComment:!0}))),_=[],y=[],w={textures:[]};for(;x.next();){let{curr:k,next:S}=x.get();if(k.isSymbol("{")){if(_.length)y.push(k);else{let N=Ke(y);Qr(N)?(m=N,y=[]):y.push(k)}_.push("{")}else if(k.isSymbol("}"))if(_.pop(),!_.length&&m){let N=Ke(y);m&&N.length&&(m.startsWith("texture")?w.textures.push({name:m,value:N}):w[m]=N,y=[]),m=null}else y.push(k);else L(b)||b==k.pos[1]||(y.push(Lt()),b=null),m&&m.startsWith("texture")||k.isWord()&&k.value.startsWith("#")&&(y.push(Lt()),b=S.pos[1]),y.push(k)}return L(w.fragment)&&(w.fragment=Ke(y),w.textures=w.textures||[]),w}(t):t;c.width=a,c.height=l;let h=c.textures,f=[];const p=v=>{s.style.setProperty(n,`url(${v})`)},d=v=>{typeof v=="function"?this.animations.push(function(m){let b,x=0,_=0,y=0,w=!1;function k(S){x||(x=S),m(x);let N=S-_;N<xr&&(N=xr),N>1e3&&(N=y||1e3),_&&(x+=N),y=N,_=S,b=requestAnimationFrame(k)}return b=requestAnimationFrame(k),{resume(){b&&w&&(w=!1,b=requestAnimationFrame(k))},pause(){b&&(cancelAnimationFrame(b),w=!0)},cancel(){b&&(w=!1,cancelAnimationFrame(b),b=null)}}}(m=>{p(v(m,a,l,f))})):p(v)},g=(v,m)=>{Promise.all(v.map(({name:b,value:x})=>new Promise(_=>{this.doodle_to_image(x,{width:a,height:l},y=>{let w=new Image;w.width=a*o,w.height=a*o,w.onload=()=>_({name:b,value:w}),w.src=y})}))).then(m)};s.observer||(s.observer=new ResizeObserver(()=>{let v=s.getBoundingClientRect();a=v.width,l=v.height,g(h,m=>f=m)}),s.observer.observe(s)),h.length?g(h,v=>{c.textures=f=v,c.width=a,c.height=l,vr(c,u).then(d).then(i)}):vr(c,u).then(d).then(i)}load(t){this.cleanup();let r=K(this.get_use()+jt(this.innerHTML),this.extra),n=this.generate(r);t||this.hasAttribute("click-to-update")&&this.addEventListener("click",i=>this.update()),this.grid_size=n.grid?n.grid:this.get_grid(),this.build_grid(n,this.grid_size),this._innerHTML=this.innerHTML,this.innerHTML=""}replace({doodles:t,shaders:r,pattern:n}){let i=Object.keys(t),s=Object.keys(r),a=Object.keys(n),l=i.length+s.length+a.length;return o=>{if(!l)return Promise.resolve(o);let u=[].concat(i.map(c=>o.includes(c)?new Promise(h=>{let{arg:f,doodle:p}=t[c];this.doodle_to_image(p,{arg:f},d=>h({id:c,value:d}))}):Promise.resolve("")),s.map(c=>o.includes(c)?new Promise(h=>{this.shader_to_image(r[c],f=>h({id:c,value:f}))}):Promise.resolve("")),a.map(c=>o.includes(c)?new Promise(h=>{this.pattern_to_image(n[c],f=>h({id:c,value:f}))}):Promise.resolve("")));return Promise.all(u).then(c=>{for(let{id:h,value:f}of c){let p=`url(${f})`;/^shader|^pattern/.test(h)&&(p=`var(--${h})`),o=o.replaceAll("${"+h+"}",p)}return o})}}reflow(){this.shadowRoot.querySelector("grid").offsetWidth}build_grid(t,r){const{has_transition:n,has_animation:i}=t.props;let s=n||i;const{uniforms:a,content:l,styles:o}=t;this.doodle.innerHTML=`
<style>${Le(r)+o.main}</style>${wr(r,l)}`,s&&this.reflow();let u=this.replace(t);this.set_style(u(Le(r)+o.all)),a.time&&this.register_utime(),a.mousex||a.mousey?this.register_umouse(a):this.remove_umouse(),a.width||a.height?this.register_usize(a):this.remove_usize()}register_umouse(t){if(!this.umouse_fn){this.umouse_fn=n=>{let i=n.detail||n;t.mousex&&this.style.setProperty("--"+nt,i.offsetX),t.mousey&&this.style.setProperty("--"+it,i.offsetY)},this.addEventListener("pointermove",this.umouse_fn);let r=new CustomEvent("pointermove",{detail:{offsetX:0,offsetY:0}});this.dispatchEvent(r)}}remove_umouse(){this.umouse_fn&&(this.style.removeProperty("--"+nt),this.style.removeProperty("--"+it),this.removeEventListener("pointermove",this.umouse_fn),this.umouse_fn=null)}register_usize(t){this.usize_observer||(this.usize_observer=new ResizeObserver(()=>{let r=this.getBoundingClientRect();t.width&&this.style.setProperty("--"+st,r.width),t.height&&this.style.setProperty("--"+lt,r.height)}),this.usize_observer.observe(this))}remove_usize(){this.usize_observer&&(this.style.removeProperty("--"+st),this.style.removeProperty("--"+lt),this.usize_observer.unobserve(this),this.usize_observer=null)}register_utime(){if(!this.is_utime_set){try{CSS.registerProperty({name:"--"+z.name,syntax:"<number>",initialValue:0,inherits:!0})}catch{}this.is_utime_set=!0}}export({scale:t,name:r,download:n,detail:i}={}){return new Promise((s,a)=>{let l=Tn(this),o=this.doodle.innerHTML,{width:u,height:c}=this.getBoundingClientRect(),h=u*(t=parseInt(t)||1),f=c*t,p=`
<svg ${se} preserveAspectRatio="none"
 viewBox="0 0 ${u} ${c}"
 ${Ue()?"":`width="${h}px" height="${f}px"`}><foreignObject width="100%" height="100%"><div class="host" ${Bt} style="width:${u}px;height:${c}px"><style>.host{${d=l,d.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}}</style>${o}</div></foreignObject></svg>`;var d;n||i?function(g,v,m,b){return new Promise((x,_)=>{let y=`data:image/svg+xml;utf8,${encodeURIComponent(g)}`;function w(){let k=new Image;k.crossOrigin="anonymous",k.src=y,k.onload=()=>{let S=document.createElement("canvas"),N=S.getContext("2d"),D=devicePixelRatio||1;b!=1&&(D=1),S.width=v*D,S.height=m*D,N.drawImage(k,0,0,S.width,S.height);try{S.toBlob(C=>{x({blob:C,source:y,url:URL.createObjectURL(C)})})}catch(C){_(C)}}}Ue()?St(y,w,200):w()})}(p,h,f,t).then(({source:g,url:v,blob:m})=>{if(s({width:h,height:f,svg:p,blob:m,source:g}),n){let b=document.createElement("a");b.download=function(x){return(j(x)?Date.now():String(x).replace(/\/.png$/g,""))+".png"}(r),b.href=v,b.click()}}).catch(g=>{a(g)}):s({width:h,height:f,svg:p})})}set_style(t){if(t instanceof Promise)t.then(r=>{this.set_style(r)});else{const r=this.shadowRoot.querySelector("style");let n=t.replace(/\n\s+/g," ");r&&(r.styleSheet?r.styleSheet.cssText=n:r.innerHTML=n)}}}function Le(e){let{x:t,y:r}=e||{};return`
 *,*::after,*::before,:host,.host{box-sizing:border-box;}:host,.host{display:block;visibility:visible;width:auto;height:auto;contain:strict;--${z.name}:0
}:host([hidden]),[hidden]{display:none
}:host([cssd-paused]),
:host([cssd-paused]) *{animation-play-state:paused !important
} grid, cell{display:grid;position:relative;} grid{gap:inherit;grid-template:repeat(${r},1fr)/repeat(${t},1fr)
} cell{place-items:center
} svg{position:absolute;} grid, svg{width:100%;height:100%
}`}function _r(e){return j(e)?"":e}function $r(e,t,r,n,i=""){let s=te(e,t,r);return`<cell id="${s}">${_r(n["#"+s])}${_r(i)}</cell>`}function wr(e,t){let{x:r,y:n,z:i}=e||{},s="";if(i==1)for(let a=1;a<=n;++a)for(let l=1;l<=r;++l)s+=$r(l,a,1,t);else{let a="";for(let l=i;l>=1;l--)a=$r(1,1,l,t,a);s=a}return`<grid>${s}</grid>`}var yt,kr;yt="css-doodle",kr=Rn,customElements==="undefined"||customElements.get(yt)||customElements.define(yt,kr)})();
//# sourceMappingURL=css-doodle.min.DGP2MprI.js.map
