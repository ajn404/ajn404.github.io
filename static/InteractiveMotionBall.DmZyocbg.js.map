{"version":3,"file":"InteractiveMotionBall.DmZyocbg.js","sources":["../../src/components/react/p5/Vector/InteractiveMotionBall.tsx"],"sourcesContent":["import Basic from \"@components/react/p5/index.tsx\";\nimport { Slider } from \"@shadcn/ui/slider\";\nimport { useDebounce } from \"@uidotdev/usehooks\";\nimport { cn } from \"@utils/utils\";\nimport type p5 from \"p5\";\nimport { useCallback, useState } from \"react\";\n\nclass MouseMover {\n  position: p5.Vector;\n  velocity: p5.Vector;\n  circleRadius: number = 20;\n  acceleration: p5.Vector;\n  p: p5;\n  color: p5.Color;\n  trend: number = 0.2;\n  constructor(p: p5) {\n    this.circleRadius = p.random(1, 20);\n    //球越大,趋势越小\n    this.trend = p.map(this.circleRadius, 1, 20, 1, 0.5);\n    this.position = p.createVector(\n      p.random(this.circleRadius, p.width - this.circleRadius),\n      p.random(this.circleRadius + 1, p.height - this.circleRadius - 1)\n    );\n\n    this.velocity = p.createVector(p.random(-2, 2), p.random(-2, 2));\n    this.p = p;\n    this.color = p.color(p.random(0, 255), p.random(0, 255), p.random(0, 255));\n  }\n\n  move() {\n    let mouse = this.p.createVector(this.p.mouseX, this.p.mouseY);\n    let dir = mouse;\n    dir.sub(this.position);\n    //靠近的趋势\n    dir.setMag(this.trend);\n\n    // this.acceleration = this.p.createVector(this.p.random(-0.01, 0.01), this.p.random(-0.01, 0.01));\n    this.acceleration = dir;\n    // this.acceleration.mult(this.p.random(2));\n    this.velocity.limit(10);\n\n    this.velocity.add(this.acceleration);\n    this.position.add(this.velocity);\n  }\n\n  show() {\n    const p = this.p;\n    p.stroke(0);\n    p.fill(this.color);\n    p.strokeWeight(2);\n    p.circle(this.position.x, this.position.y, this.circleRadius * 2);\n  }\n\n  checkEdges() {\n    const p = this.p;\n    if (\n      this.position.x + this.circleRadius > p.width ||\n      this.position.x < this.circleRadius\n    ) {\n      this.velocity.x *= -1;\n    }\n    if (\n      this.position.y + this.circleRadius > p.height ||\n      this.position.y < this.circleRadius\n    ) {\n      this.velocity.y *= -1;\n    }\n  }\n}\n\nexport default () => {\n  let [num, setNum] = useState(1000);\n  let debounceNum = useDebounce(num, 200);\n  const sketch = useCallback(\n    (p: p5) => {\n      let movers: MouseMover[];\n      const setup = () => {\n        p.createCanvas(p.windowWidth / 2, 240);\n        movers = new Array(debounceNum).fill(0).map(() => new MouseMover(p));\n        p.frameRate(120);\n      };\n      const draw = () => {\n        p.background(255);\n        movers.forEach(m => {\n          if (\n            p.mouseX > 0 &&\n            p.mouseX < p.width &&\n            p.mouseY > 0 &&\n            p.mouseY < p.height\n          ) {\n            m.move();\n            m.checkEdges();\n            // p.background(255, 0, 0);\n          }\n          m.show();\n        });\n      };\n      const resize = () => {\n        p.resizeCanvas(p.windowWidth / 2, 240);\n      };\n      p.setup = setup;\n      p.draw = draw;\n      p.windowResized = resize;\n    },\n    [debounceNum]\n  );\n  return (\n    <>\n      slider值num:{num}\n      <br />\n      小球数量debounceNum:{debounceNum}\n      <br />\n      <Slider\n        defaultValue={[50]}\n        max={1000}\n        min={1}\n        step={1}\n        className={cn(\"w-[100%] m-4\")}\n        onValueChange={value => {\n          setNum(value[0]);\n        }}\n        value={[num]}\n      />\n      <Basic sketch={sketch}></Basic>\n    </>\n  );\n};\n"],"names":["MouseMover","p","dir","InteractiveMotionBall","num","setNum","useState","debounceNum","useDebounce","sketch","useCallback","movers","setup","draw","m","resize","jsxs","Fragment","jsx","Slider","cn","value","Basic"],"mappings":"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"}